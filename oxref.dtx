% \iffalse
%<*internal|bbx|cbx|dbx|lbx|doc>
\def\Version{2015/05/25 v0.1}
%</internal|bbx|cbx|dbx|lbx|doc>
%<*internal>
\iffalse
%</internal>
%<*bbx|cbx|dbx|lbx>
\NeedsTeXFormat{LaTeX2e}[1999/12/01]
%</bbx|cbx|dbx|lbx>
%<*bbx&o>
\ProvidesFile{oxref.bbx}
    [\Version\space Base settings for bibliography styles inspired by the Oxford Guide to Style]
%</bbx&o>
%<*bbx&n>
\ProvidesFile{oxnotes.bbx}
    [\Version\space Footnote-based bibliography style inspired by the Oxford Guide to Style]
%</bbx&n>
%<*bbx&y>
\ProvidesFile{oxyear.bbx}
    [\Version\space Author-year bibliography style inspired by the Oxford Guide to Style]
%</bbx&y>
%<*cbx&n>
\ProvidesFile{oxnotes.cbx}
    [\Version\space Footnote-based citation style inspired by the Oxford Guide to Style]
%</cbx&n>
%<*cbx&y>
\ProvidesFile{oxyear.cbx}
    [\Version\space Author-year citation style inspired by the Oxford Guide to Style]
%</cbx&y>
%<*dbx>
\ProvidesFile{oxref.dbx}
    [\Version\space Data model for the Oxref family of styles]
%</dbx>
%<*lbx&gb>
\ProvidesFile{british-oxref.lbx}
    [\Version\space British English conventions required by the biblatex-oxref styles]
%</lbx&gb>
%<*doc&n>
\ProvidesFile{oxnotes-doc.tex}
    [\Version\space Footnote-based biblatex style inspired by the Oxford Guide to Style]
%</doc&n>
%<*doc&y>
\ProvidesFile{oxyear-doc.tex}
    [\Version\space Author-year biblatex style inspired by the Oxford Guide to Style]
%</doc&y>
%<*readme>
# biblatex-oxref: Biblatex styles inspired by the *Oxford Guide to Style*

This bundle provides two [biblatex] styles that implement (some of) the
stipulations and examples provided by the 2014 *New Hart's Rules* and the 2002
*Oxford Guide to Style*:

  * `oxnotes` is a style similar to the standard `verbose`,
    intended for use with footnotes;
  * `oxyear` is a style similar to the standard `authoryear`,
    intended for use with parenthetical in-text citations.

Both styles should be considered experimental. In particular, the ways in which
the styles handle certain tricky references are subject to change.

[biblatex]: http://ctan.org/pkg/biblatex
%</readme>
%<*bib>
@reference{ritter2002ogs,
  author = {R. M. Ritter},
  title = {The {Oxford} Guide to Style},
  date = {2002},
  publisher = {Oxford University Press},
  location = {Oxford, UK}}
@reference{waddingham2014nhr,
  editor = {Anne Waddingham},
  title = {New {Hart's} Rules},
  subtitle = {The {Oxford} Guide to Style},
  date = {2014},
  edition = {2},
  publisher = {Oxford University Press},
  location = {Oxford, UK}}
%</bib>
%<*internal>
\fi
\def\nameofplainTeX{plain}
\ifx\fmtname\nameofplainTeX\else
  \expandafter\begingroup
\fi
%</internal>
%<*install>
\input docstrip.tex
\keepsilent
\askforoverwritefalse

\nopreamble\nopostamble

\usedir{doc/latex/\jobname}
\generate{
  \file{README.md}{\from{\jobname.dtx}{readme}}
  \file{\jobname.bib}{\from{\jobname.dtx}{bib}}
}

\preamble
----------------------------------------------------------------
biblatex-oxref --- Biblatex styles inspired by the Oxford Guide to Style
Author:  Alex Ball
E-mail:  a.j.ball@bath.ac.uk
License: Released under the LaTeX Project Public License v1.3c or later
See:     http://www.latex-project.org/lppl.txt
----------------------------------------------------------------

\endpreamble
\postamble

Copyright (C) 2016 Alex Ball
\endpostamble

\usedir{tex/latex/\jobname}
\generate{
  \file{\jobname.bbx}{\from{\jobname.dtx}{bbx,o}}
  \file{oxnotes.bbx}{\from{\jobname.dtx}{bbx,n}}
  \file{oxyear.bbx}{\from{\jobname.dtx}{bbx,y}}
  \file{oxnotes.cbx}{\from{\jobname.dtx}{cbx,n}}
  \file{oxyear.cbx}{\from{\jobname.dtx}{cbx,y}}
  \file{\jobname.dbx}{\from{\jobname.dtx}{dbx}}
  \file{british-\jobname.lbx}{\from{\jobname.dtx}{lbx,gb}}
  \file{oxnotes-doc.tex}{\from{\jobname.dtx}{doc,n}}
  \file{oxyear-doc.tex}{\from{\jobname.dtx}{doc,y}}
}
%</install>
%<install>\endbatchfile
%<*internal>
\usedir{source/latex/\jobname}
\generate{
  \file{\jobname.ins}{\from{\jobname.dtx}{install}}
}
\ifx\fmtname\nameofplainTeX
  \expandafter\endbatchfile
\else
  \expandafter\endgroup
\fi
%</internal>
%<*driver>
\ProvidesFile{oxref.dtx}
    [\Version\space Biblatex styles inspired by the Oxford Guide to Style]
\PassOptionsToPackage{style=oxnotes}{biblatex}
%</driver>
%<doc&n>\PassOptionsToPackage{style=oxnotes,scnames}{biblatex}
%<doc&y>\PassOptionsToPackage{style=oxyear}{biblatex}
%<*driver|doc>
\documentclass[extrafontsizes,11pt,a4paper,oneside]{memoir}
\setlrmarginsandblock{3cm}{3cm}{*}
\setulmarginsandblock{2.5cm}{2.5cm}{*}
\checkandfixthelayout
% Document divisions
\chapterstyle{ell}
\renewcommand{\prechapterprecis}{%
  \vspace*{\prechapterprecisshift}%
  \begin{flushright}\precisfont
}
\renewcommand{\postchapterprecis}{\end{flushright}}
\hangsecnum
\setsecheadstyle{\Large\bfseries\raggedright}
\setsubsecheadstyle{\large\bfseries\scshape\raggedright}
\setsecnumdepth{subsection}
% Pagination and headers
\nouppercaseheads
\makeoddhead{myheadings}{\textsc{\leftmark}}{}{\thepage}
\makepsmarks{myheadings}{%
  \def\chaptermark##1{\markboth{##1}{##1}}%
  \def\sectionmark##1{\markright{##1}}%
}
\pagestyle{myheadings}
\aliaspagestyle{title}{empty}
% Paragraphs and lists
\setlength{\parindent}{0pt}\nonzeroparskip
\firmlists

\usepackage[british]{babel}
\usepackage[mono=false,defaultfeatures={SmallCapsFeatures={Letters=SmallCaps,Renderer=Basic,Ligatures=NoCommon}}]{libertine}
\usepackage{fontawesome}[2015/07/07]
\newcommand{\booksym}{\makebox[1em][c]{\faicon{book}}}
\newcommand{\cogsym}{\makebox[1em][c]{\faicon{cog}}}
\makeatletter
\@ifpackageloaded{fontspec}{%
  \setmonofont[Scale=MatchLowercase,StylisticSet=1,AutoFakeSlant]{Inconsolatazi4}
}{%
  \usepackage[utf8]{inputenc}
  \usepackage[varl]{zi4}
}
\makeatother

\usepackage{xpatch,csquotes,xcolor,xparse,multicol}
\definecolor{Green}{rgb}{0,.5,0}
\colorlet{ok}{Green}
\colorlet{todo}{red}
\colorlet{hacked}{orange}
\colorlet{manual}{purple}

\usepackage{tcolorbox}
\tcbuselibrary{skins,xparse,documentation,breakable,minted}
\colorlet{Option}{violet}
\colorlet{Command}{red!75!black}
\colorlet{Environment}{blue!75!black}
\colorlet{Value}{olive!75!black}
\colorlet{Color}{cyan!75!black}
\tcbset
  { enhanced
  , listing engine=minted
  , minted options=
    { breaklines
    , fontsize=\footnotesize
%<*!doc>
    , linenos
    , numbersep=20pt
    , firstnumber=last
%</!doc>
    }
  , index format=pgf
  , color command=Command
  , color environment=Environment
  , color key=Option
  , color value=Value
  , color color=Color
  }
\renewcommand{\theFancyVerbLine}{\footnotesize\itshape\color{gray}\arabic{FancyVerbLine}}
\let\tcbcs=\cs
\renewcommand*{\cs}[1]{\textcolor{Command}{\tcbcs{#1}}}
\def\sqbrackets#1{%
  \texttt{\textcolor{Option}{[}#1\textcolor{Option}{]}}}
\def\brackets#1{%
  \texttt{\textcolor{Environment}{\char`\{}#1\textcolor{Environment}{\char`\}}}}
\def\marg#1{%
  \textcolor{Environment}{\ttfamily\char`\{}\meta{#1}\textcolor{Environment}{\ttfamily\char`\}}}
\newcommand*{\env}[1]{\textcolor{Environment}{\ttfamily #1}}
\newcommand*{\key}[1]{\textcolor{Option}{\ttfamily #1}}
\newcommand*{\val}[1]{\textcolor{Value}{\ttfamily #1}}
\makeatletter
\newcommand{\resetmintedformat}{%
  % Comments
  \expandafter\def\csname PYGdefault@tok@c\endcsname{\let\PYGdefault@it=\textit\def\PYGdefault@tc####1{\textcolor{gray}{####1}}}
  % Command sequences
  \expandafter\def\csname PYGdefault@tok@k\endcsname{\def\PYGdefault@tc####1{\textcolor{Command}{####1}}}
  % Optional arguments
  \expandafter\def\csname PYGdefault@tok@na\endcsname{\def\PYGdefault@tc####1{\textcolor{Option}{####1}}}
  % Braces
  \expandafter\def\csname PYGdefault@tok@nb\endcsname{\def\PYGdefault@tc####1{\textcolor{Environment}{####1}}}
}
\apptocmd{\minted@checkstyle}{\resetmintedformat}{}{}
\makeatother

\RecustomVerbatimEnvironment
  {Verbatim}{Verbatim}
  {commentchar=\%}

\usepackage
[backend=biber%
,hyperref=false%
%,isbn=false%
]{biblatex}
\bibliography{oxref}
\hypersetup{pdfborder={0 0 0},pdfencoding=auto}
\usepackage[noabbrev,capitalize,nameinlink]{cleveref}

\newcommand*{\pkg}[1]{\href{http://www.ctan.org/pkg/#1}{\textsf{#1}}}
\newcommand*{\lit}[1]{\textsf{#1}}
\newcommand*{\code}[1]{\texttt{#1}}
\newcommand*{\aside}[1]{\textcolor{violet}{[\textsc{tip:} #1]}}
\newcommand{\tip}[1]{\hangfrom{\faLightbulbO\enskip}#1\par}
\newcommand{\hack}[1]{\hangfrom{\faWrench\enskip}#1\par}

% For debugging; userd is either ‘todo’, ‘hacked’, ‘manual’
\makeatletter
\def\CiteStatus{todo}
\newcommand{\dbgcolor}[2]{%
  \bgroup
  \blx@citecmdinit
  \blx@citeinit
  \def\blx@precode{}%
  \def\blx@postcode{}%
  \def\blx@loopcode{%
    \iffieldundef{userd}
    {\xdef\CiteStatus{ok}}
    {\xdef\CiteStatus{\abx@field@userd}}}%
  \blx@citeloop{#1}%
  \textcolor{\CiteStatus}{#2}%
  \egroup
}
\makeatother
\NewTColorBox{bibexbox}{D(){ok}d<>omo}%
  {bicolor
  ,colframe = #1
  ,colback = #1!5!white
  ,colbacklower = white
  ,fontlower = \footnotesize
  ,before upper = {\hangfrom{\booksym\space}\biburlsetup}
  ,IfNoValueTF={#3}%
    {after upper = {\par\hangfrom{\cogsym\space}\fullcite{#4}.}
    }%
    {after upper = {\par\hangfrom{\cogsym\space}\fullcite[#3]{#4}.}
    ,title = {\texttt{\string\autocite[#3]\{#4\}}}
    }
  ,IfNoValueTF={#2}{}%
    {overlay = {
      \node[anchor=south east,text=teal] at (frame.south east) {#2};
      }
    }
  , IfNoValueTF={#5}{}{#5}
  }
\NewTotalTColorBox{\spec}{m}%
  {enhanced
  ,sharp corners = west
  ,colframe = teal
  ,colback = teal!5!white
  ,toprule = 0pt
  ,bottomrule = 0pt
  ,rightrule = 0pt
  }{#1}
% \egcite gives a citation as an example. Arguments:
% #1 = page range
% #2 = bib key
\NewDocumentCommand\egcite{om}{%
  \makebox[0pt][r]{\footnotesize\textcolor{teal}{#2}\quad}%
  \IfNoValueTF{#1}{\dbgcolor{#2}{\fullcite{#2}.}}%
  {\dbgcolor{#2}{\fullcite[#1]{#2}}.}}

\frenchspacing
%</driver|doc>
%<*driver>
\usepackage[tightLists=false]{markdown}
\markdownSetup{rendererPrototypes={%
    link = {\href{#3}{#1}}%
}}

% For typesetting the implementation
\makeatletter
\let\theglossary\@undefined
\let\endtheglossary\@undefined
\makeatother
\usepackage{doc}
\makeatletter
\renewenvironment{theglossary}{%
  \bgroup
    \glossary@prologue
    \GlossaryParms \let\item\@idxitem \ignorespaces
}{%
  \egroup
}
\renewenvironment{macro}[1]{%
  \def\MyName{#1}%
  \index{\MyName@\tcbIndexPrintComC {\MyName}|(emph}%
}{%
  \ifdef{\MyName}{}{%
    \errmessage{You have closed a macro environment you have not opened on \the\inputlineno.}%
  }
  \index{\MyName@\tcbIndexPrintComC {\MyName}|)}%
}
\renewenvironment{environment}[1]{%
  \def\MyName{#1}%
  \index{\MyName@\tcbIndexPrintEnvCA {\MyName}|(emph}%
  \index{Environments!\MyName@\tcbIndexPrintEnvC {\MyName}|(emph}%
}{%
  \ifdef{\MyName}{}{%
    \errmessage{You have closed an environment environment you have not opened on \the\inputlineno.}%
  }
  \index{Environments!\MyName@\tcbIndexPrintEnvC {\MyName}|)}%
  \index{\MyName@\tcbIndexPrintEnvCA {\MyName}|)}%
}
\newenvironment{optionkey}[1]{%
  \def\MyName{#1}%
  \index{\MyName@\tcbIndexPrintKeyCA {\MyName}|(emph}%
  \index{Keys!\MyName@\tcbIndexPrintKeyC {\MyName}|(emph}%
}{%
  \ifdef{\MyName}{}{%
    \errmessage{You have closed an optionkey environment you have not opened on \the\inputlineno.}%
  }
  \index{Keys!\MyName@\tcbIndexPrintKeyC {\MyName}|)}%
  \index{\MyName@\tcbIndexPrintKeyCA {\MyName}|)}%
}
\newenvironment{optionvalue}[1]{%
  \def\MyName{#1}%
  \index{\MyName@\tcbIndexPrintValCA {\MyName}|(emph}%
  \index{Values!\MyName@\tcbIndexPrintValC {\MyName}|(emph}%
}{%
  \ifdef{\MyName}{}{%
    \errmessage{You have closed an optionvalue environment you have not opened on \the\inputlineno.}%
  }
  \index{Values!\MyName@\tcbIndexPrintValC {\MyName}|)}%
  \index{\MyName@\tcbIndexPrintValCA {\MyName}|)}%
}
\let\PrintMacroName\@gobble
\let\PrintEnvName\@gobble
\renewenvironment{tcb@manual@entry}{\begin{list}{}{%
  \setlength{\topsep}{0pt}
  \setlength{\partopsep}{0pt}
  \setlength{\leftmargin}{\kvtcb@doc@left}%
  \setlength{\itemindent}{0pt}%
  \setlength{\itemsep}{0pt}%
  \setlength{\parsep}{0pt}%
  \setlength{\rightmargin}{\kvtcb@doc@right}%
  }\item}{\end{list}}
\makeatother
\MakeShortVerb{\|}

% This bit inspired by ydoc
\makeatletter
\newwrite\ydocwrite
\def\ydocfname{\jobname.listing}
\def\ydoc@catcodes{%
  \let\do\@makeother
  \dospecials
  \catcode`\\=\active
  \catcode`\^^M=\active
  \catcode`\ =\active
}
\def\macrocode{%
  \begingroup
  \ydoc@catcodes
  \macro@code
}
\def\endmacrocode{}
\begingroup
\endlinechar\m@ne
\@firstofone{%
\catcode`\|=0\relax
\catcode`\(=1\relax
\catcode`\)=2\relax
\catcode`\*=14\relax
\catcode`\{=12\relax
\catcode`\}=12\relax
\catcode`\ =12\relax
\catcode`\%=12\relax
\catcode`\\=\active
\catcode`\^^M=\active
\catcode`\ =\active
}*
|gdef|macro@code#1^^M%    \end{macrocode}(*
|endgroup|expandafter|macro@@code|expandafter(|ydoc@removeline#1|noexpand|lastlinemacro)*
)*
|gdef|ydoc@removeline#1^^M(|noexpand|firstlinemacro)*
|gdef|ydoc@defspecialmacros(*
|def^^M(|noexpand|newlinemacro)*
|def (|noexpand|spacemacro)*
|def\(|noexpand|bslashmacro)*
)*
|gdef|ydoc@defrevspecialmacros(*
|def|newlinemacro(|noexpand^^M)*
|def|spacemacro(|noexpand )*
|def|bslashmacro(|noexpand\)*
)*
|endgroup
\def\macro@@code#1{%
  {\ydoc@defspecialmacros
  \xdef\themacrocode{#1}}%
  \PrintMacroCode
  \end{macrocode}%
}
\def\PrintMacroCode{%
  \begingroup
  \let\firstlinemacro\empty
  \let\lastlinemacro\empty
  \def\newlinemacro{^^J}%
  \let\bslashmacro\bslash
  \let\spacemacro\space
  \immediate\openout\ydocwrite=\ydocfname\relax
  \immediate\write\ydocwrite{\themacrocode}%
  \immediate\closeout\ydocwrite
  \let\input\@input
  \tcbinputlisting{breakable,listing only,docexample,listing file=\ydocfname}%
  \endgroup
}
\makeatother

\title{OXREF -- Biblatex styles inspired by the \emph{Oxford Guide to Style}}
%</driver>
%<doc&n>\title{OXNOTES -- A notes-based style for Biblatex}
%<doc&y>\title{OXYEAR -- An author–year style for Biblatex}
%<*driver|doc>
\author{Alex Ball}
\begin{document}
\thispagestyle{empty}
\begin{adjustwidth}{.2\textwidth}{0pt}
  \sffamily\setlength{\parindent}{0pt}%
  \LARGE\textsc{oxref bundle}

  \vspace{\stretch{1}}
  \LARGE\thetitle

  \bigskip
  \Large\theauthor

  \bigskip
  \Large\ifx\undefined\thedate\today\else\thedate\fi
\end{adjustwidth}

\vspace{\stretch{3}}
\noindent
\hspace*{.1\textwidth}\raisebox{0pt}[0pt][0pt]{\rule{\normalrulethickness}{\textheight}}

\newpage
\tableofcontents*

%</driver|doc>
%<*driver>
\chapter{Introduction}

This document provides the documented sources for the \textsf{oxref}
biblography styles:
\begin{itemize}
  \item
  \textsf{oxnotes}: a style similar to the standard \textsf{verbose}, intended for use with footnotes;
  \item
  \textsf{oxyear}: a style similar to the standard \textsf{authoryear}, intended for use with parenthetical in-text citations.
\end{itemize}

\section{Quick start}

The styles are self-contained, so you can load them with \pkg{biblatex}:

\begin{multicols}{2}
\begin{tcblisting}{listing only}
\usepackage[style=oxnotes]{biblatex}
\end{tcblisting}

\addtocounter{FancyVerbLine}{-1}%
\begin{tcblisting}{listing only}
\usepackage[style=oxyear]{biblatex}
\end{tcblisting}
\end{multicols}

For further information, including some additional options you can set,
please refer to the separate documentation files
\texttt{oxnotes-doc.pdf} and \texttt{oxyear-doc.pdf} respectively.

\begin{markdown*}{hybrid=true}
%</driver>
%<*driver|readme>

## Installation

### Dependencies

To compile the documentation you will need to have the [minted] package working,
which in turn relies on Python 2.6+ and Pygments. See the documentation of that
package for details.

### Automated way

A makefile is provided which you can use with the Make utility on
UNIX-like systems:

  * Running `make source` generates the derived files
      - README.md
      - oxref.bbx, oxnotes.bbx, oxyear.bbx
      - oxnotes.cbx, oxyear.cbx
      - british-oxref.lbx
      - oxref.dbx
      - oxref.bib
      - oxref.ins
      - oxnotes-doc.tex, oxyear-doc.tex

  * Running `make` generates the above files and also oxref.pdf,
    oxnotes-doc.pdf, and oxyear-doc.pdf.

  * Running `make inst` installs the files in the user's TeX tree.
    You can undo this with `make uninst`.

  * Running `make install` installs the files in the local TeX tree.
    You can undo this with `make uninstall`.

  * Running `make clean` removes auxiliary files from the working directory.

  * Running `make distclean` removes the generated from the working directory
    files as well.

### Manual way

To install the bundle from scratch, follow these instructions. If you have
downloaded the zip file from the [Releases] page on GitHub, you can skip the
first two steps.

 1. Run `luatex oxref.dtx` to generate the source files. (You can safely skip
    this step if you are confident about step 2.)

 2. Compile oxref.dtx, oxnotes-doc.tex and oxyear-doc.tex with LuaLaTeX and
    Biber to generate the documentation. You will need to enable shell escape
    so that [minted] can typeset the listings.

 3. Move the files to your TeX tree as follows:
      - `source/latex/biblatex-oxref`:
        oxref.dtx,
        (oxref.ins)
      - `tex/latex/biblatex-oxref`:
        oxref.bbx,
        oxnotes.bbx,
        oxyear.bbx,
        oxnotes.cbx,
        oxyear.cbx,
        oxref.dbx,
        british-oxref.lbx
      - `doc/latex/biblatex-oxref`:
        README.md,
        oxref.pdf,
        oxnotes-doc.pdf,
        oxyear-doc.pdf,
        oxnotes-doc.tex,
        oxyear-doc.tex,
        oxref.bib

 4. You may then have to update your installation's file name database
    before TeX and friends can see the files.

[Releases]: https://github.com/alex-ball/biblatex-oxref/releases
[minted]: http://ctan.org/pkg/minted

## Licence

Copyright 2016 Alex Ball.

This work consists of the documented LaTeX file oxref.dtx and a Makefile.

The text files contained in this work may be distributed and/or modified
under the conditions of the [LaTeX Project Public License (LPPL)][lppl],
either version 1.3c of this license or (at your option) any later
version.

This work is `maintained' (as per LPPL maintenance status) by [Alex Ball][me].

[lppl]: http://www.latex-project.org/lppl.txt "LaTeX Project Public License (LPPL)"
[me]: https://alexball.me.uk/ "Alex Ball"

%</driver|readme>
%<*driver>
\end{markdown*}

\iffalse % syntax highlighting \fix
%</driver>
%<*doc|bib>
%<*n|y>
\chapter{Introduction}

\section{Loading the style}\label{sec:loading}

The style is self-contained, so you can load it with \pkg{biblatex}:
\begin{tcblisting}{listing only}
%<n>\usepackage[style=oxnotes]{biblatex}
%<y>\usepackage[style=oxyear]{biblatex}
\end{tcblisting}

The style has some options additional to the regular \pkg{biblatex} ones:

\begin{docKey}{altthesis}{=\val{true}|\val{false}}{default \val{true}, initially \val{false}}
  Puts the thesis type inside, rather than outside, the parenthetical publication block.
\end{docKey}

\begin{docKey}{issuestyle}{=\val{slash}|\val{colon}|\val{comma}|\val{parens}}{default \val{slash}, initially \val{slash}}
  Affects how journal volumes and numbers are printed.
  \begin{itemize}
  \item\docValue{slash}
    separates the two with a solidus, e.g. ‘23/2’.
  \item\docValue{colon}
    separates the two with a colon and space, e.g. ‘23: 2’.
%<y>    It is intended for use with \textsf{oxnotes} and not recommended for this style.
  \item\docValue{comma}
    separates the two with a comma and space, e.g. ‘23, 2’.
  \item\docValue{parens}
    sets off the issue number in parentheses, e.g. ‘23 (2)’.
  \end{itemize}
\end{docKey}

\begin{docKey}{nopublisher}{=\val{true}|\val{false}}{default \val{true}, initially \val{false}}
  Removes publisher name from all entries.
\end{docKey}

%<*n>
\begin{docKey}{scnames}{=\val{true}|\val{false}}{default \val{true}, initially \val{false}}
  Prints initial author or editor names in bibliography entries in small capitals.
\end{docKey}
%</n>

\textsf{Oxref} makes of Biber-specific techniques to solve some of the challenges
presented by Oxford style. If you resort to using Bib\TeX\ instead,
you will have to correct the sort order of certain entries manually with
\texttt{sortkey}, and use some messy workarounds to get things like reviews
working properly.

\section{How to use this document}

Bibliographical items are given throughout this document, and serve three purposes:

\begin{itemize}
  \item
  To demonstrate which of the variations discussed by the
  \emph{Oxford Guide to Style} and \emph{New Hart's Rules} have been chosen
  in this style.
  \item
  To help me, as package author, check that the style is working as intended.
  \item
  To show you, as document author, how to use the style to get the effect you want.
\end{itemize}

Examples that follow standard \textsf{biblatex} semantics, and are therefore
(mostly) portable to other styles, are in green:

\begin{tcolorbox}%
  [bicolor
  ,colframe = ok
  ,colback = ok!5!white
  ,colbacklower = white
  ,fontlower = \footnotesize\ttfamily
  ,overlay = {\node[anchor=south east,text=teal] at (frame.south east) {Source};}
  ]
  \hangfrom{\booksym\space} Reference text as it should look.\par
  \hangfrom{\cogsym\space} Reference text as generated by \textsf{biblatex}.
  \tcblower
  Code used in bibliography file.
\end{tcolorbox}

Examples that have been ‘hacked’ in some way, and are therefore not portable
to other styles, are in amber:

\begin{tcolorbox}%
  [bicolor
  ,colframe = hacked
  ,colback = hacked!5!white
  ,colbacklower = white
  ,fontlower = \footnotesize\ttfamily
  ,overlay = {\node[anchor=south east,text=teal] at (frame.south east) {Source};}
  ]
  \hangfrom{\booksym\space} Reference text as it should look.\par
  \hangfrom{\cogsym\space} Reference text as generated by \textsf{biblatex}.
  \tcblower
  Code used in bibliography file.
\end{tcolorbox}

Where a source is provided, it refers to a section from one of the reference works below:

\begin{description}
\item[OGS]
\fullcite{ritter2002ogs}

\item[NHR]
\fullcite{waddingham2014nhr}
\end{description}

Where the source is starred (*), this indicates the example is not quite how it appears in the book,
usually because the original is demonstrating an option that is not the \textsf{oxref} default.
%<*y>
Where the source is marked with a dagger (\textdagger),
this indicates that the example has been coverted from an \textsf{oxnotes}-style one,
since the guides provide relatively few for author-year references.
%</y>

\section{Design philosophy}

The stipulations given by the \emph{Oxford Guide to Style} regarding citations and references
amount not so much to a consistent style as a body of advice for creating one.
Unlike the style manuals published by the American Psychological Association,
the Modern Language Association, and the University of Chicago,
the emphasis of the Oxford guide is to describe good practice rather than prescribe it.
This means that when it comes to \textsf{oxref}, there are decisions to be made
as to which variations to support by default, which to support as options,
and which to quietly ignore.

The situation is complicated further by the nature of the available versions.
The 2002 guide remains the most comprehensive in terms of rules, principles and examples.
The succeeding versions, under the title \emph{New Hart's Rules},
update the aspects of the 2002 guide that now seem somewhat dated,
such as its handling of URLs and DOIs,
and have more of an eye on machine processing of bibliographies.
They do, however, introduce some more variations with less of a steer on what is preferred,
and are considerably shorter with fewer examples.

The approach of \textsf{oxref} is to follow the 2014 \emph{New Hart's Rules} as much as possible,
but where variations are given without strong preference, or where guidance is lacking,
to follow the preferences of the 2002 guide.
Where the practices of the humanities and the sciences are contrasted,
the former are followed for \textsf{oxnotes} and the latter for \textsf{oxyear}.
Where neither version gives explicit guidance on citing a resource supported by \textsf{biblatex},
\textsf{oxref} extrapolates from what is provided, guided by standard \textsf{biblatex}
and other major referencing styles.

Where it is practical to do so,
ways and means of achieving the variations defined by the two guides are provided,
but by no means all of them will be supported.

\section{To do}

The following entry types are currently untested;
that is, there are no examples of them in this documentation.

\begin{multicols}{3}
  \begin{itemize}\firmlist
    \item suppbook
    \item booklet
    \item suppcollection
    \item misc
    \item patent
    \item periodical
    \item suppperiodical
    \item mvproceedings
    \item inreference
    \item artwork
    \item commentary
    \item jurisdiction
    \item legislation
    \item legal
    \item letter
    \item movie
    \item performance
    \item standard
  \end{itemize}
\end{multicols}

Additional tasks:

\begin{itemize}
  \item Provide mechanism for properly rendering pseudepigraphical names.
  \item Provide mechanism for using ‘Anonymous’ as an author name.
  \item Provide citation style that matches the \emph{OGS} suggestions for shorthand expressions in notes.
\end{itemize}


\chapter{Articles and periodicals}\label{sec:article}
\chapterprecis{article, periodical, suppperiodical, review}


\section{Articles in periodicals with volumes/numbers}

The \emph{Oxford Guide to Style} consistently prefers volume and part numbers to be written like \enquote{23/2}, but also discusses formats such as \enquote{23: 2} and \enquote{23 (2)}. \emph{New Hart's Rules} adds \enquote{23, 2} as a further possibility. The latter two are better suited to \textsf{oxyear} which uses a colon to demarcate the page numbers. These variations are implemented as the option \textsf{issuestyle}; see \autoref{sec:loading} for details.

%<n>\spec{Author, \enquote{Title}, \emph{JournalTitle}, Vol/Number (Year), Pages.}
%<y>\spec{Author (Year), \enquote{Title}, \emph{JournalTitle}, Vol/Number: Pages.}

%</n|y>
%<*n>
\begin{bibexbox}<OGS \S15.4.1>
{goldblatt1973dmm}
Robert Goldblatt, \enquote{Diodorean Modality in Minkowski Space-Time}, \emph{Studia Logica}, 39/3 (1973), 219--36.
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@article{goldblatt1973dmm,
  author = {Robert Goldblatt},
  title = {Diodorean Modality in Minkowski Space-Time},
  journaltitle = {Studia Logica},
  volume = {39},
  number = {3},
  date = {1973},
  pages = {219-236}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

%</n>
%<*y>
\begin{bibexbox}<OGS \S15.19.2>
{hollingsworth1957dsb}
Hollingsworth, T. H. (1957), \enquote{A Demographic Study of the British Ducal Families}, \emph{Population Studies}, 11/1: 4–26.
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@article{hollingsworth1957dsb,
  author = {T. H. Hollingsworth},
  year = {1957},
  title = {A Demographic Study of the British Ducal Families},
  journaltitle = {Population Studies},
  volume = {11},
  number = {1},
  pages = {4-26}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%</y>
%<*n>
% Internal quotes, subtitle, no number
\begin{bibexbox}<OGS \S15.4.1>
{inalcik1992csm}
Halil Inalcik, \enquote{Comments on \enquote{Sultanism}: Max Weber's Typification of the Ottoman Polity}, \emph{Princeton Papers in Near Eastern Studies}, 1 (1992), 49--72.
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@article{inalcik1992csm,
  author = {Halil Inalcik},
  title = {Comments on \enquote{Sultanism}},
  subtitle = {Max Weber's Typification of the Ottoman Polity},
  journaltitle = {Princeton Papers in Near Eastern Studies},
  volume = {1},
  date = {1992},
  pages = {49-72}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

%</n>
%<*y>
% Subtitle
\begin{bibexbox}<NHR \S17.3.2*>
{unwin1994sce}
Unwin, T. (1994), \enquote{Structural Change in Estonian Agriculture: From Command Economy to Privatisation}, \emph{Geography}, 79/3: 246–61.
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@article{unwin1994sce,
  author = {Tim Unwin},
  year = {1994},
  title = {Structural Change in Estonian Agriculture},
  subtitle = {From Command Economy to Privatisation},
  journaltitle = {Geography},
  volume = {79},
  number = {3},
  pages = {246-261}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}
%</y>
%<*n|y>

% Many authors, 'von' part, no number
\begin{bibexbox}
%<n><OGS \S15.2.1>
%<y><OGS \S15.2.1\textdagger>
{vaucouleurs1975nmn}
%<n>Gerald de Vaucouleurs et al., \enquote{The New Martian Nomenclature of the International Astronomical Union}, \emph{Icarus}, 26 (1975), 85--98.
%<y>Vaucouleurs, G. de, et al. (1975), \enquote{The New Martian Nomenclature of the International Astronomical Union}, \emph{Icarus}, 26: 85--98.
\tcblower
\begin{Verbatim}
%</n|y>
@article{vaucouleurs1975nmn,
  author = {Gerald de Vaucouleurs and J. Blunck and M. Davies and A. Dollfus and I. Koval and
    G. Kuiper and H. Masursky and S. Miyamoto and V Moroz and Carl Sagan},
  title = {The New {Martian} Nomenclature of the {International} {Astronomical} {Union}},
  journaltitle = {Icarus},
  volume = {26},
  date = {1975},
  pages = {85-98}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

% DOI
\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{druin2002rcd}
%<n>A. Druin, \enquote{The Role of Children in the Design of New Technology}, \emph{Behaviour \& Information Technology}, 21/1 (2002), 1–25. doi: \path{10.1080/01449290110108659}
%<y>Druin, A. (2002), \enquote{The Role of Children in the Design of New Technology}, \emph{Behaviour \& Information Technology}, 21/1: 1–25. doi: \path{10.1080/01449290110108659}
\tcblower
\begin{Verbatim}
%</n|y>
@article{druin2002rcd,
  author = {A. Druin},
  title = {The Role of Children in the Design of New Technology},
  journaltitle = {Behaviour \& Information Technology},
  volume = {21},
  number = {1},
  date = {2002},
  pages = {1-25},
  doi = {10.1080/01449290110108659}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

% Electronic identifier instead of a page range
\begin{bibexbox}
%<n><NHR \S18.8.5*>
%<y><NHR \S18.8.5*\textdagger>
{li.etal2013flh}
%<n>Shu Li et al., \enquote{Forever Love: The Hitherto Earliest Record of Copulating Insects from the Middle Jurassic of China}, \emph{PLoS ONE}, 8/11 (2013), e78188. doi: \path{10.1371/journal.pone.0078188}
%<y>Li, S. et al. (2013), \enquote{Forever Love: The Hitherto Earliest Record of Copulating Insects from the Middle Jurassic of China}, \emph{PLoS ONE}, 8/11, e78188. doi: \path{10.1371/journal.pone.0078188}
\tcblower
\begin{Verbatim}
%</n|y>
@article{li.etal2013flh,
  author = {Shu Li and Chungkun Shih and Chen Wang and Hong Pang and Dong Ren},
  title = {Forever Love},
  subtitle = {The Hitherto Earliest Record of Copulating Insects from the Middle Jurassic of China},
  journaltitle = {PLoS ONE},
  volume = {8},
  number = {11},
  date = {2013},
  eid = {e78188},
  doi = {10.1371/journal.pone.0078188}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

%</n|y>
%<*n>
\begin{bibexbox}(hacked)<OGS \S15.4.1>
{lindars1965eir}
B. Lindars, \enquote{Ezechiel and Individual Responsibility}, \emph{VT} 15 (1965), 452--67.
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@article{lindars1965eir,
  author = {B. Lindars},
  title = {Ezechiel and Individual Responsibility},
  journaltitle = {VT\nopunct},
  volume = {15},
  date = {1965},
  pages = {452-467},
}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

\hack{If the last\slash only word of the journal title is abbreviated (indicated by point or capital letter), it does not need a comma after it. This can be achieved by adding \cs{nopunct} to the end of the journal title.}
%</n>
%<*n|y>


\section{Articles in periodicals with series}

%<n>\spec{Author, \enquote{Title}, \emph{JournalTitle}, nth \lit{ser}., Vol/Number (Year), Pages.}
%<y>\spec{Author (Year), \enquote{Title}, \emph{JournalTitle}, nth \lit{ser}., Vol/Number: Pages.}

\begin{bibexbox}
%<n><NHR \S18.3.3>
%<y><NHR \S18.3.3\textdagger>
{moody1953mdb}
%<n>T. W. Moody, \enquote{Michael Davitt and the British Labour Movement, 1882–1906}, \emph{Transactions of the Royal Historical Society}, 5th ser., 3 (1953), 53--76.
%<y>Moody, T. W. (1953), \enquote{Michael Davitt and the British Labour Movement, 1882–1906}, \emph{Transactions of the Royal Historical Society}, 5th ser., 3: 53--76.
\tcblower
\begin{Verbatim}
%</n|y>
@article{moody1953mdb,
  author = {T. W. Moody},
  title = {Michael Davitt and the British Labour Movement, 1882–1906},
  journaltitle = {Transactions of the Royal Historical Society},
  series = {5},
  volume = {3},
  date = {1953},
  pages = {53-76}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

%<n>\spec{Author, \enquote{Title}, \emph{JournalTitle}, \textsc{ns} Vol/Number (Year), Pages.}
%<y>\spec{Author (Year), \enquote{Title}, \emph{JournalTitle}, \textsc{ns} Vol/Number, Pages.}

%</n|y>
%<*n>
\begin{bibexbox}<OGS \S15.4.3>
{barnes1971has}
J. Barnes, \enquote{Homonymy in Aristotle and Speusippus}, \emph{Classical Quarterly}, \textsc{ns} 21 (1971), 65--80.
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@article{barnes1971has,
  author = {J. Barnes},
  title = {Homonymy in Aristotle and Speusippus},
  journaltitle = {Classical Quarterly},
  series = {newseries},
  volume = {21},
  date = {1971},
  pages = {65--80}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

%</n>
%<*y>
\begin{bibexbox}(hacked)<OGS \S15.19.2>
{hankinson1989gba}
Hankinson, R. J. (1989), \enquote{Galen and the Best of All Possible Worlds}, \emph{CQ} \textsc{ns} 39: 43–76.
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@article{hankinson1989gba,
  author = {R. J. Hankinson},
  year = {1989},
  title = {Galen and the Best of All Possible Worlds},
  journaltitle = {CQ\nopunct},
  series = {newseries},
  volume = {39},
  pages = {43–76}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

\hack{If the last\slash only word of the journal title is abbreviated (indicated by point or capital letter), it does not need a comma after it. This can be achieved by adding \cs{nopunct} to the end of the journal title.}
%</y>
%<*n|y>


\section{Articles in issues identified by date alone}

%<n>\spec{Author, \enquote{Title}, \emph{JournalTitle}, Day Month Year, Pages.}
%<y>\spec{Author (Year), \enquote{Title}, \emph{JournalTitle}, Day Month: Pages.}

%</n|y>
%<*n>
% No author
\begin{bibexbox}<OGS \S15.4.1>
{bw1984wen}
\enquote{Who's Excellent Now?}, \emph{Business Week}, 5 Nov. 1984, 76--86.
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@article{bw1984wen,
  title = {Who's Excellent Now?},
  journaltitle = {Business Week},
  date = {1984-11-05},
  pages = {76-86}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

% No pages
\begin{bibexbox}<OGS \S15.4.1>
{lee1995ehf}
Alan Lee, \enquote{England Haunted by Familiar Failings}, \emph{The Times}, 23 June 1995.
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@article{lee1995ehf,
  author = {Alan Lee},
  title = {England Haunted by Familiar Failings},
  journaltitle = {The Times},
  date = {1995-06-23}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

%</n>
%<*y>
\begin{bibexbox}<OGS \S15.19.2*>
{marx1842kaa}
Marx, K. (1842), \enquote{Der Kommunismus und die Augsburger \enquote{Allgemeine Zeitung}}, \emph{Rheinische Zeitung}, 16 Oct.: 1–2.
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@article{marx1842kaa,
  author = {Karl Marx},
  title = {Der Kommunismus und die Augsburger \enquote{Allgemeine Zeitung}},
  journaltitle = {Rheinische Zeitung},
  date = {1842-10-16},
  pages = {1-2}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

NB. The above example as it appears in the \emph{Oxford Guide to Style} is both incomplete and wildly inaccurate.
I have completed and corrected it as best I can ascertain.

% No pages
\begin{bibexbox}<OGS \S15.19.2>
{who1983nsb}
WHO (World Health Organization) (1983), \enquote{Nutrition: Sex Bias of Nutritional Status of Children 0–4 Years}, \emph{Weekly Epidemiologial Record}, 20 May.
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@article{who1983nsb,
  shortauthor = {WHO},
  author = {{World Health Organization}},
  date = {1983-05-20},
  title = {Nutrition},
  subtitle = {Sex Bias of Nutritional Status of Children 0–4 Years},
  journaltitle = {Weekly Epidemiologial Record}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%</y>
%<*n|y>

% Year as volume number
\begin{bibexbox}
%<n><OGS \S15.3>
%<y><OGS \S15.3\textdagger>
{boyce1957pgi}
%<n>M. Boyce, \enquote{The Parthian \emph{Gsn} and Iranian Minstrel Tradition}, \emph{Journal of the Royal Asiatic Society}, 1957, 10--45.
%<y>Boyce, M. (1957), \enquote{The Parthian \emph{Gsn} and Iranian Minstrel Tradition}, \emph{Journal of the Royal Asiatic Society}: 10--45.
\tcblower
\begin{Verbatim}
%</n|y>
@article{boyce1957pgi,
  author = {M. Boyce},
  title = {The Parthian \emph{Gsn} and Iranian Minstrel Tradition},
  journaltitle = {Journal of the Royal Asiatic Society},
  date = {1957},
  pages = {10-45}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\section{Works published as an issue}

These examples illustrate where a book is also published as a whole
issue of a periodical, and show how you may reference both at once.
You can either add the periodical details to a book entry
or add the book details to a periodical entry.

%<n>\spec{Author, \emph{Title} = \emph{JournalTitle}, Vol/Number (Location: Publisher, Year), pages.}
%<y>\spec{Author (Year), \emph{Title} = \emph{JournalTitle}, Vol/Number (Location: Publisher), pages.}

\tip{Use \code{equals} as the \code{relatedtype}.}

\begin{bibexbox}
%<n><OGS \S15.4.1>
%<y><OGS \S15.4.1\textdagger>
{bec1976isc}
%<n>C. Bec (ed.), \emph{Italie 1500--1550: Une situation de crise?} = \emph{Annales de l'Université Jean Moulin}, 1975/2 (Langues étrangères, 2; Lyon, 1976), 99--109.
%<y>Bec, C. (1976) (ed.), \emph{Italie 1500--1550: Une situation de crise?} = \emph{Annales de l'Université Jean Moulin}, 1975/2 (Langues étrangères, 2; Lyon), 99--109.
\tcblower
\begin{Verbatim}
%</n|y>
@collection{bec1976isc,
  editor = {C. Bec},
  title = {Italie 1500--1550},
  subtitle = {Une situation de crise?},
  related = {aujm1975.2},
  relatedtype = {equals},
  series = {Langues étrangères},
  number = {2},
  location = {Lyon},
  date = {1976},
  pages = {99--109}}
@periodical{aujm1975.2,
  title = {Annales de l'Université Jean Moulin},
  volume = {1975},
  number = {2}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

%<n>\spec{Author, \emph{Title} = \emph{JournalTitle}, Vol/Number (Year).}
%<y>\spec{Author (Year), \emph{Title} = \emph{JournalTitle}, Vol/Number.}

\tip{Use \code{issuetitle} instead of \code{title} to get the right formatting.}

\begin{bibexbox}
%<n><OGS \S15.4.1>
%<y><OGS \S15.4.1\textdagger>
{trisoglio1973gnq}
%<n>F. Trisoglio, \emph{Gregorio di Nazianzo in un quarentennio di recherche (1925--1965)} = \emph{Rivista Iasalliana}, 40 (1973).
%<y>Trisoglio, F. (1973), \emph{Gregorio di Nazianzo in un quarentennio di recherche (1925--1965)} = \emph{Rivista Iasalliana}, 40.
\tcblower
\begin{Verbatim}
%</n|y>
@article{trisoglio1973gnq,
  author = {F. Trisoglio},
  issuetitle = {Gregorio di Nazianzo in un quarentennio di recherche (1925--1965)},
  journaltitle = {Rivista Iasalliana},
  volume = {40},
  date = {1973}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


\section{Articles in an issue that is a supplement to another issue}


\DeclareNumChars*{S}

%<n>\spec{Author, \enquote{Title}, \emph{JournalTitle}, Vol/Number (Year); \lit{Supplement to} \emph{MainJournalTitle} Vol/Number, Pages.}
%<y>\spec{Author (Year), \enquote{Title}, \emph{JournalTitle}, Vol/Number; \lit{Supplement to} \emph{MainJournalTitle} Vol/Number: Pages.}

\tip{To get this format, use a separate entry for the parent issue, reference it in the ‘related’ field, and use the key ‘suppto’ as the ‘relatedtype’.}
\tip{To achieve the same effect with Bib\TeX, use the \code{note} field to write ‘Supplement to’ and a \cs{fullcite} reference to a \texttt{periodical}. You will probably want to assign a category to the periodical entry and exclude it from the bibliography.}%

\begin{bibexbox}
%<n><OGS \S15.4.1>
%<y><OGS \S15.4.1\textdagger>
{zhentao.etal1989ars}
%<n>X. Zhentao, K. K. C. Yau, and F. R. Stephenson, \enquote{Astronomical Records on the Shang Dynasty Oracle Bones}, \emph{Archaeoastronomy}, 14 (1989); Supplement to \emph{Journal for the History of Astronomy}, 20, pp. S61--S72.
%<y>Zhentao, X., Yau, K. K. C., and Stephenson, F. R. (1989) \enquote{Astronomical Records on the Shang Dynasty Oracle Bones}, \emph{Archaeoastronomy}, 14; Supplement to \emph{Journal for the History of Astronomy}, 20, pp. S61--S72.
\tcblower
\begin{Verbatim}
%</n|y>
@article{zhentao.etal1989ars,
  author = {X. Zhentao and K. K. C. Yau and F. R. Stephenson},
  title = {Astronomical Records on the Shang Dynasty Oracle Bones},
  journaltitle = {Archaeoastronomy},
  volume = {14},
  date = {1989},
  related = {jha1989},
  relatedtype = {suppto},
  pages = {S61-S72},
  bookpagination = {page}
}
@periodical{jha1989,
  title = {Journal for the History of Astronomy},
  volume = {20}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\tip{Use \code{bookpagination} to force the display of ‘pp.’ (since the number format is odd), and \cs{DeclareNumChars*}\brackets{S} to ensure that \code{S61} is recognized as a number.}%

\section{Accepted journal articles, pre-publication}

%<n>\spec{Author, \enquote{Title} (\lit{to be published in} \emph{JournalTitle}, Year).}
%<y>\spec{Author (Year), \enquote{Title} (\lit{to be published in} \emph{JournalTitle}).}

\section{Reviews}

%<n>\spec{Author, \enquote{Title}, \lit{review of} ReviewedWork, \lit{in} \emph{JournalTitle}, Vol/Number (Year), Pages.}
%<y>\spec{Author (Year), \enquote{Title}, \lit{review of} ReviewedWork, \lit{in} \emph{JournalTitle}, Vol/Number: Pages.}

\tip{To get this format, use a separate entry for the reviewed item, reference it in the ‘related’ field, and use the key ‘reviewof’ as the ‘relatedtype’.}

\begin{bibexbox}
%<n><OGS \S15.4.4>
%<y><OGS \S15.4.4\textdagger>
{dean1995rpb}
%<n>J. Dean, review of Philippe Basiron, \emph{My Early Life} (Bourges, 1994), in \emph{Res facta}, 17 (1995), 56--9.
%<y>Dean, J. (1995), review of P. Basiron (1994), \emph{My Early Life} (Bourges), in \emph{Res facta}, 17: 56--9.
\tcblower
\begin{Verbatim}
%</n|y>
@review{dean1995rpb,
  author = {J. Dean},
  related = {basiron1994mel},
  relatedtype = {reviewof},
  journaltitle = {Res facta},
  volume = {17},
  date = {1995},
  pages = {56-59}
}
@book{basiron1994mel,
  author = {Philippe Basiron},
  title = {My Early Life},
  location = {Bourges},
  year = {1994}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\tip{To achieve the same effect with Bib\TeX, set the option \code{reviewof} with the value of the key of reviewed item; the reviewed item is given the category \code{reviewed} so it can be excluded from the bibliography if desired. The following example shows this in action%
%<y>; note that the result is not quite satisfactory%
.}

\begin{bibexbox}
%<n><OGS \S15.4.4>
%<y><OGS \S15.4.4\textdagger>
{jocelyn1989pav}
%<n>H. D. Jocelyn, \enquote{Probus and Virgil}, review of Maria Luisa Delvigo, \emph{Testo virgiliano e tradizione indiretta} (Pisa, 1987), in \emph{CR}, \textsc{ns} 39 (1989), 27--8.
%<y>Jocelyn, H. D. (1989), \enquote{Probus and Virgil}, review of M. L. Delvigo (1987), \emph{Testo virgiliano e tradizione indiretta} (Pisa), in \emph{CR}, \textsc{ns} 39: 27--8.
\tcblower
\begin{Verbatim}
%</n|y>
@review{jocelyn1989pav,
  author = {H. D. Jocelyn},
  title = {Probus and Virgil},
  options = {reviewof=delvigo1987tvt},
  journaltitle = {CR},
  series = {newseries},
  volume = {39},
  date = {1989},
  pages = {27-28}
}
@book{delvigo1987tvt,
  author = {Maria Luisa Delvigo},
  title = {Testo virgiliano e tradizione indiretta},
  location = {Pisa},
  date = {1987}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


\chapter{Books}\label{sec:book}
\chapterprecis{book, mvbook, collection, mvcollection, reference, mvreference}

\section{Monographs}

Biblatex defines \code{book} as a monograph, written either by a single author, or by several authors who have joint responsibility for the entire work. An editor in this context has a modest role selecting or annotating the content, and therefore in Oxford style is given after the title even if the author is not given.

\subsection{Basic form}

%<n>\spec{Author, \emph{Title} (Location: Publisher, Year).}
%<y>\spec{Author (Year), \emph{Title} (Location: Publisher).}

%</n|y>
%<*n>
\begin{bibexbox}<OGS \S15.2.1>
{eliot1977m}
George Eliot, \emph{Middlemarch} (New York: W. W. Norton, 1977).
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@book{eliot1977m,
  author = {George Eliot},
  title = {Middlemarch},
  location = {New York},
  publisher = {W. W. Norton},
  date = {1977}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}<OGS \S15.2.2>
{benvenuti1986op}
Antonia Tissoni Benvenuti, \emph{L'\emph{Orfeo} del Poliziano} (Padua: Editrice Antenore, 1986).
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@book{benvenuti1986op,
  author = {Antonia Tissoni Benvenuti},
  title = {L'\emph{Orfeo} del Poliziano},
  location = {Padua},
  publisher = {Editrice Antenore},
  date = {1986}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}<OGS \S15.2.2>
{oconor1977sjf}
Roderick O'Conor, \emph{A Sentimental Journal through \enquote{Finnegan's Wake}, with a Map of the Liffey} (Dublin: HCE Press, 1977).
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@book{oconor1977sjf,
  author = {Roderick O'Conor},
  title = {A Sentimental Journal through \enquote{Finnegan's Wake}, with a Map of the {Liffey}},
  location = {Dublin},
  publisher = {HCE Press},
  date = {1977}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

%</n>
%<*y>
\begin{bibexbox}<NHR \S18.5>
{lyons1981lli}
Lyons, J. (1981a), \emph{Language and Linguistics: An Introduction} (Cambridge: Cambridge University Press).
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@book{lyons1981lli,
  author = {John Lyons},
  date = {1981},
  title = {Language and Linguistics},
  subtitle = {An Introduction},
  location = {Cambridge},
  publisher = {Cambridge University Press}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}<NHR \S18.5>
{lyons1981lmc}
Lyons, J. (1981b), \emph{Language, Meaning and Context} (London: Fontana Paperbacks).
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@book{lyons1981lmc,
  author = {John Lyons},
  date = {1981},
  title = {Language, Meaning and Context},
  location = {London},
  publisher = {Fontana Paperbacks}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%</y>
%<*n|y>

\subsection{No publisher}

%<n>\spec{Author, \emph{Title} (Location, Year).}
%<y>\spec{Author (Year), \emph{Title} (Location).}

%</n|y>
%<*n>
\begin{bibexbox}<OGS \S15.2.1>
{balfour1768pe}
{[James Balfour]}, \emph{Philosophical Essays} (Edinburgh, 1768).
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@book{balfour1768pe,
  author = {James Balfour},
  authortype = {inferred},
  title = {Philosophical Essays},
  location = {Edinburgh},
  date = {1768}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

%</n>
%<*y>
\begin{bibexbox}<OGS \S15.19.2>
{smith1988fag}
Smith, T. (1988), \emph{Famine and Gender} (New Haven, Conn.).
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@book{smith1988fag,
  author = {Smith, T.},
  title = {Famine and Gender},
  year = {1988},
  location = {New Haven, Conn.}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%</y>
%<*n|y>

\subsection{Edited book}

%<n>\spec{Author, \emph{Title}, \lit{ed.} Editor(s) (Location: Publisher, Year).}
%<y>\spec{Author (Year), \emph{Title}, \lit{ed.} Editor(s) (Location: Publisher).}

\begin{bibexbox}
%<n><OGS \S15.2.1>
%<y><OGS \S15.2.1\textdagger>
{boethius1976dds}
%<n>Pseudo-Boethius, \emph{De disciplina scolarium: Édition critique, introduction et notes}, ed. Olga Weijers (Leiden, 1976).
%<y>Pseudo-Boethius (1976), \emph{De disciplina scolarium: Édition critique, introduction et notes}, ed. O.\ Weijers (Leiden).
\tcblower
\begin{Verbatim}
%</n|y>
@book{boethius1976dds,
  author = {Pseudo-Boethius},
  title = {De disciplina scolarium},
  subtitle = {Édition critique, introduction et notes},
  editor = {Olga Weijers},
  location = {Leiden},
  date = {1976}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

%<n>\spec{\emph{Title}, \lit{ed.} Editor(s) (Location: Publisher, Year).}
%<y>\spec{\emph{Title} (Year), \lit{ed.} Editor(s) (Location: Publisher).}

\begin{bibexbox}
%<n><OGS \S15.2.1>
%<y><OGS \S15.2.1\textdagger>
{boas.botschuyver1952dc}
%<n>\emph{Distichia Catonis}, ed. Marcus Boas and Henricus Johannes Botschuyver (Amsterdam, 1952).
%<y>\emph{Distichia Catonis} (1952), ed. M.\ Boas and H.\ J.\ Botschuyver (Amsterdam).
\tcblower
\begin{Verbatim}
%</n|y>
@book{boas.botschuyver1952dc,
  title = {Distichia Catonis},
  editor = {Marcus Boas and Henricus Johannes Botschuyver},
  location = {Amsterdam},
  date = {1952}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\section{Collections}

Biblatex defines \code{collection} as a book made up of multiple self-contained contributions from distinct authors. There is no overall author: use the regular \code{book} entry type for collections of a single author’s work. The editor in this case has a more active role and therefore comes before the title.

%<n>\spec{Editor (\lit{ed.}), \emph{Title} (Location: Publisher, Year).}
%<y>\spec{Editor (Year) (\lit{ed.}), \emph{Title} (Location: Publisher).}

%</n|y>
%<*n>
\begin{bibexbox}<OGS \S15.2.1>
{stewart.etal1994mb}
Rosemary Stewart et al. (eds.), \emph{Managing in Britain} (London, 1994).
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@collection{stewart.etal1994mb,
  editor = {Rosemary Stewart and Jean-Louis Barsoux and Alfred Kieser and Hans-Dieter Ganter and Peter Walgenbach},
  title = {Managing in {Britain}},
  location = {London},
  date = {1994}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

%</n>
%<*y>
\begin{bibexbox}<OGS \S15.19.2>
{barnes.griffin1989pte}
Barnes, J., and Griffin, M. T. (1989) (eds.), \emph{Philosophia Togata: Essays on Philosophy and Roman Society} (Oxford).
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@collection{barnes.griffin1989pte,
  editor = {Jonathan Barnes and Miriam T. Griffin},
  date = {1989},
  title = {Philosophia Togata},
  subtitle = {Essays on Philosophy and Roman Society},
  location = {Oxford}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%</y>
%<*n|y>%

%</n|y>
%<*y>
\begin{bibexbox}<OGS \S15.19.2>
{hankinson1988mmm}
Hankinson, R. J. (1988) (ed.), \emph{Method, Medicine, and Metaphysics} (Edmonton, Alta.).
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@collection{hankinson1988mmm,
  editor = {R. J. Hankinson},
  year = {1988},
  title = {Method, Medicine, and Metaphysics},
  location = {Edmonton, Alta.}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%</y>
%<*n|y>

\section{Reference works}

Biblatex uses \code{reference} for encyclopaedias and dictionaries, which are typically made up of many small contributions by distinct authors and compiled by an editorial board whose membership might change between successive editions. From a database perspective, reference works are like collections in that they have no single author (a reference work written by a single author should use the \code{book} entry type instead). Unlike standard Biblatex, though, Oxford style considers the titles of reference works to be more important and memorable than those of the editor, and so lists the title first.

%<n>\spec{\emph{Title}, \lit{ed.} Editor(s) (Location: Publisher, Year).}
%<y>\spec{\emph{Title} (Year), \lit{ed.} Editor(s) (Location: Publisher).}

\begin{bibexbox}
%<n><OGS \S15.2.1>
%<y><OGS \S15.2.1\textdagger>
{fortenbaugh.etal1991tes}
%<n>\emph{Theophrastus of Eresus: Sources for his Life, Writings, Thought, and Influence}, ed. William W. Fortenbaugh et al., 2 vols. (Philosophia Antiqua, 54; Leiden, 1991).
%<y>\emph{Theophrastus of Eresus: Sources for his Life, Writings, Thought, and Influence} (1991), ed. W. W. Fortenbaugh et al., 2 vols. (Philosophia Antiqua, 54; Leiden).
\tcblower
\begin{Verbatim}
%</n|y>
@mvreference{fortenbaugh.etal1991tes,
  title = {{Theophrastus} of {Eresus}},
  subtitle = {Sources for his Life, Writings, Thought, and Influence},
  editor = {William W. Fortenbaugh and Pamela M Huby and Robert W. Sharples and Dimitri Gutas
    and others},
  volumes = {2},
  series = {Philosophia Antiqua},
  number = {54},
  location = {Leiden},
  date = {1991}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


\section{Multi-volume works}

Biblatex provides additional entry types for multi-volume works: \code{mvbook}, \code{mvcollection} and \code{mvreference} respectively. These can be used to cite all the volumes at once, or just one volume from the set.

\subsection{All volumes}

Where all volumes were published consistently, the following form is used:

%<n>\spec{Author, \emph{Title}, n \lit{vols.} (Location: Publisher, Year), VolNo. Pages.}
%<y>\spec{Author (Year), \emph{Title}, n \lit{vols.} (Location: Publisher), VolNo. Pages.}

\begin{bibexbox}
%<n><OGS \S15.2.6>
%<y><OGS \S15.2.6\textdagger>
[\nopp ii.~\mkcomprange{367--368}]
{straeten1867lmp}%
[title = {\texttt{\string\autocite[\string\nopp\ ii.~\string\mkcomprange\{367--368\}]\{straeten1867lmp\}}}]
%<n>Edmond Vander Straeten, \emph{La Musique aux Pays-Bas avant le XIX\textsuperscript{e} siècle}, 8 vols. (Brussels, 1867--88), ii. 367--8.
%<y>Vander Straeten, E. (1867--88), \emph{La Musique aux Pays-Bas avant le XIX\textsuperscript{e} siècle}, 8 vols. (Brussels), ii. 367--8.
\tcblower
\begin{Verbatim}
%</n|y>
@mvbook{straeten1867lmp,
    author = {Edmond {Vander Straeten}},
    title = {La Musique aux Pays-Bas avant le XIX\textsuperscript{e} siècle},
    volumes = {8},
    location = {Brussels},
    date = {1867/1888}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

Where the publisher changed between volumes, the following form is used:

%<n>\spec{Author, \emph{Title}, VolNo, n \lit{vols.} (Location: Publisher and Location: Publisher, Year–Year).}
%<y>\spec{Author (Year–Year), \emph{Title}, VolNo, n \lit{vols.} (Location: Publisher and Location: Publisher).}

\begin{bibexbox}
%<n><OGS \S15.2.6*>
%<y><OGS \S15.2.6*\textdagger>
{ritter1838hap}
%<n>Heinrich Ritter, \emph{The History of Ancient Philosophy}, trans. Alexander J. W. Morrison, 4~vols. (Oxford: Talboys and London: Bohn, 1838--46).
%<y>Ritter, H. (1838--46), \emph{The History of Ancient Philosophy}, trans. A. J. W. Morrison, 4~vols. (Oxford: Talboys and London: Bohn).
\tcblower
\begin{Verbatim}
%</n|y>
@mvbook{ritter1838hap,
  author = {Heinrich Ritter},
  title = {The History of Ancient Philosophy},
  translator = {Alexander J. W. Morrison},
  volumes = {4},
  location = {Oxford and London},
  publisher = {Talboys and Bohn},
  date = {1838/1846}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

NB. In the \emph{Oxford Style Manual}, the translator in the above reference is in parentheses,
but as this pattern does not occur in any other it may be an error or stylistic variation.

\subsection{One volume from several}

Where the volumes are merely numbered, the following form is used:

%<n>\spec{Author, \emph{Title}, VolNo (Location: Publisher, Year), Pages.}
%<y>\spec{Author (Year), \emph{Title}, VolNo (Location: Publisher), Pages.}

\tip{To get this format, do not use \code{maintitle}: put the title of the whole work in \code{title}.}

%</n|y>
%<*n>
\begin{bibexbox}<OGS \S15.2.6>[367--368]
{straeten1867lmp.ii}
Edmond Vander Straeten, \emph{La Musique aux Pays-Bas avant le XIX\textsuperscript{e} siècle}, ii (Brussels, 1867--88), 367--8.
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@mvbook{straeten1867lmp.ii,
  author = {Edmond {Vander Straeten}},
  title = {La Musique aux Pays-Bas avant le XIX\textsuperscript{e} siècle},
  volume = {2},
  location = {Brussels},
  date = {1867/1888}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}
%</n>
%<*y>
\begin{bibexbox}<OGS \S15.19.2>
{annas1983osa}
Annas, J. (1983) (ed.), \emph{Oxford Studies in Ancient Philosophy}, i (Oxford).
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@mvcollection{annas1983osa,
  editor = {Annas, Julia},
  date = {1983},
  title = {Oxford Studies in Ancient Philosophy},
  volume = {1},
  location = {Oxford}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}
%</y>
%<*n|y>

Where the volumes each have their own (sub)title,
and they were all published at once (more or less),
the following form is used:

%<n>\spec{Author, \emph{Title}, VolNo: \emph{VolTitle} (Location: Publisher, Year), Pages.}
%<y>\spec{Author (Year), \emph{Title}, VolNo: \emph{VolTitle} (Location: Publisher), Pages.}

\tip{To get this format, use \code{title} for the volume title and \code{maintitle} for the whole work.}

\begin{bibexbox}
%<n><OGS \S15.2.2>
%<y><OGS \S15.2.2\textdagger>
{brady.etal1994hehsa}
%<n>Thomas A. Brady, Jr., Heiko A. Oberman, and James D. Tracy (eds.), \emph{Handbook of European History, 1400–1600: Late Middle Ages, Renaissance and Reformation}, i: \emph{Structures and Assertions} (Leiden: E. J. Brill, 1994).
%<y>Brady, Jr., T. A., Oberman, H. A., and Tracy, J. D. (1994) (eds.), \emph{Handbook of European History, 1400–1600: Late Middle Ages, Renaissance and Reformation}, i: \emph{Structures and Assertions} (Leiden: E. J. Brill).
\tcblower
\begin{Verbatim}
%</n|y>
@mvcollection{brady.etal1994hehsa,
  editor = {Brady, Jr., Thomas A. and Heiko A. Oberman and James D. Tracy},
  maintitle = {Handbook of European History, 1400–1600},
  mainsubtitle = {{Late} {Middle} {Ages,} {Renaissance} and {Reformation}},
  volume = {1},
  title = {Structures and Assertions},
  location = {Leiden},
  publisher = {E. J. Brill},
  date = {1994}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><OGS \S15.2.6>
%<y><OGS \S15.2.6\textdagger>
[42-56]
{ward.waller1932che}
%<n>A. W. Ward and A. E. Waller (eds.), \emph{The Cambridge History of English Literature}, xii: \emph{The Nineteenth Century} (Cambridge: CUP, 1932), 42--56.
%<y>Ward, A. W., and Waller, A. E. (1932) (eds.), \emph{The Cambridge History of English Literature}, xii: \emph{The Nineteenth Century} (Cambridge: CUP), 42--56.
\tcblower
\begin{Verbatim}
%</n|y>
@mvcollection{ward.waller1932che,
  editor = {A. W. Ward and A. E. Waller},
  maintitle = {The Cambridge History of English Literature},
  volume = {12},
  title = {The Nineteenth Century},
  location = {Cambridge},
  publisher = {CUP},
  date = {1932}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

Where the volumes each have their own (sub)title,
and there are many volumes spanning years and possibly publishers,
the following form is used:

%<n>\spec{Author, \emph{VolTitle}, (\lit{vol.} VolNo \lit{of} Title) (Location: Publisher, Year), Pages.}
%<y>\spec{Author (Year), \emph{VolTitle}, (\lit{vol.} VolNo \lit{of} Title) (Location: Publisher), Pages.}

\tip{To get this format, use \code{book} instead of \code{mvbook}.}

\begin{bibexbox}
%<n><NHR \S18.2.7>
%<y><NHR \S18.2.7\textdagger>
{fischer1989asf}
%<n>David Hackett Fischer, \emph{Albion’s Seed: Four British Folkways in America}, [vol.\ i of \emph{America: A Cultural History}] (New York: Oxford University Press, 1989).
%<y>Fischer, D. H. (1989), \emph{Albion’s Seed: Four British Folkways in America}, [vol.\ i of \emph{America: A Cultural History}] (New York: Oxford University Press).
\tcblower
\begin{Verbatim}
%</n|y>
@book{fischer1989asf,
  author = {David Hackett Fischer},
  title = {Albion’s Seed},
  subtitle = {Four British Folkways in America},
  volume = {1},
  maintitle = {America},
  mainsubtitle = {A Cultural History},
  location = {New York},
  publisher = {Oxford University Press},
  date = {1989}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\section{Common variations}

\subsection{Additions and translations}

Where works have significant introductions, forewords, afterwords, illustrations, etc.\ this may be noted as follows:

%<n>\spec{Author, \emph{Title}, \lit{with an} Addition \lit{by} Contributor (Location: Publisher, Year).}
%<y>\spec{Author (Year), \emph{Title}, \lit{with an} Addition \lit{by} Contributor (Location: Publisher).}

\begin{bibexbox}
%<n><OGS \S15.2.1>
%<y><OGS \S15.2.1\textdagger>
{twain1971cyk}
%<n>Mark Twain, \emph{A Connecticut Yankee at King Arthur's Court}, with an introduction by Justin Kaplan (Harmondsworth: Penguin, 1971).
%<y>Twain, M. (1971), \emph{A Connecticut Yankee at King Arthur's Court}, with an introduction by J. Kaplan (Harmondsworth: Penguin).
\tcblower
\begin{Verbatim}
%</n|y>
@book{twain1971cyk,
  author = {Mark Twain},
  title = {A {Connecticut} Yankee at {King} {Arthur's} Court},
  introduction = {Justin Kaplan},
  location = {Harmondsworth},
  publisher = {Penguin},
  date = {1971}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

Translators are credited as follows:

%<n>\spec{Author, \emph{Title}, \lit{trans.} Translator(s) (Location: Publisher, Year).}
%<y>\spec{Author (Year), \emph{Title}, \lit{trans.} Translator(s) (Location: Publisher).}

\begin{bibexbox}
%<n><NHR \S18.2.14>
%<y><NHR \S18.2.14\textdagger>
{bischoff1990lpa}
%<n>Bernhard Bischoff, \emph{Latin Palaeography: Antiquity and the Middle Ages}, trans. Dáibhi Ó Cróinín and David Ganz (Cambridge, 1990).
%<y>Bischoff, B. (1990), \emph{Latin Palaeography: Antiquity and the Middle Ages}, trans. Dáibhi Ó Cróinín and David Ganz (Cambridge).
\tcblower
\begin{Verbatim}
%</n|y>
@book{bischoff1990lpa,
  author = {Bernhard Bischoff},
  title = {Latin Palaeography},
  subtitle = {Antiquity and the Middle Ages},
  translator = {Dáibhi Ó Cróinín and David Ganz},
  location = {Cambridge},
  date = {1990}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

%<n>\spec{Author, \emph{Title}, \lit{trans.\ with} Addition Translator(s) (Location: Publisher, Year).}
%<y>\spec{Author (Year), \emph{Title}, \lit{trans.\ with} Addition Translator(s) (Location: Publisher).}

\begin{bibexbox}
%<n><NHR \S18.2.14>
%<y><NHR \S18.2.14\textdagger>
{martorell1984tlb}
%<n>Joanat Martorell, \emph{Tirant lo Blanc}, trans. with foreword David H. Rosenthal (London, 1984).
%<y>Martorell, J. (1984), \emph{Tirant lo Blanc}, trans. with foreword D. H. Rosenthal (London).
\tcblower
\begin{Verbatim}
%</n|y>
@book{martorell1984tlb,
  author = {Joanat Martorell},
  title = {Tirant lo Blanc},
  translator = {David H. Rosenthal},
  foreword = {David H. Rosenthal},
  location = {London},
  date = {1984}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\subsection{Revision}

Where a work has been lightly revised, the following form is used:

%<n>\spec{Author, \emph{Title}, \lit{rev.} Reviser(s) (Location: Publisher, Year).}
%<y>\spec{Author (Year), \emph{Title}, \lit{rev.} Reviser(s) (Location: Publisher).}%

Where a work has been extensively revised, the following form is used:

%<n>\spec{Author, \lit{rev.} Reviser, \emph{Title}, (Location: Publisher, Year).}
%<y>\spec{Author (Year), \lit{rev.} Reviser, \emph{Title}, (Location: Publisher).}

\subsection{Later edition}

Where the author\slash editor is common to both, the following form is used:

%<n>\spec{Author, \emph{Title} (nth \lit{edn.}, Location: Publisher, Year).}
%<y>\spec{Author (Year), \emph{Title} (nth \lit{edn.}, Location: Publisher).}

\tip{This is the format used by the entry type \code{book}}

%</n|y>
%<*n>
\begin{bibexbox}<OGS \S15.2.3>[419-421]
{baker1990iel}
J. H. Baker, \emph{An Introduction to English Legal History} (3rd edn., 1990), 419--21.
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@book{baker1990iel,
  author = {J. H. Baker},
  title = {An Introduction to {English} Legal History},
  edition = {3},
  date = {1990}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

%</n>
%<*y>
\begin{bibexbox}<NHR \S17.3.2*>
{maitland2001mvr}
Maitland, G. (2001), \emph{Maitland's Vertebral Manipulation} (6th edn., Oxford: Butterworth--Heinemann).
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@book{maitland2001mvr,
  author = {G. Maitland},
  title = {Maitland's Vertebral Manipulation},
  edition = {6},
  publisher = {Butterworth--Heinemann},
  location = {Oxford},
  date = {2001}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%</y>
%<*n|y>
\begin{bibexbox}
%<n><OGS \S15.2.3>
%<y><OGS \S15.2.3\textdagger>
[419-421]{baker1990iel}
%<n>J. H. Baker, \emph{An Introduction to English Legal History} (3rd edn., 1990), 419--21.
%<y>Baker, J. H. (1990), \emph{An Introduction to English Legal History} (3rd edn.), 419--21.
\tcblower
\begin{Verbatim}
%</n|y>
@book{baker1990iel,
  author = {J. H. Baker},
  title = {An Introduction to {English} Legal History},
  edition = {3},
  date = {1990}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{beckford1823v}
%<n>William Beckford, \emph{Vathek} (4th edn., London, 1823) [online facsimile], \url{http://beckford.c18.net/wbvathek1823.html}, accessed 5 Nov. 2013.
%<y>Beckford, W. (1823), \emph{Vathek} (4th edn., London) [online facsimile], \url{http://beckford.c18.net/wbvathek1823.html}, accessed 5 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@book{beckford1823v,
  author = {William Beckford},
  title = {Vathek},
  edition = {4},
  location = {London},
  date = {1823},
  howpublished = {online facsimile},
  url = {http://beckford.c18.net/wbvathek1823.html},
  urldate = {2013-11-05}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

Where the editor has changed, the following form is used:

%<n>\spec{\emph{Title}, nth \lit{edn.}, \lit{ed.} Editor (Location: Publisher, Year).}
%<y>\spec{\emph{Title} (Year), nth \lit{edn.}, \lit{ed.} Editor (Location: Publisher).}

\tip{This format is used by entry type \code{reference}}

\begin{bibexbox}
%<n><OGS \S15.2.3>
%<y><OGS \S15.2.3\textdagger>
{knowles1999odq}
%<n>\emph{The Oxford Dictionary of Quotations}, 5th edn., ed. Elizabeth Knowles (Oxford, 1999).
%<y>\emph{The Oxford Dictionary of Quotations} (1999), 5th edn., ed. E. Knowles (Oxford).
\tcblower
\begin{Verbatim}
%</n|y>
@reference{knowles1999odq,
  title = {The {Oxford} Dictionary of Quotations},
  edition = {5},
  editor = {Elizabeth Knowles},
  publisher = {Oxford},
  date = {1999}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\subsection{First and later edition}

Where the publisher is common to both, the following form is used:

%<n>\spec{Author, \emph{Title} (Year; nth \lit{edn.}, Location: Publisher, Year).}
%<y>\spec{Author (Year), \emph{Title} (Year; nth \lit{edn.}, Location: Publisher).}

\tip{Use the \code{orig} fields for the earlier edition.}

%</n|y>
%<*n>
\begin{bibexbox}<OGS \S15.2.3>
{denniston1934gp}
J. D. Denniston, \emph{The Greek Particles} (1934; 2nd edn., Oxford, 1954).
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@book{denniston1934gp,
  author = {J. D. Denniston},
  title = {The Greek Particles},
  origdate = {1934},
  edition = {2},
  location = {Oxford},
  date = {1954}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}<OGS \S15.2.1*>
{gibbon1686dfs}
{[John Gibbon]}, \emph{Day-Fatality: Or Some Observations on Days Lucky and Unlucky}, (London, 1678; rev.~edn., 1686).
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@book{gibbon1686dfs,
  author = {John Gibbon},
  authortype = {inferred},
  title = {Day-Fatality},
  subtitle = {Or Some Observations on Days Lucky and Unlucky},
  edition = {revised},
  origlocation = {London},
  origdate = {1678},
  date = {1686}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

NB. In the \emph{Oxford Guide to Style}, there is no comma after ‘rev. edn.’ in the above reference; this may be an error.
%</n>
%<*y>
\begin{bibexbox}<OGS \S15.19.2>
{marx1867ccp}
Marx, K. (1867), \emph{Capital: A Critique of Political Economy}, i, trans. B. Fowkes (New York, 1977).
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@mvbook{marx1867ccp,
  author = {K. Marx},
  origdate = {1867},
  title = {Capital},
  subtitle = {A Critique of Political Economy},
  volume = {1},
  translator = {B. Fowkes},
  location = {New York},
  year = {1977}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%</y>
%<*n|y>

Where the publisher has changed, the following form is used:

%<n>\spec{Author, \emph{Title} (nth \lit{edn.}, Location: Publisher, Year) (\lit{first pub.} Year).}
%<y>\spec{Author (Year), \emph{Title} (nth \lit{edn.}, Location: Publisher) (\lit{first pub.} Year).}

\tip{To get this formatting, use \code{pubstate} for the original publication date}

\begin{bibexbox}
%<n><OGS \S15.2.3>
%<y><OGS \S15.2.3\textdagger>
{bettelheim1976uem}
%<n>Bruno Bettelheim, \emph{The Uses of Enchantment: The Meaning and Importance of Fairy Tales} (Harmondsworth: Penguin Books, 1988) (first pub. 1976).
%<y>Bettelheim, B. (1988), \emph{The Uses of Enchantment: The Meaning and Importance of Fairy Tales} (Harmondsworth: Penguin Books) (first pub. 1976).
\tcblower
\begin{Verbatim}
%</n|y>
@book{bettelheim1976uem,
  author = {Bruno Bettelheim},
  title = {The Uses of Enchantment},
  subtitle = {The Meaning and Importance of Fairy Tales},
  location = {Harmondsworth},
  publisher = {Penguin Books},
  date = {1988},
  pubstate = {first pub\adddotspace 1976}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\subsection{Reprint}

%<n>\spec{Author, \emph{Title} (Location: Publisher, Year; \lit{repr.} Location: Publisher, Year).}
%<y>\spec{Author (Year/Year), \emph{Title} (Location: Publisher; \lit{repr.} Location: Publisher).}

\tip{Use localization key \code{reprint} as the edition.}

\begin{bibexbox}
%<n><OGS \S15.2.4>
%<y><OGS \S15.2.4\textdagger>
{adam.tannery1897odd}
%<n>C. Adam and D. Tannery (eds.), \emph{Œuvres de Descartes} (Paris: Cerf, 1897--1913; repr. Paris: J. Vrin, CNRS, 1964--76).
%<y>Adam, C. and Tannery, D. (1897--1913) (eds.), \emph{Œuvres de Descartes} (Paris: Cerf; repr. Paris: J. Vrin, CNRS, 1964--76).
\tcblower
\begin{Verbatim}
%</n|y>
@collection{adam.tannery1897odd,
  editor = {C. Adam and D. Tannery},
  title = {Œuvres de Descartes},
  origlocation = {Paris},
  origpublisher = {Cerf},
  origdate = {1897/1913},
  edition = {reprint},
  location = {Paris},
  publisher = {J. Vrin, CNRS},
  date = {1964/1976}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

%<n>\spec{Author, \emph{Title} (Location: Publisher, Year; \lit{facs. edn.}, Location: Publisher, Year).}
%<y>\spec{Author (Year/Year), \emph{Title} (Location: Publisher; \lit{facs. edn.}, Location: Publisher).}

\tip{Use localization key \code{facsimile} as the edition.}

\begin{bibexbox}
%<n><OGS \S15.2.4>
%<y><OGS \S15.2.4\textdagger>
{allen1594kkk}
%<n>E. Allen, \emph{A Knack to Know a Knave} (London, 1594; facs. edn., Oxford: Malone Society Reprints, 1963).
%<y>Allen, E. (1594), \emph{A Knack to Know a Knave} (London; facs. edn., Oxford: Malone Society Reprints, 1963).
\tcblower
\begin{Verbatim}
%</n|y>
@book{allen1594kkk,
  author = {E. Allen},
  title = {A Knack to Know a Knave},
  origlocation = {London},
  origdate = {1594},
  edition = {facsimile},
  location = {Oxford},
  publisher = {Malone Society Reprints},
  date = {1963}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\subsection{Multiple publishers}

%<n>\spec{Author, \emph{Title} (Location: Publisher, Year; Location: Publisher, Year).}
%<y>\spec{Author (Year/Year), \emph{Title} (Location: Publisher; Location: Publisher).}

\begin{bibexbox}(hacked)
%<n><OGS \S15.2.5>
%<y><OGS \S15.2.5\textdagger>
{holfordstrevens1988ag}
%<n>L. A. Holford-Strevens, \emph{Aulus Gellius} (London: Duckworth, 1988; Chapel Hill: University of North Carolina Press, 1989).
%<y>Holford-Strevens, L. A. (1988/1989), \emph{Aulus Gellius} (London: Duckworth; Chapel Hill: University of North Carolina Press).
\tcblower
\begin{Verbatim}
%</n|y>
@book{holfordstrevens1988ag,
  author = {L. A. Holford-Strevens},
  title = {Aulus Gellius},
  origlocation = {London},
  origpublisher = {Duckworth},
  origdate = {1988},
  location = {Chapel Hill},
  publisher = {University of North Carolina Press},
  date = {1989}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\subsection{Work from a series}

%<n>\spec{Author, \emph{Title} (Series; Location: Publisher, Year).}
%<y>\spec{Author (Year), \emph{Title} (Series; Location: Publisher).}
%<n>\spec{Author, \emph{Title} (Series, Number; Location: Publisher, Year).}
%<y>\spec{Author (Year), \emph{Title} (Series, Number; Location: Publisher).}

%</n|y>
%<*n>
\begin{bibexbox}<OGS \S15.2.7>
{garlandia1972dmm}
Johannes de Garlandia, \emph{De mensurabili musica}, ed. Erich Reimer, 2 vols. (Beihefte zum Archiv für Musikwissenschaft, 10--11; Wiesbaden, 1972).
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@mvbook{garlandia1972dmm,
  author = {Johannes de Garlandia},
  title = {De mensurabili musica},
  editor = {Erich Reimer},
  volumes = {2},
  series = {Beihefte zum Archiv für Musikwissenschaft},
  number = {10--11},
  publisher = {Wiesbaden},
  date = {1972}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

%</n>
%<*y>
\begin{bibexbox}<OGS \S15.19.2>
{barnes1982ari}
Barnes, J. (1982), \emph{Aristotle} (Past Masters; Oxford).
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@book{barnes1982ari,
  author = {Jonathan Barnes},
  date = {1982},
  title = {Aristotle},
  series = {Past Masters},
  location = {Oxford}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%</y>
%<*n|y>

%<n>\spec{Author, \emph{Title} (nth \lit{ser.}, Year).}
%<y>\spec{Author (Year), \emph{Title} (nth \lit{ser.}).}

\section{Pre-publication book}

%<n>\spec{Author, \emph{Title} (Location: Publisher, \lit{forthcoming}).}
%<y>\spec{Author (\lit{forthcoming}), \emph{Title} (Location: Publisher).}

%</n|y>
%<*y>
\begin{bibexbox}<OGS \S15.19.2>
{smithFCgaf}
Smith, P. (forthcoming), \emph{Gender and Famine}, 2 vols. (London).
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@mvbook{smithFCgaf,
  author = {P. Smith},
  title = {Gender and Famine},
  volumes = {2},
  location = {London},
  pubstate = {forthcoming}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%</y>
%<*n|y>

\chapter{Works within books}\label{sec:inbook}
\chapterprecis{inbook, bookinbook, suppbook, incollection, suppcollection, inreference}

\section{Works in books}

The \code{inbook} entry type is intended for books that consist of several self-contained works by the same author, for citing one of these works.

\subsection{Works in collections of single author's works}

%<n>\spec{Author, \enquote{Title}, \lit{in id.}, \emph{BookTitle}, \lit{ed.} Editor(s) (Location: Publisher, Year), Pages.}
%<y>\spec{Author (Year), \enquote{Title}, \lit{in id.}, \emph{BookTitle}, \lit{ed.} Editor(s) (Location: Publisher), Pages.}

\tip{Express this in the database by setting \code{author} $=$ \code{bookauthor} $\neq$ \code{editor}. You will also need to specify the \code{gender} of the author, as the second instance of the name is replaced by \enquote{id.}\slash \enquote{ead.}\slash \enquote{eid.}\slash \enquote{eaed.}}

\begin{bibexbox}
%<n><OGS \S15.2.11>
%<y><OGS \S15.2.11\textdagger>
{kristeller1979thm}
%<n>Paul Oskar Kristeller, \enquote{The Aristotelian Tradition}, in id., \emph{Renaissance Thought and Its Sources}, ed. Michael Mooney (New York: Columbia University Press, 1979).
%<y>Kristeller, P. O. (1979), \enquote{The Aristotelian Tradition}, in id., \emph{Renaissance Thought and Its Sources}, ed. M. Mooney (New York: Columbia University Press).
\tcblower
\begin{Verbatim}
%</n|y>
@inbook{kristeller1979thm,
  author = {Paul Oskar Kristeller},
  gender = {sm},
  title = {The Aristotelian Tradition},
  bookauthor = {Paul Oskar Kristeller},
  booktitle = {Renaissance Thought and Its Sources},
  editor = {Michael Mooney},
  location = {New York},
  publisher = {Columbia University Press},
  date = {1979}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

%<n>\spec{Author, \enquote{Title}, \lit{in} \emph{BookTitle}, \lit{ed.} Editor(s) (Location: Publisher, Year), Pages.}
%<y>\spec{Author (Year), \enquote{Title}, \lit{in} \emph{BookTitle}, \lit{ed.} Editor(s) (Location: Publisher), Pages.}

\section{Works in collections}

The \code{incollection} entry type is intended for citing one of a collection of self-contained works by different authors.

\subsection{Work in a mixed collection}

%<n>\spec{Author, \enquote{Title}, \lit{in} Editors (\lit{eds.}), \emph{BookTitle} (Location: Publisher, Year), Pages.}
%<y>\spec{Author (Year), \enquote{Title}, \lit{in} Editors (\lit{eds.}), \emph{BookTitle} (Location: Publisher), Pages.}

\tip{Express this in the database by setting \code{author} $\neq$ \code{editor}, and omitting the \code{bookauthor}.}

%</n|y>
%<*n>
\begin{bibexbox}<OGS \S15.3>
{shearman1993vsf}
John Shearman, \enquote{The Vatican Stanze: Functions and Decoration}, in George Holmes (ed.), \emph{Art and Politics in Renaissance Italy: British Academy Lectures} (Oxford: Clarendon Press, 1993), 185--240.
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@incollection{shearman1993vsf,
  author = {John Shearman},
  title = {The Vatican Stanze},
  subtitle = {Functions and Decoration},
  editor = {George Holmes},
  booktitle = {Art and Politics in Renaissance Italy},
  booksubtitle = {British Academy Lectures},
  location = {Oxford},
  publisher = {Clarendon Press},
  date = {1993},
  pages = {185-240}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

%</n>
%<*y>
\begin{bibexbox}<NHR \S17.3.2>
{magarey1988ect}
Magarey, M. E. (1988), \enquote{Examination of the Cervical and Thoracic Spine}, in R. Grant (ed.), \emph{Physical Therapy of the Cervical and Thoracic Spine} (New York: Churchill Livingstone), 81–109.
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@incollection{magarey1988ect,
  author = {M. E. Magarey},
  year = {1988},
  title = {Examination of the Cervical and Thoracic Spine},
  editor = {R. Grant},
  booktitle = {Physical Therapy of the Cervical and Thoracic Spine},
  location = {New York},
  publisher = {Churchill Livingstone},
  pages = {81-109}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}<NHR \S17.3.2>
{jessop1997gcc}
Jessop, B. (1997), \enquote{The Governance of Complexity and Complexity of Governance}, in A. Amin and J. Hausner (eds.), \emph{Beyond Markets and Hierarchy}, (Aldershot: Edward Elgar).
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@incollection{jessop1997gcc,
  author = {Bob Jessop},
  date = {1997},
  title = {The Governance of Complexity and Complexity of Governance},
  editor = {Ash Amin and Jerzy Hausner},
  booktitle = {Beyond Markets and Hierarchy},
  location = {Aldershot},
  publisher = {Edward Elgar}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%</y>
%<*n|y>

\subsection{Work by the editor in mixed collection}

%<n>\spec{Author, \enquote{Title}, \lit{in id.} (\lit{ed.}), \emph{BookTitle} (Location: Publisher, Year), Pages.}
%<y>\spec{Author (Year), \enquote{Title}, \lit{in id.} (\lit{ed.}), \emph{BookTitle} (Location: Publisher), Pages.}

\tip{Express this in the database by setting \code{author} $=$ \code{editor} and omitting the \code{bookauthor}. You will also need to specify the \code{gender} of the editor, as the second instance of the name is replaced by \enquote{id.}\slash \enquote{ead.}\slash \enquote{eid.}\slash \enquote{eaed.}}

\begin{bibexbox}
%<n><OGS \S15.3>
%<y><OGS \S15.3\textdagger>
{todd1974dhp}
%<n>W. B. Todd, \enquote{David Hume: A Preliminary Bibliography}, in id. (ed.), \emph{Hume and the Enlightenment: Essays Presented to Ernest Campbell Mossner} (Edinburgh: Edinburgh University Press, 1974).
%<y>Todd, W. B. (1974), \enquote{David Hume: A Preliminary Bibliography}, in id. (ed.), \emph{Hume and the Enlightenment: Essays Presented to Ernest Campbell Mossner} (Edinburgh: Edinburgh University Press).
\tcblower
\begin{Verbatim}
%</n|y>
@incollection{todd1974dhp,
  author = {W. B. Todd},
  gender = {sm},
  title = {David Hume},
  subtitle = {A Preliminary Bibliography},
  editor = {W. B. Todd},
  booktitle = {Hume and the Enlightenment},
  booksubtitle = {Essays Presented to Ernest Campbell Mossner},
  location = {Edinburgh},
  publisher = {Edinburgh University Press},
  date = {1974}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


\section{Anthologies of independently published works}

Biblatex provides the \code{bookinbook} entry type for citing a part of an anthology that has previously been published as a book in its own right. Oxford style provides two different mechanisms for this, depending on circumstance.

\subsection{Both versions equally accessible}

\spec{Later Reference. From Earlier Reference.}

\tip{Put the key of the original work in \code{related}, and in \code{relatedtype} use the keyword \code{reprintfrom}.}
\tip{If using Bib\TeX, use \code{addendum} to give \enquote{From} and the reference to the original, but omit \code{author} and \code{title} from the entry for the original work.}

\begin{bibexbox}
%<n><OGS \S15.3>
%<y><OGS \S15.3\textdagger>
{owen1986pi}
%<n>G. E. L. Owen, \enquote{Philosophical Invective}, in id., \emph{Logic, Science and Dialectic}, ed. M. Nussbaum (Ithaca, NY: Cornell University Press, 1986), 347--64. From \emph{Oxford Studies in Ancient Philosophy}, 1 (1983), 1--25.
%<y>Owen, G. E. L. (1986) \enquote{Philosophical Invective}, in id., \emph{Logic, Science and Dialectic}, ed. M. Nussbaum (Ithaca, NY: Cornell University Press), 347--64. From \emph{Oxford Studies in Ancient Philosophy}, 1 (1983), 1--25.
\tcblower
\begin{Verbatim}
%</n|y>
@bookinbook{owen1986pi,
  author = {G. E. L. Owen},
  gender = {sm},
  title = {Philosophical Invective},
  booktitle = {Logic, Science and Dialectic},
  bookauthor = {G. E. L. Owen},
  editor = {M. Nussbaum},
  location = {Ithaca, NY},
  publisher = {Cornell University Press},
  date = {1986},
  pages = {347-364},
  related = {osap1983},
  relatedtype = {reprintfrom}
}
@periodical{osap1983,
  journaltitle = {Oxford Studies in Ancient Philosophy},
  volume = {1},
  date = {1983},
  pages = {1-25}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


\subsection{Later version more accessible}

%<n>\spec{Author, \emph{Title} (Location: Publisher, Year) (\lit{originally pub.} Year).}
%<y>\spec{Author (Year), \emph{Title} (Location: Publisher) (\lit{originally pub.} Year).}

\tip{Use \code{pubstate} to give the date of original publication.}

\begin{bibexbox}
%<n><OGS \S15.3>
%<y><OGS \S15.3\textdagger>
{frege1892osr}
%<n>G. Frege, \enquote{On Sense and Reference}, in id., \emph{Philosophical Writings}, trans. and ed. P. T. Geach and M. Black (Oxford: Blackwell, 1952) (originally pub. 1892).
%<y>Frege, G. (1952), \enquote{On Sense and Reference}, in id., \emph{Philosophical Writings}, trans. and ed. P. T. Geach and M. Black (Oxford: Blackwell) (originally pub. 1892).
\tcblower
\begin{Verbatim}
%</n|y>
@bookinbook{frege1892osr,
  author = {G. Frege},
  gender = {sm},
  title = {On Sense and Reference},
  bookauthor = {G. Frege},
  booktitle = {Philosophical Writings},
  translator = {P. T. Geach and M. Black},
  editor = {P. T. Geach and M. Black},
  location = {Oxford},
  publisher = {Blackwell},
  date = {1952},
  pubstate = {originally pub\adddotspace 1892}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


\chapter{Works presented at meetings}\label{sec:proceedings}
\chapterprecis{proceedings, mvproceedings, inproceedings, unpublished}

\section{Single volume proceedings}

The \code{proceedings} entry type is intended for a set of conference papers that have been collected together into a single volume.

%<n>\spec{\emph{Title}, \lit{ed.} Editor (Location: Publisher, Year).}
%<y>\spec{\emph{Title} (Year), \lit{ed.} Editor (Location: Publisher).}

\begin{bibexbox}
%<n><OGS \S15.2.12>
%<y><OGS \S15.2.12\textdagger>
{icp1975pic}
%<n>\emph{Proceedings of the XIV International Congress of Papyrologists: Oxford, 24--31 July 1974} (London, 1975).
%<y>\emph{Proceedings of the XIV International Congress of Papyrologists: Oxford, 24--31 July 1974} (1975), (London).
\tcblower
\begin{Verbatim}
%</n|y>
@proceedings{icp1975pic,
  title = {Proceedings of the {XIV} {International} {Congress} of {Papyrologists}},
  subtitle = {{Oxford}, 24--31 {July} 1974},
  location = {London},
  date = {1975}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><OGS \S15.2.13>
%<y><OGS \S15.2.13\textdagger>
[1.52-3]{iau1922tia}
%<n>International Astronomical Union, \emph{Transactions of the International Astronomical Union, Rome}, 12--20 May 1922 (London: Imperial College Bookstall, 1922), 1.52–3.
%<y>International Astronomical Union (1922), \emph{Transactions of the International Astronomical Union, Rome}, 12--20 May 1922 (London: Imperial College Bookstall), 1.52–3.
\tcblower
\begin{Verbatim}
%</n|y>
@proceedings{iau1922tia,
  organization = {{International Astronomical Union}},
  title = {Transactions of the {International} {Astronomical} {Union}, {Rome}},
  eventdate = {1922-05-12/1922-05-20},
  location = {London},
  publisher = {Imperial College Bookstall},
  date = {1922}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\textsc{Extension} – Sometimes the title of the proceedings does not relate to the conference; in which case the following form might be used:

%<n>\spec{\emph{Title}, EventTitle: Venue, ConfDate, \lit{ed.} Editor (Series, Number; Location: Publisher, Year).}
%<y>\spec{\emph{Title} (Year), EventTitle: Venue, ConfDate, \lit{ed.} Editor (Series, Number; Location: Publisher).}

\begin{bibexbox}
{ecdl2009}
(not in book)
\tcblower
\begin{Verbatim}
%</n|y>
@proceedings{ecdl2009,
  editor = {Maristella Agosti and José Borbinha and Sarantos Kapidakis and Christos Papatheodorou and Giannis Tsakonas},
  title = {Research and Advanced Technology for Digital Libraries},
  eventtitle = {13th European Conference, ECDL 2009},
  venue = {Corfu, Greece},
  eventdate = {2009-09-27/2009-10-02},
  series = {Lecture Notes in Computer Science},
  number = {5714},
  location = {Berlin},
  publisher = {Springer},
  date = {2009}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\section{Multi-volume proceedings}

\textsc{Extension} – Biblatex provides \code{mvproceedings} for multi-volume proceedings.
The examples here are a combination of Oxford style for proceedings and multi-volume books.

\subsection{All volumes}

%<n>\spec{\emph{Title}, EventTitle: Venue, ConfDate, \lit{ed.} Editor, n \lit{vols.} (Series, Number; Location: Publisher, Year).}
%<y>\spec{\emph{Title} (Year), EventTitle: Venue, ConfDate, \lit{ed.} Editor, n \lit{vols.} (Series, Number; Location: Publisher).}

\begin{bibexbox}
{iced2009}
(not in book)
\tcblower
\begin{Verbatim}
%</n|y>
@proceedings{iced2009,
  title = {Proceedings of the 17th International Conference on Engineering Design (ICED ’09)},
  volumes = {10},
  editor = {Margareta Norell Bergendahl and Martin Grimheden and Larry Leifer},
  venue = {Stanford, CA},
  eventdate = {2009-08-24/2009-08-27},
  location = {Glasgow},
  publisher = {Design Society},
  date = {2009},
  isbn = {978-1-904670-12-4}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\subsection{One volume}

%<n>\spec{\emph{Title}, VolNo: \emph{VolTitle}, EventTitle: Venue, ConfDate, \lit{ed.} Editor (Series, Number; Location: Publisher, Year).}
%<y>\spec{\emph{Title} (Year), VolNo: \emph{VolTitle}, EventTitle: Venue, ConfDate, \lit{ed.} Editor (Series, Number; Location: Publisher).}

\begin{bibexbox}
{iced2009dik}
(not in book)
\tcblower
\begin{Verbatim}
%</n|y>
@proceedings{iced2009dik,
  maintitle = {Proceedings of the 17th International Conference on Engineering Design (ICED ’09)},
  title = {Design Information and Knowledge},
  volume = {8},
  editor = {Margareta Norell Bergendahl and Martin Grimheden and Larry Leifer},
  venue = {Stanford, CA},
  eventdate = {2009-08-24/2009-08-27},
  location = {Glasgow},
  publisher = {Design Society},
  date = {2009},
  isbn = {978-1-904670-12-4}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\section{Published conference paper}

The \code{inproceedings} entry type is intended for a conference paper published as part of a proceedings volume. For papers that have not been collected into a proceedings volume, or presentation slide sets, use the \code{unpublished} entry type instead (see below).

%<n>\spec{Author, \enquote{Title}, \lit{in} \emph{BookTitle}, EventTitle: Venue, ConfDate, \lit{ed.} Editor (Series, Number; Location: Publisher, Year).}
%<y>\spec{Author (Year), \enquote{Title}, \lit{in} \emph{BookTitle}, EventTitle: Venue, ConfDate, \lit{ed.} Editor (Series, Number; Location: Publisher).}

\begin{bibexbox}
{tonkin.strelnikov2009iem}
(not in book)
\tcblower
\begin{Verbatim}
%</n|y>
@inproceedings{tonkin.strelnikov2009iem,
  author = {Emma Tonkin and Alexey Strelnikov},
  title = {Information Environment Metadata Schema Registry},
  editor = {Maristella Agosti and José Borbinha and Sarantos Kapidakis and Christos Papatheodorou and Giannis Tsakonas},
  booktitle = {Research and Advanced Technology for Digital Libraries},
  eventtitle = {13th European Conference, ECDL 2009},
  venue = {Corfu, Greece},
  eventdate = {2009-09-27/2009-10-02},
  series = {Lecture Notes in Computer Science},
  number = {5714},
  location = {Berlin},
  publisher = {Springer},
  date = {2009},
  pages = {487-488},
  isbn = {978-3-642-04345-1},
  issn = {0302-9743}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

%<n>\spec{Author, \enquote{Title}, \lit{in} \emph{BookTitle}, EventTitle: Venue, ConfDate, \lit{ed.} Editor, n \lit{vols.} (Series, Number; Location: Publisher, Year), VolNo. Pages.}
%<y>\spec{Author (Year), \enquote{Title}, \lit{in} \emph{BookTitle}, EventTitle: Venue, ConfDate, \lit{ed.} Editor, n \lit{vols.} (Series, Number; Location: Publisher), VolNo. Pages.}

\begin{bibexbox}
{ding.etal2009sfc}
(not in book)
\tcblower
\begin{Verbatim}
%</n|y>
@inproceedings{ding.etal2009sfc,
  author = {Lian Ding and Alex Ball and Manjula Patel and Jason Matthews and Glen Mullineux},
  title = {Strategies for the Collaborative Use of CAD Product Models},
  maintitle = {Proceedings of the 17th International Conference on Engineering Design (ICED ’09)},
  booktitle = {Design Information and Knowledge},
  volume = {8},
  editor = {Margareta Norell Bergendahl and Martin Grimheden and Larry Leifer},
  venue = {Stanford, CA},
  eventdate = {2009-08-24/2009-08-27},
  location = {Glasgow},
  publisher = {Design Society},
  date = {2009},
  pages = {123-134},
  isbn = {978-1-904670-12-4},
  url = {http://opus.bath.ac.uk/14285}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\section{Published orations, addresses, lectures, and speeches}

%<n>\spec{Author, \emph{Title}, Type, Venue, Date (Location: Publisher, Year).}
%<y>\spec{Author (Year), \emph{Title}, Type, Venue, Date (Location: Publisher).}

\begin{bibexbox}
%<n><OGS \S15.6>
%<y><OGS \S15.6\textdagger>
{gombrich1957as}
%<n>E. H. Gombrich, \emph{Art and Scholarship}, Inaugural Lecture, University College London, 14 Feb. 1957 (London: H. K. Lewis, 1957).
%<y>Gombrich, E. H. (1957), \emph{Art and Scholarship}, Inaugural Lecture, University College London, 14 Feb. 1957 (London: H. K. Lewis).
\tcblower
\begin{Verbatim}
%</n|y>
@book{gombrich1957as,
  author = {E. H. Gombrich},
  title = {Art and Scholarship},
  note = {Inaugural Lecture, University College London, 14 Feb. 1957},
  location = {London},
  publisher = {H. K. Lewis},
  date = {1957}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


\section{Unpublished conference paper}

%<n>\spec{Author, \enquote{Title}, \lit{paper given at the} ConfTitle, Venue, EventDate.}
%<y>\spec{Author (Year), \enquote{Title}, \lit{paper given at the} ConfTitle, Venue, EventDate.}

%</n|y>
%<*n>
\begin{bibexbox}<OGS \S15.6>
{holfordstrevens1999hlm}
Leofranc Holford-Strevens, \enquote{Humanism and the Language of Music Theory Treatises}, paper given at the 65th Annual Meeting of the American Musicological Society, Kansas City, MO, 4--7 Nov. 1999.
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@unpublished{holfordstrevens1999hlm,
  author = {Leofranc Holford-Strevens},
  title = {Humanism and the Language of Music Theory Treatises},
  howpublished = {paper given at the 65th Annual Meeting of the American Musicological Society},
  location = {Kansas City, MO},
  date = {1999-11-04/1999-11-07}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

%</n>
%<*y>
\begin{bibexbox}<OGS \S15.19.2>
{mason.etal1984nns}
Mason, J. B., Habicht, J. P., and Tabatabai, H. (1984), \enquote{Notes on Nutritional Surveillance}, paper delivered to the WHO conference.
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@unpublished{mason.etal1984nns,
  author = {J. B. Mason, and J. P. Habicht and H. Tabatabai},
  year = {1984},
  title = {Notes on Nutritional Surveillance},
  howpublished = {paper delivered to the WHO conference}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%</y>
%<*n|y>

\section{Unpublished orations, addresses, lectures, and speeches}

%<n>\spec{Author, \enquote{Title}, Description.}
%<y>\spec{Author (Year), \enquote{Title}, Description.}

%</n|y>
%<*y>
\begin{bibexbox}<OGS \S15.19.2>
{pritchard.pritchard1990ard}
Pritchard, E., and Pritchard, J. (1990), \enquote{A Reply to Drèze}, unpub.\ paper.
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@unpublished{pritchard.pritchard1990ard,
  author = {E. Pritchard and J. Pritchard},
  year = {1990},
  title = {A Reply to Drèze},
  howpublished = {unpub.\ paper}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%</y>
%<*n|y>


\chapter{Grey literature}\label{sec:report}
\chapterprecis{booklet, manual, patent, report, thesis, standard}

\section{One-off reports}

%<n>\spec{Author, \emph{Title} (Location: Institution, Year).}
%<y>\spec{Author (Year), \emph{Title} (Location: Institution).}

\begin{bibexbox}
%<n><OGS \S15.2.13>
%<y><OGS \S15.2.13\textdagger>
{botswana1980hdr}
%<n>Government of Botswana, \emph{A Human Drought Relief Programme for Botswana} (Gabarone: Ministry of Local Government and Lands, 1980).
%<y>Government of Botswana (1980), \emph{A Human Drought Relief Programme for Botswana} (Gabarone: Ministry of Local Government and Lands).
\tcblower
\begin{Verbatim}
%</n|y>
@report{botswana1980hdr,
  author = {{Government of Botswana}},
  title = {A Human Drought Relief Programme for Botswana},
  location = {Gabarone},
  institution = {Ministry of Local Government and Lands},
  date = {1980}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\tip{If the report does not specify an author, give the publishing institution in the \texttt{author} field.
  Some examples in the \emph{Oxford Guide to Style} repeat the institution in the publisher slot
  (i.e.\@ the \texttt{institution} field) and some do not.}

%</n|y>
%<*n>
\begin{bibexbox}<OGS \S15.2.13>
{pac1988upt}
Penal Affairs Consortium, \emph{An Unsuitable Place for Treatment: Diverting Mentally Disordered Offenders from Custody} (London, 1988).
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@report{pac1988upt,
  author = {{Penal Affairs Consortium}},
  title = {An Unsuitable Place for Treatment},
  subtitle = {Diverting Mentally Disordered Offenders from Custody},
  location = {London},
  date = {1988}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}<NHR \S18.8.5>
{unesco2012unw}
UNESCO, \emph{The United Nations World Water Development Report 4}, vol. 1: \emph{Managing Water under Uncertainty and Risk} (Paris: UNESCO, 2012), \url{http://unesdoc.unesco.org/images/0021/002156/215644e.pdf}, accessed 9 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n>
%<*n|bib>
@report{unesco2012unw,
  author = {UNESCO},
  maintitle = {The United Nations World Water Development Report 4},
  volume = {1},
  title = {Managing Water under Uncertainty and Risk},
  location = {Paris},
  institution = {UNESCO},
  date = {2012},
  url = {http://unesdoc.unesco.org/images/0021/002156/215644e.pdf},
  urldate = {2013-11-09}}
%</n|bib>
%<*n>
\end{Verbatim}
\end{bibexbox}

%</n>
%<*y>
\begin{bibexbox}<OGS \S15.9.1>
{who1986nde}
WHO (World Health Organization) (1986), \emph{Nutrition and Development in East Africa} (Geneva: WHO)
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@report{who1986nde,
  author = {{World Health Organization}},
  shortauthor = {WHO},
  title = {Nutrition and Development in {East Africa}},
  date = {1986},
  location = {Geneva},
  institution = {WHO}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}<NHR \S17.3.2>
{cnnr2008tut}
CNNR/GMH (Comisión Nacional de Reparación y Reconciliación y Grupo de Memoria Historica) (2008), \emph{Trujilla: Una Tragedia que no Cesa [Trujilla: A Tragedy Without End]}, (Bogotá, Columbia: CNRR).
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@report{cnnr2008tut,
  shortauthor = {CNNR/GMH},
  author = {{Comisión Nacional de Reparación y Reconciliación y Grupo de Memoria Historica}},
  date = {2008},
  title = {Trujilla},
  subtitle = {Una Tragedia que no Cesa},
  titleaddon = {\printtext[title]{{Trujilla:} {A} Tragedy Without End}},
  location = {Bogotá, Columbia},
  institution = {CNRR}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%</y>
%<*n|y>

\section{Reports with a type or series}

%<n>\spec{Author, \emph{Title}, Series, Number (Location: Institution, Year).}
%<y>\spec{Author (Year), \emph{Title}, Series, Number (Location: Institution).}

%</n|y>
%<*y>
\begin{bibexbox}<OGS \S15.19.2>
{opcs1979amt}
Office of Population Censuses and Surveys (1979a), \emph{Area Mortality Tables: The Registrar-General's Decennial Supplement for England and Wales 1969–1973}, Series DS, No.~3 (London)
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@report{opcs1979amt,
  author = {{Office of Population Censuses and Surveys}},
  date = {1979},
  title = {Area Mortality Tables},
  subtitle = {The Registrar-General's Decennial Supplement for England and Wales 1969–1973},
  series = {Series DS},
  number = {3},
  location = {London}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%<n>\spec{Author, \emph{Title}, Type Number (Location: Institution, Year).}
%<y>\spec{Author (Year), \emph{Title}, Type Number (Location: Institution).}

\begin{bibexbox}<OGS \S15.19.2>
{opcs1979pnc}
Office of Population Censuses and Surveys (1979b), \emph{Projections of the New Commonwealth and Pakistani Population}, OPCS Monitor PP2 79/1 (London)
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@report{opcs1979pnc,
  author = {{Office of Population Censuses and Surveys}},
  date = {1979},
  title = {Projections of the {New Commonwealth} and {Pakistani} Population},
  type = {OPCS Monitor},
  number = {PP2 79/1},
  location = {London}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}<NHR \S17.3.2>
{rosenblatt.etal1988cap}
Rosenblatt, J., et al. (1988), \emph{The Common Agricultural Policy of the European Community}, International Monetary Fund, occasional paper 62, Nov.
\tcblower
\begin{Verbatim}
%</y>
%<*y|bib>
@report{rosenblatt.etal1988cap,
  author = {Julius Rosenblatt and others},
  title = {The {Common Agricultural Policy} of the {European Community}},
  date = {1988-11},
  institution = {International Monetary Fund},
  type = {occasional paper},
  number = {62}}
%</y|bib>
%<*y>
\end{Verbatim}
\end{bibexbox}

%</y>
%<*n|y>%


\section{Theses}

%<n>\spec{Author, \enquote{Title}, Type (Institution, Year).}
%<y>\spec{Author (Year), \enquote{Title}, Type (Institution).}

\begin{bibexbox}
%<n><OGS \S15.5.1>
%<y><OGS \S15.5.1\textdagger>
{blackburn1970tlp}
%<n>Bonnie J. Blackburn, \enquote{The Lupus Problem}, Ph.D. diss. (University of Chicago, 1970).
%<y>Blackburn, B. J. (1970), \enquote{The Lupus Problem}, Ph.D. diss. (University of Chicago).
\tcblower
\begin{Verbatim}
%</n|y>
@thesis{blackburn1970tlp,
  author = {Bonnie J. Blackburn},
  title = {The Lupus Problem},
  type = {Ph.D. diss.},
  institution = {University of Chicago},
  date = {1970}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


The following form is also supported: to use it, pass the \texttt{altthesis} option.

%<n>\spec{Author, \enquote{Title}, (Type, Institution, Year).}
%<y>\spec{Author (Year), \enquote{Title}, (Type, Institution).}


\chapter{Audiovisual materials}\label{sec:audiovideo}
\chapterprecis{audio, image, movie, music, video}

\section{Audio recordings}

\textsf{Oxref} provides the additional editor types \code{performer}, \code{director} and \code{reader}.

%<n>\spec{Composer, \emph{Title}, Artist (Series, Number, Year).}
%<y>\spec{Composer (Year), \emph{Title}, Artist (Series, Number).}

\begin{bibexbox}
%<n><OGS \S15.14.1>
%<y><OGS \S15.14.1\textdagger>
{couperin1970pdc}
%<n>Francois Couperin, \emph{Pièces de clavecin: Huit préludes de L'Art de toucher le clavecin. Livre I. Troisième et quatrième ordres}, Huguette Dreyfus (Valois, MB 797, 1970).
%<y>Couperin, F. (1970), \emph{Pièces de clavecin: Huit préludes de L'Art de toucher le clavecin. Livre I. Troisième et quatrième ordres}, H. Dreyfus (Valois, MB 797).
\tcblower
\begin{Verbatim}
%</n|y>
@music{couperin1970pdc,
  author = {Francois Couperin},
  title = {Pièces de clavecin},
  subtitle = {Huit préludes de L'Art de toucher le clavecin. Livre I. Troisième et quatrième ordres},
  editor = {Huguette Dreyfus},
  editortype = {performer},
  series = {Valois},
  number = {MB 797},
  date = {1970}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

%<n>\spec{Composer, \emph{Title}, Ensemble, \lit{dir.} Director; Credit (Publisher Type Number, Year).}
%<y>\spec{Composer (Year), \emph{Title}, Ensemble, \lit{dir.} Director; Credit (Publisher Type Number).}

\begin{bibexbox}
%<n><OGS \S15.14.1>
%<y><OGS \S15.14.1\textdagger>
{hillier1989p}
%<n>Paul Hillier, \emph{Proensa} (ECM Records compact disc ECM 1368, 1989).
%<y>Hillier, P. (1989), \emph{Proensa} (ECM Records compact disc ECM 1368).
\tcblower
\begin{Verbatim}
%</n|y>
@music{hillier1989p,
  author = {Paul Hillier},
  title = {Proensa},
  publisher = {ECM Records},
  type = {compact disc},
  number = {ECM 1368},
  date = {1989}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><OGS \S15.14.1>
%<y><OGS \S15.14.1\textdagger>
{pageNDmn}
%<n>\emph{The Mirror of Narcissus: Songs by Guillaume de Machaut}, Gothic Voices, dir. Christopher Page (Hyperion compact disc CDA 66087).
%<y>\emph{The Mirror of Narcissus: Songs by Guillaume de Machaut}, Gothic Voices, dir. C. Page (Hyperion compact disc CDA 66087).
\tcblower
\begin{Verbatim}
%</n|y>
@music{pageNDmn,
  title = {The Mirror of Narcissus},
  subtitle = {Songs by Guillaume do Machaut},
  editor = {{Gothic Voices}},
  editortype = {performer},
  editora = {Christopher Page},
  editoratype = {director},
  publisher = {Hyperion},
  type = {compact disc},
  number = {CDA 66087}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


%<n>\spec{Composer, \emph{Title}, Artist (Publisher Series, Number, Year) (Medium).}
%<y>\spec{Composer (Year), \emph{Title}, Artist (Publisher Series, Number) (Medium).}

\begin{bibexbox}
%<n><NHR \S18.7.2>
%<y><NHR \S18.7.2\textdagger>
{hopkinsNDcar}
%<n>Lightnin' Hopkins, \emph{The Complete Aladdin Recordings} (EMI Blues Series, CDP-7-96843-2) [2-vol.\@ CD set].
%<y>Lightnin' Hopkins, \emph{The Complete Aladdin Recordings} (EMI Blues Series, CDP-7-96843-2) [2-vol.\@ CD set].
\tcblower
\begin{Verbatim}
%</n|y>
@music{hopkinsNDcar,
  author = {{Lightnin’ Hopkins}},
  title = {The Complete Aladdin Recordings},
  publisher = {EMI},
  series = {Blues Series},
  number = {CDP-7-96843-2},
  pubstate = {2-vol.\@ CD set}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

%<n>\spec{Author, \emph{Title}, \lit{read by} Reader (Medium, Number, Year).}
%<y>\spec{Author (Year), \emph{Title}, \lit{read by} Reader (Medium, Number).}

\begin{bibexbox}
%<n><OGS \S15.14.1>
%<y><OGS \S15.14.1\textdagger>
{lewis1981lww}
%<n>C. S. Lewis, \emph{The Lion, the Witch, and the Wardrobe}, read by Sir Michael Hordern (2 audio cassettes, TO1611, 1981).
%<y>Lewis, C. S. (1981), \emph{The Lion, the Witch, and the Wardrobe}, read by Sir M. Hordern (2 audio cassettes, TO1611).
\tcblower
\begin{Verbatim}
%</n|y>
@audio{lewis1981lww,
  author = {C. S. Lewis},
  title = {The Lion, the Witch, and the Wardrobe},
  editor = {Sir Michael Hordern},
  editortype = {reader},
  howpublished = {2 audio cassettes},
  number = {TO1611},
  date = {1981}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

%<n>\spec{Speaker, \emph{Title} (Publisher, Number, Year).}
%<y>\spec{Speaker (Year), \emph{Title} (Publisher, Number).}

\section{Video recordings}

%<n>\spec{\emph{Title} (Publisher, Number, Year).}
%<y>\spec{\emph{Title} (Year) (Publisher, Number).}

\emph{The Ashes: Victory in Australia} (BBCV 4040, 1987).

%<n>\spec{\enquote{EpisodeTitle}, \emph{SeriesTitle} \lit{series} (Publisher, Number, Year).}
%<y>\spec{\enquote{EpisodeTitle} (Year), \emph{SeriesTitle} \lit{series} (Publisher, Number).}

\enquote{Percy and Harold and Other Stories}, \emph{Thomas the Tank Engine and Friends} series (Britt Allcroft 5-014861-100224, 1986).

%<n>\spec{Director (\lit{dir.}), \emph{Title} (Publisher, Number, Year).}
%<y>\spec{Director (Year) (\lit{dir.}), \emph{Title} (Publisher, Number).}

Charles Chaplin (dir.), \emph{Modern Times} (United Artists, 1936).

%<n>\spec{\emph{Title}, \lit{dir.} Director (Publisher, Number, Year).}
%<y>\spec{\emph{Title} (Year), \lit{dir.} Director (Publisher, Number).}

\emph{This is Spinal Tap: A Rockumentary by Marti Di Bergi}, dir.\ Rob Reiner (Embassy Pictures, 1983).

%<n>\spec{\emph{Title} (Publisher, Number, Year), Credit.}
%<y>\spec{\emph{Title} (Year) (Publisher, Number), Credit.}

\emph{Leningrad Cowboys Go America} (Villealfa Filmproductions, 1989), dir.\ and screenplay by Aki Kaurismäki, story by Sakke Järvenpää, Aki Kaurismäki, Mato Valtonen.

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{bbc2013iim}
%<n>BBC News, \enquote{Inside India's Mars Mission HQ} [video] (5 Nov. 2013), \url{http://www.bbc.co.uk/news/world-24826253}, accessed 5 Nov. 2013.
%<y>BBC News (2013), \enquote{Inside India's Mars Mission HQ} [video] (5 Nov.), \url{http://www.bbc.co.uk/news/world-24826253}, accessed 5 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@video{bbc2013iim,
  author = {{BBC News}},
  title = {Inside India's Mars Mission HQ},
  entrysubtype = {video},
  date = {2013-11-05},
  url = {http://www.bbc.co.uk/news/world-24826253},
  urldate = {2013-11-05}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{rubinstein1956rpc}
%<n>Arthur Rubinstein, \enquote{Rachmaninoff Piano Concerto No. 2, Op. 18, I Moderato, Allegro (Fritz Reiner)} [video], YouTube (recorded 9 Jan. 1956, uploaded 8 Nov. 2011), \url{http://www.youtube.com/watch?v=0Vv0Sy9FJrc&list=PLDB11C4F39E09047F}, accessed 9 Nov. 2013.
%<y>Rubinstein, A. (1956), \enquote{Rachmaninoff Piano Concerto No. 2, Op. 18, I Moderato, Allegro (Fritz Reiner)} [video], YouTube (recorded 9 Jan., uploaded 8 Nov. 2011), \url{http://www.youtube.com/watch?v=0Vv0Sy9FJrc&list=PLDB11C4F39E09047F}, accessed 9 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@video{rubinstein1956rpc,
  author = {Arthur Rubinstein},
  title = {Rachmaninoff Piano Concerto No. 2, Op. 18, I Moderato, Allegro (Fritz Reiner)},
  entrysubtype = {video},
  organization = {YouTube},
  date = {1956-01-09},
  options = {datetype={recorded}},
  note = {uploaded 8 Nov. 2011},
  url = {http://www.youtube.com/watch?v=0Vv0Sy9FJrc&list=PLDB11C4F39E09047F},
  urldate = {2013-11-09}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\section{Broadcasts}

%<n>\spec{\emph{Title}, Channel, Date.}
%<y>\spec{\emph{Title} (Date), Channel.}

\emph{Sunday Grandstand}, BBC2, 17 Sept. 1995.

%<n>\spec{\enquote{EpisodeTitle}, \emph{SeriesTitle}, \lit{Episode} EpisodeNumber, Channel, Date.}
%<y>\spec{\enquote{EpisodeTitle} (Date), \emph{SeriesTitle}, \lit{Episode} EpisodeNumber, Channel.}

John Berger, Episode 1, \emph{Ways of Seeing}, BBC (1972), \url{https://www.youtube.com/watch?v=0pDE4VX_9Kk}, accessed 9 Nov. 2013.

\section{Podcasts, video podcasts and webcasts}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{perry2013ifm}
%<n>Grayson Perry, \enquote{I Found Myself in the Art World} [podcast], Reith Lecture (5 Nov. 2013), BBC Radio 4, \url{http://downloads.bbc.co.uk/podcasts/radio4/reith/reith_20131105-0940b.mp3}, accessed 5 Nov. 2013.
%<y>Perry, G. (2013), \enquote{I Found Myself in the Art World} [podcast], Reith Lecture (5 Nov.), BBC Radio 4, \url{http://downloads.bbc.co.uk/podcasts/radio4/reith/reith_20131105-0940b.mp3}, accessed 5 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@audio{perry2013ifm,
  author = {Grayson Perry},
  title = {I Found Myself in the Art World},
  entrysubtype = {podcast},
  note = {Reith Lecture},
  date = {2013-11-05},
  publisher = {BBC Radio 4},
  url = {http://downloads.bbc.co.uk/podcasts/radio4/reith/reith_20131105-0940b.mp3},
  urldate = {2013-11-05}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{nicholson2011qsm}
%<n>Christie Nicholson, \enquote{A Quirk of Speech May Become a New Vocal Style} [video], \emph{Scientific American}, 17 Dec. 2011, \url{http://www.scientificamerican.com/podcast/episode.cfm?id=a-quirk-of-speech-may-become-a-new-11-12-17}, accessed 4 Nov. 2013.
%<y>Nicholson, C. (2011), \enquote{A Quirk of Speech May Become a New Vocal Style} [video], \emph{Scientific American}, 17 Dec., \url{http://www.scientificamerican.com/podcast/episode.cfm?id=a-quirk-of-speech-may-become-a-new-11-12-17}, accessed 4 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@video{nicholson2011qsm,
  author = {Christie Nicholson},
  title = {A Quirk of Speech May Become a New Vocal Style},
  entrysubtype = {video},
  journaltitle = {Scientific American},
  date = {2011-12-17},
  url = {http://www.scientificamerican.com/podcast/episode.cfm?id=a-quirk-of-speech-may-become-a-new-11-12-17},
  urldate = {2013-11-04}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{yousafzai2013mwa}
%<n>Malala Yousafzai, \enquote{Making a Wish for Action on Global Education: Malala Yousafzai Addresses Youth Assembly at UN on her 16th Birthday, 12 July 2013} [webcast], UN Web TV, 12 Jul 2013, \url{http://webtv.un.org/search/malala-yousafzai-un-youth-assembly/2542094251001?term=malala}, accessed 15 Feb. 2015.
%<y>Yousafzai, M. (2013), \enquote{Making a Wish for Action on Global Education: Malala Yousafzai Addresses Youth Assembly at UN on her 16th Birthday, 12 July 2013} [webcast], UN Web TV, 12 Jul, \url{http://webtv.un.org/search/malala-yousafzai-un-youth-assembly/2542094251001?term=malala}, accessed 15 Feb. 2015.
\tcblower
\begin{Verbatim}
%</n|y>
@video{yousafzai2013mwa,
  author = {Malala Yousafzai},
  title = {Making a Wish for Action on Global Education},
  subtitle = {Malala Yousafzai Addresses Youth Assembly at UN on her 16th Birthday, 12 July 2013},
  entrysubtype = {webcast},
  organization = {UN Web TV},
  date = {2013-07-12},
  url = {http://webtv.un.org/search/malala-yousafzai-un-youth-assembly/2542094251001?term=malala},
  urldate = {2015-02-15}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


\section{Images}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{clarkeNDeci}
%<n>M. Clarke, \enquote{Exports of Coal to the IFS} [poster], Manchester Art Gallery, \url{http://www.machestergalleries.org/the-collections/search-the-collection/display.php?EMUSESSID=70bd7f1a388d79a82f52ea9aae713ef2&irn=4128}, accessed 5 Nov. 2013.
%<y>Clarke, M., \enquote{Exports of Coal to the IFS} [poster], Manchester Art Gallery, \url{http://www.machestergalleries.org/the-collections/search-the-collection/display.php?EMUSESSID=70bd7f1a388d79a82f52ea9aae713ef2&irn=4128}, accessed 5 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@image{clarkeNDeci,
  author = {M. Clarke},
  title = {Exports of Coal to the IFS},
  entrysubtype = {poster},
  organization = {Manchester Art Gallery},
  url = {http://www.machestergalleries.org/the-collections/search-the-collection/display.php?EMUSESSID=70bd7f1a388d79a82f52ea9aae713ef2&irn=4128},
  urldate = {2013-11-05}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{ibwNDcgs}
%<n>\enquote{Christ the Good Shepherd}, stained glass window, Church of St Erfyl, Llanerfyl, Powys, Imaging the Bible in Wales Database, \url{http://imagingthebible.llgc.org.uk/object/1884}, accessed 10 Nov. 2013.
%<y>\enquote{Christ the Good Shepherd}, stained glass window, Church of St Erfyl, Llanerfyl, Powys, Imaging the Bible in Wales Database, \url{http://imagingthebible.llgc.org.uk/object/1884}, accessed 10 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@image{ibwNDcgs,
  title = {Christ the Good Shepherd},
  note = {stained glass window, Church of St Erfyl, Llanerfyl, Powys},
  organization = {Imaging the Bible in Wales Database},
  url = {http://imagingthebible.llgc.org.uk/object/1884},
  urldate = {2013-11-10}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


\chapter{Digital media}\label{sec:electronic}
\chapterprecis{online, software, dataset}

\section{Website articles}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{bbc2013cgh}
%<n>BBC News, \enquote{Colchester General Hospital: Police Probe Cancer Treatment} (5 Nov. 2013), \url{http://www.bbc.co.uk/news/uk-england-essex-24819973}, accessed 5 Nov. 2013.
%<y>BBC News (2013), \enquote{Colchester General Hospital: Police Probe Cancer Treatment} (5 Nov.), \url{http://www.bbc.co.uk/news/uk-england-essex-24819973}, accessed 5 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@online{bbc2013cgh,
  author = {{BBC News}},
  title = {Colchester General Hospital},
  subtitle = {Police Probe Cancer Treatment},
  date = {2013-11-05},
  url = {http://www.bbc.co.uk/news/uk-england-essex-24819973},
  urldate = {2013-11-05}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{hooper2013lfs}
%<n>Richard Hooper, \enquote{Lebanon's Forgotten Space Programme}, BBC News Magazine (14 Nov. 2013), \url{http://www.bbc.co.uk/news/magazine-24735423}, accessed 14 Nov. 2013.
%<y>Hooper, R. (2013), \enquote{Lebanon's Forgotten Space Programme}, BBC News Magazine, 14 Nov. \url{http://www.bbc.co.uk/news/magazine-24735423}, accessed 14 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@online{hooper2013lfs,
  author = {Richard Hooper},
  title = {Lebanon's Forgotten Space Programme},
  organization = {BBC News Magazine},
  date = {2013-11-14},
  url = {http://www.bbc.co.uk/news/magazine-24735423},
  urldate = {2013-11-14}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{mcewen2013tte}
%<n>Stephen McEwen, \enquote{Tan Twan Eng Interview: \enquote{I Have No Alternative but to Write in English}}, \emph{The Spectator} (20 May 2013), \url{http://blogs.spectator.co.uk/books/2013/05/tan-twang-eng-interview-i-have-no-alternative-but-to-write-in-english/}, accessed 9 Nov. 2013.
%<y>McEwen, S. (2013), \enquote{Tan Twan Eng Interview: \enquote{I Have No Alternative but to Write in English}}, \emph{The Spectator} (20 May), \url{http://blogs.spectator.co.uk/books/2013/05/tan-twang-eng-interview-i-have-no-alternative-but-to-write-in-english/}, accessed 9 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@article{mcewen2013tte,
  author = {Stephen McEwen},
  title = {Tan Twan Eng Interview: \enquote{I Have No Alternative but to Write in English}},
  journaltitle = {The Spectator},
  date = {2013-05-20},
  url = {http://blogs.spectator.co.uk/books/2013/05/tan-twang-eng-interview-i-have-no-alternative-but-to-write-in-english/},
  urldate = {2013-11-09}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{allaby2013fll}
%<n>Michael Allaby, \enquote{Feathers and Lava Lamps}, Oxford Reference (2013), \url{http://www.oxfordreference.com/page/featherslavalamps}, accessed 9 Nov. 2013.
%<y>Allaby, M. (2013), \enquote{Feathers and Lava Lamps}, Oxford Reference, \url{http://www.oxfordreference.com/page/featherslavalamps}, accessed 9 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@online{allaby2013fll,
  author = {Michael Allaby},
  title = {Feathers and Lava Lamps},
  organization = {Oxford Reference},
  date = {2013},
  url = {http://www.oxfordreference.com/page/featherslavalamps},
  urldate = {2013-11-09}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{tan2013wdt}
%<n>Siu-Lan Tan, \enquote{Why does this Baby Cry when her Mother Sings?} [including video], OUPblog (5 Nov. 2013), \url{http://blog.oup.com/2013/11/why-does-this-baby-cry-when-her-mother-sings-viral-video/}, accessed 9 Nov. 2013.
%<y>Tan, S.-L. (2013), \enquote{Why does this Baby Cry when her Mother Sings?} [including video], OUPblog (5 Nov.), \url{http://blog.oup.com/2013/11/why-does-this-baby-cry-when-her-mother-sings-viral-video/}, accessed 9 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@online{tan2013wdt,
  author = {Siu-Lan Tan},
  title = {Why does this Baby Cry when her Mother Sings?},
  entrysubtype = {including video},
  organization = {OUPblog},
  date = {2013-11-05},
  url = {http://blog.oup.com/2013/11/why-does-this-baby-cry-when-her-mother-sings-viral-video/},
  urldate = {2013-11-09}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


\section{Online reference article}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{eb2013gp}
\enquote{Gunpowder Plot}, \emph{Encyclopaedia Britannica}, \url{http://www.britannica.com/EBchecked/topic/249505/Gunpowder-Plot}, accessed 5 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@online{eb2013gp,
  title = {Gunpowder Plot},
  maintitle = {Encyclopaedia Britannica},
  url = {http://www.britannica.com/EBchecked/topic/249505/Gunpowder-Plot},
  urldate = {2013-11-05}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{wp2013oup}
%<n>\enquote{Oxford University Press}, Wikipedia (last modified 5 Nov. 2013), \url{http://en.wikipedia.org/wiki/Oxford_University_Press}, accessed 5 Nov. 2013.
%<y>\enquote{Oxford University Press} (2013), Wikipedia (last modified 5 Nov.), \url{http://en.wikipedia.org/wiki/Oxford_University_Press}, accessed 5 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@online{wp2013oup,
  title = {Oxford University Press},
  organization = {Wikipedia},
  date = {2013-11-05},
  options = {datetype=last{\space}modified},
  url = {http://en.wikipedia.org/wiki/Oxford_University_Press},
  urldate = {2013-11-05}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


\section{Social media}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{obama2013tvd}
%<n>Barack Obama, \enquote{Tomorrow is Veterans Day} [Facebook post] (10 Nov. 2013), \url{https://www.facebook.com/barackobama/photos/a.53081056748.66806.6815841748/10151936988101749/}, accessed 13 Nov. 2013.
%<y>Obama, B. (2013), \enquote{Tomorrow is Veterans Day} [Facebook post] (10 Nov.), \url{https://www.facebook.com/barackobama/photos/a.53081056748.66806.6815841748/10151936988101749/}, accessed 13 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@online{obama2013tvd,
  author = {Barack Obama},
  title = {Tomorrow is Veterans Day},
  entrysubtype = {Facebook post},
  date = {2013-11-10},
  url = {https://www.facebook.com/barackobama/photos/a.53081056748.66806.6815841748/10151936988101749/},
  urldate = {2013-11-13}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{harvey2013tfm}
%<n>John Harvey, \enquote{\enquote{These are a Few of My Favourite Things}, No.~28} [Facebook post] (13 Nov. 2013), \url{https://www.facebook.com/photo.php?fbid=229786530530896&set=a.108896335953250.15125.100004986510149&type=1&theatre}, accessed 13 Nov. 2013.
%<y>Harvey, J. (2013), \enquote{\enquote{These are a Few of My Favourite Things}, No.~28} [Facebook post] (13 Nov.), \url{https://www.facebook.com/photo.php?fbid=229786530530896&set=a.108896335953250.15125.100004986510149&type=1&theatre}, accessed 13 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@online{harvey2013tfm,
  author = {John Harvey},
  title = {\enquote{These are a Few of My Favourite Things}, No.~28},
  entrysubtype = {Facebook post},
  date = {2013-11-13},
  url = {https://www.facebook.com/photo.php?fbid=229786530530896&set=a.108896335953250.15125.100004986510149&type=1&theatre},
  urldate = {2013-11-13}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{globe2013otd}
%<n>Shakespeare's Globe, \enquote{On this day in 1611 first production of The Tempest was performed by King's Men at Whitehall Palace before James I} [Twitter post], 5.48~a.m., 1 Nov. 2013, \url{https://twitter.com/The_Globe/status/396257422928400385}, accessed 5 Nov. 2013.
%<y>Shakespeare's Globe (2013), \enquote{On this day in 1611 first production of The Tempest was performed by King's Men at Whitehall Palace before James I} [Twitter post], 5.48~a.m., 1 Nov., \url{https://twitter.com/The_Globe/status/396257422928400385}, accessed 5 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@online{globe2013otd,
  author = {{Shakespeare's Globe}},
  title = {On this day in 1611 first production of The Tempest was performed by King's Men at Whitehall Palace before James I},
  entrysubtype = {Twitter post},
  date = {2013-11-01T05:48:00},
  url = {https://twitter.com/The_Globe/status/396257422928400385},
  urldate = {2013-11-05}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


\section{Software}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{simoga1.1d6}
Simoga, \emph{Device 6}, (version 1.1) [mobile application for iPhone and iPad], downloaded 9 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@software{simoga1.1d6,
  author = {Simoga},
  title = {Device 6},
  version = {1.1},
  entrysubtype = {mobile application for iPhone and iPad},
  urldate = {2013-11-09}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{eliot1.1.1twl}
%<n>T. S. Eliot, \emph{The Waste Land} (version 1.1.1) [mobile application for iPad] (London: Touch Press, 2013), downloaded 9 Nov. 2013.
%<y>Eliot, T. S. (2013), \emph{The Waste Land} (version 1.1.1) [mobile application for iPad] (London: Touch Press), downloaded 9 Nov. 2013.
\tcblower
\begin{Verbatim}
%</n|y>
@software{eliot1.1.1twl,
  author = {T. S. Eliot},
  title = {The Waste Land},
  version = {1.1.1},
  entrysubtype = {mobile application for iPad},
  location = {London},
  publisher = {Touch Press},
  date = {2013},
  urldate = {2013-11-09}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


\section{Database}

\begin{bibexbox}
%<n><NHR \S18.8.5>
%<y><NHR \S18.8.5\textdagger>
{un2011wpp}
%<n>United Nations, \emph{World Population Prospects: The 2010 Revision} [CD-ROM] (New York: United Nations Department of Economic and Social Affairs, Population Division, 2011).
%<y>United Nations (2011), \emph{World Population Prospects: The 2010 Revision} [CD-ROM] (New York: United Nations Department of Economic and Social Affairs, Population Division).
\tcblower
\begin{Verbatim}
%</n|y>
@dataset{un2011wpp,
  author = {{United Nations}},
  title = {World Population Prospects},
  subtitle = {The 2010 Revision},
  entrysubtype = {CD-ROM},
  location = {New York},
  publisher = {United Nations Department of Economic and Social Affairs, Population Division},
  date = {2011}}
%<*n|y>
\end{Verbatim}
\end{bibexbox}


\section{Notes}

\begin{itemize}
  \item Indicate missing date of publication with n.d.
  \item Clarify meaning of date if needed: posted 10 Oct. 2001.
  \item Access date can be omitted if publication date is given.
  \item Division can include instruction to search: s.v. \enquote{trignonometry}.
\end{itemize}


\chapter{Legal references}\label{sec:legal}
\chapterprecis{jurisdiction, legislation, legal}


\chapter{Specialist materials}\label{sec:special}
\chapterprecis{misc, unpublished, letter}

\section{Poems}\label{sec:poem}

\subsection{Long poems}

Used for poems divided into cantos. When using numerals, Book uses full capital roman, Canto uses small capital roman, Stanza uses lowercase roman, Line uses arabic.

\spec{Author, \emph{Title}, Book. Canto. Stanza. Line.}

Spenser, \emph{Faerie Queene}, II. \textsc{vi}. xxxv. 7

When using words (i.e. when citing whole stanzas or greater), use small capital roman numerals: bk. ii, canto iv, stanza xxxi.

\spec{Author, \emph{Title}, \lit{bk.} Book, \lit{canto} Canto, \lit{stanza} Stanza, \lit{line} Line.}

Spenser, \emph{Faerie Queene}, bk. ii, canto vi, stanza iii

\subsection{Short poems}

\spec{Author, \enquote{Title}, in\dots}

W. H. Auden, \enquote{Es regnet auf mir in den Schottische Lände} [\emph{sic}], in \enquote{The German Auden: Six Early Poems}, trans. David Constantine, in Katherine Bucknell and Nicholas Jenkins (eds.), \emph{W. H. Auden, \enquote{The Map of All my Youth}: Early Works, Friends, and Influences} (Auden Studies, 1; Oxford, 1990), 1--15 at 6.

William of Blois, \enquote{The Quarrel of the Flea and the Fly} (\emph{Pulicis et musce iurgia}), trans. in Jan M. Ziolkowski, \emph{Talking Animals: Medieval Latin Beast Poetry, 750-1150} (Middle Ages Series, ed. Edward Peters; Philadelphia: University of Pennsylvania Press, 1993), 274--8.

\section{Plays}\label{sec:play}

\spec{Author, \emph{Title}, Act. Scene. Line.}

\spec{Author, \emph{Title}, \lit{Act} Act, \lit{Scene} Scene, \lit{line} Line.}

\subsection{Notes}

\begin{itemize}
  \item When using numerals only in a parenthetical citation, Act uses small capital roman numerals. Otherwise, Act uses full capital roman numerals.

  \item Scene always uses lowercase roman numerals and Line always uses arabic.

  \item The words \enquote{Act} and \enquote{Scene} are capitalized, whereas \enquote{line} is not: Act IV, Scene iii, line 10.
\end{itemize}

\section{Manuscripts}\label{sec:ms}

\spec{Author, Title, City, Archive, Collection Series, Volume.}

\subsection{Notes}

\begin{itemize}
  \item Volume means any lower level division (file, bundle, box). Use whatever system the archive uses.
  \item Abbreviate folio to fo. (or fos.). Superscript \textsuperscript{r} and \textsuperscript{v} for recto and verso: fo. 7\textsuperscript{r--v}, fos. 117\textsuperscript{v}--121\textsuperscript{r}.
\end{itemize}


\chapter{General formatting tests}\label{sec:tests}


\printbibliography[notcategory=reviewed]
%</n|y>
%</doc|bib>
%<*driver>
\fi
\DocInput{\jobname.dtx}
%</driver>
%<*driver|doc>
\end{document}
%</driver|doc>
%<*bbx>
% \fi
% \chapter{Bibliography styles}
%
% \iffalse %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%<*o>
% \fi %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \section{Base style: oxref.bbx}
%
% \setcounter{FancyVerbLine}{19}
%
% \subsection{Preliminaries}
%
% Dependencies:
% \begin{itemize}
% \item
% For ease of maintenance, we will patch some definitions with \pkg{xpatch}
% instead of writing out our own in full.
% \item
% We will manipulate strings with \pkg{xstring}.
% \item
% We will use \pkg{graphicx} for stretching \cs{bibnamedash}es
% \end{itemize}
%
%    \begin{macrocode}
\RequirePackage{xpatch}
\RequirePackage{xstring}
\RequirePackage{graphicx}
%    \end{macrocode}
%
% Here we set some defaults different to the standard ones. The author
% can still override them.
%
%    \begin{macrocode}
\ExecuteBibliographyOptions{urldate=comp,pagetracker,timezeros=false,time=12h}
%    \end{macrocode}
%
% Language support may be widened in future, but for now we support the
% following:
%
%    \begin{macrocode}
\DeclareLanguageMapping{english}{british-oxref}
\DeclareLanguageMapping{british}{british-oxref}
\DeclareLanguageMapping{american}{british-oxref}
%    \end{macrocode}
%
% We provide some additional bibliography strings.
%
%    \begin{macrocode}
\NewBibliographyString{%
  at,
  under,
  facsimile,
  revised,
  suppto,
  equals,
  byperformer,
  bydirector,
  byreader}
%    \end{macrocode}
%
% We provide some magic values for triggering formatting changes.
%
% \begin{itemize}
% \item \cs{isInferred} relates to author names;
% \item \cs{whenPublished} relates to URL dates.
% \end{itemize}
%
%    \begin{macrocode}
\def\isInferred{inferred}
\def\whenPublished{published}
%    \end{macrocode}
%
% We base our styles on the standard on the principle of least surprise
% (and to aid with maintenance in the face of new \pkg{biblatex} versions).
%
%    \begin{macrocode}
\RequireBibliographyStyle{standard}
%    \end{macrocode}
%
% Here are the default punctuation conventions:
%
%    \begin{macrocode}
\renewcommand*{\labelnamepunct}{\addcomma\space}
\renewcommand*{\newunitpunct}{\addcomma\space}
\renewcommand*{\subtitlepunct}{\addcolon\space}
\renewcommand*{\intitlepunct}{\nopunct\space}
\renewcommand*{\bibnamedash}{\resizebox{2em}{\height}{\textemdash}\addthinspace}
\renewcommand*{\revsdnamedelim}{\addcomma}
%    \end{macrocode}
%
% \subsection{Name handling}
%
% We declare some new formats so that authors/editors/others who appear
% mid-reference can be handled differently from those that appear at the
% head of the reference
%
%    \begin{macrocode}
\DeclareNameAlias{bookauthor}{default}
\DeclareNameAlias{bookeditor}{default}
%    \end{macrocode}
%
% Traditionally, Oxford style (for the humanities) prints author names in
% small capitals in the bibliography, but in normal case in citations. This is
% falling out of fashion, so we introduce this as an option.
%
%    \begin{macrocode}
\newtoggle{blx@ox@scnames}
\DeclareBibliographyOption[boolean]{scnames}[true]{%
  \settoggle{blx@ox@scnames}{#1}
}
%    \end{macrocode}
%
% Oxford style (for the humanities) is to write author names surname first in
% the bibliography, but in natural order in citations. We implement this with
% the `bib-family-given/cite-given-family' name format. The case changing option
% only affects this name format.
%
%    \begin{macrocode}
\DeclareNameFormat{bib-family-given/cite-given-family}{%
  \ifbibliography{%
    \iftoggle{blx@ox@scnames}{%
      \renewcommand*{\mkbibnamefamily}[1]{\textsc{##1}}%
      \renewcommand*{\mkbibnamegiven}[1]{\textsc{##1}}%
      \renewcommand*{\mkbibnameprefix}[1]{\textsc{##1}}%
      \renewcommand*{\mkbibnamesuffix}[1]{\textsc{##1}}%
    }{}%
    \ifgiveninits{%
      \usebibmacro{name:family-given}%
        {\namepartfamily}%
        {\namepartgiveni}%
        {\namepartprefix}%
        {\namepartsuffix}%
    }{%
      \usebibmacro{name:family-given}%
        {\namepartfamily}%
        {\namepartgiven}%
        {\namepartprefix}%
        {\namepartsuffix}%
    }%
    \iftoggle{blx@ox@scnames}{%
      \renewcommand*{\mkbibnamefamily}[1]{##1}%
      \renewcommand*{\mkbibnamegiven}[1]{##1}%
      \renewcommand*{\mkbibnameprefix}[1]{##1}%
      \renewcommand*{\mkbibnamesuffix}[1]{##1}%
    }{}%
  }{%
    \ifgiveninits{%
      \usebibmacro{name:given-family}%
        {\namepartfamily}%
        {\namepartgiveni}%
        {\namepartprefix}%
        {\namepartsuffix}%
    }{%
      \usebibmacro{name:given-family}%
        {\namepartfamily}%
        {\namepartgiven}%
        {\namepartprefix}%
        {\namepartsuffix}%
    }%
  }%
  \usebibmacro{name:andothers}%
}
%    \end{macrocode}
%
% When using natural order for names, there is no comma before numeric
% suffixes, but there is before textual ones (e.g. ‘junior’).
%
%    \begin{macrocode}
\xpatchbibmacro{name:given-family}%
  {\bibnamedelimd\mkbibnamesuffix{#4}}%
  {\ifnumeral{#4}{}{\addcomma}\bibnamedelimd\mkbibnamesuffix{#4}}{}{}
%    \end{macrocode}
%
% For pseudonyms, Oxford style is to put the other name in parentheses
% after the main one. \pkg{Biblatex} provides the `nameaddon' field for this
% use case.
%
%    \begin{macrocode}
\DeclareFieldFormat{nameaddon}{\mkbibparens{#1}}
%    \end{macrocode}
%
% Traditional Oxford style is to use dashes instead of repeating author
% names, though NHR recommends abandoning the practice as it interferes
% with text mining. As per the standard `authortitle' and `authoryear'
% styles, we implement dashes by default but allow authors to switch
% this behaviour off with `dashed=false'.
%
%    \begin{macrocode}
\newbibmacro*{bbx:savehash}{%
  \savefield{fullhash}{\bbx@lasthash}}
\DeclareBibliographyOption{dashed}[true]{%
  \ifstrequal{#1}{true}{%
    \ExecuteBibliographyOptions{pagetracker}%
    \renewbibmacro*{bbx:savehash}{\savefield{fullhash}{\bbx@lasthash}}%
  }{%
    \renewbibmacro*{bbx:savehash}{}%
  }%
}
\InitializeBibliographyStyle{%
  \global\undef\bbx@lasthash}
\newbibmacro*{bbx:dashcheck}[2]{%
  \ifboolexpr{
    test {\iffieldequals{fullhash}{\bbx@lasthash}}
    and
    not test \iffirstonpage
    and
    (
      not bool {bbx@inset}
      or
      test {\iffieldequalstr{entrysetcount}{1}}
    )
  }{#1}{#2}%
}
%    \end{macrocode}
%
% The following is used in the `authortitle' and `authoryear' styles to
% switch off the dash check macro for reference sets.
%
%    \begin{macrocode}
\newbool{bbx@inset}
\DeclareBibliographyDriver{set}{%
  \booltrue{bbx@inset}%
  \entryset{}{}%
  \newunit\newblock
  \usebibmacro{setpageref}%
  \finentry}
%    \end{macrocode}
%
% The `author' macro is enhanced from the standard version by
% \begin{itemize}
%   \item
%   including a dash check, to see if the name(s) should be replaced
%   with a dash (as in `authortitle' and `authoryear');
%   \item
%   checking if the author name(s) should be formatted as if inferred;
%   \item
%   inserting the `nameaddon' field if provided;
%   \item
%   inserting the author type if provided (as in `authoryear').
% \end{itemize}
%
%    \begin{macrocode}
\renewbibmacro*{author}{%
  \ifboolexpr{
    test \ifuseauthor
    and
    not test {\ifnameundef{author}}
  }
  {\usebibmacro{bbx:dashcheck}
    {\bibnamedash}
    {\usebibmacro{bbx:savehash}%
      \iffieldequals{authortype}{\isInferred}
      {\mkbibbrackets{\printnames{author}}\clearfield{authortype}}%
      {\printnames{author}}%
      \iffieldundef{nameaddon}
      {}
      {\setunit{\addspace}%
        \printfield{nameaddon}}%
      \iffieldundef{authortype}
      {\setunit{\addspace}}
      {\newunit}}%
    \iffieldundef{authortype}
    {}
    {\usebibmacro{authorstrg}%
      \setunit{\addspace}}}%
  {\global\undef\bbx@lasthash}}
%    \end{macrocode}
%
% Following `authortitle' and `authoryear', we redefine the `editor' and
% `editor+others' macros to use a common `bbx:editor' macro. The macro
% we use is the same as the usual one except the editor type is set off
% using parentheses instead of a comma.
%
%    \begin{macrocode}
\renewbibmacro*{editor}{%
  \usebibmacro{bbx:editor}{editorstrg}}
\renewbibmacro*{editor+others}{%
  \usebibmacro{bbx:editor}{editor+othersstrg}}
\newbibmacro*{bbx:editor}[1]{%
  \ifboolexpr{
    test \ifuseeditor
    and
    not test {\ifnameundef{editor}}
  }
  {\usebibmacro{bbx:dashcheck}
    {\bibnamedash}
    {\printnames{editor}%
     \setunit{\addspace}%
     \usebibmacro{bbx:savehash}}%
    \usebibmacro{#1}%
    \clearname{editor}}
  {\global\undef\bbx@lasthash}}
\DeclareFieldFormat{editortype}{\mkbibparens{#1}}
%    \end{macrocode}
%
% We do the same for `translator' as well.
%
%    \begin{macrocode}
\renewbibmacro*{translator}{%
  \usebibmacro{bbx:translator}{translatorstrg}}
\renewbibmacro*{translator+others}{%
  \usebibmacro{bbx:translator}{translator+othersstrg}}
\newbibmacro*{bbx:translator}[1]{%
  \ifboolexpr{
    test \ifusetranslator
    and
    not test {\ifnameundef{translator}}
  }
  {\usebibmacro{bbx:dashcheck}
    {\bibnamedash}
    {\printnames{translator}%
      \setunit{\addspace}%
      \usebibmacro{bbx:savehash}}%
    \usebibmacro{#1}%
    \clearname{translator}%
    \setunit{\addspace}}%
  {\global\undef\bbx@lasthash}}
\xpatchbibmacro{translatorstrg}%
  {\bibstring}%
  {\bibstring[\mkbibparens]}{}{}%
\xpatchbibmacro{translator+othersstrg}%
  {\bibstring}%
  {\bibstring[\mkbibparens]}{}{}%
%    \end{macrocode}
%
% When referencing one work from a collection by the same author,
% Oxford style traditionally puts \enquote{id.} in the `bookauthor'
% position (instead of omitting it as in standard \pkg{biblatex}).
%
%    \begin{macrocode}
\renewbibmacro*{bybookauthor}{%
  \ifnamesequal{author}{bookauthor}%
  {\bibstring{idem\thefield{gender}}}%
  {\printnames{bookauthor}}}
%    \end{macrocode}
%
% Similarly, with mixed collections, if referencing a work by the editor
% of the collection, the editor name is replaced with \enquote{id.}. We
% insert this logic into a copy of the `editor+others' macro, which will
% \emph{not} get a year inserted into it by \textsf{oxyear}.
%
%    \begin{macrocode}
\newbibmacro*{bookeditor}{%
  \global\undef\bbx@lasthash
  \ifboolexpr{
    test \ifuseeditor
    and
    not test {\ifnameundef{editor}}
  }{%
    \ifnamesequal{author}{editor}{%
      \bibstring{idem\thefield{gender}}%
      \addspace
      \usebibmacro{editor+othersstrg}%
      \clearname{editor}%
    }{%
      \printnames[bookeditor]{editor}%
      \newunit%
      \usebibmacro{editor+othersstrg}%
      \clearname{editor}%
    }%
  }{}}
%    \end{macrocode}
%
% \subsection{Titles}
%
% Title handling is mostly as it is in the standard styles, except
% that the `titleaddon' is printed in square brackets; it is not
% preceeded by punctuation.
%
%    \begin{macrocode}
\newbibmacro*{title}{%
  \ifboolexpr{
    test {\iffieldundef{title}}
    and
    test {\iffieldundef{subtitle}}
  }
  {}
  {\printtext[title]{%
      \printfield[titlecase]{title}%
      \setunit{\subtitlepunct}%
      \printfield[titlecase]{subtitle}}%
    \setunit{\addspace}}%
  \printfield{titleaddon}%
  \iffieldequalstr{relatedtype}{equals}{%
    \iftoggle{bbx:related}{%
      \usebibmacro{related:init}%
      \usebibmacro{related}%
      \clearfield{related}%
    }{}%
  }{}%
}
\DeclareFieldFormat{titleaddon}{\mkbibbrackets{#1}}
%    \end{macrocode}
%
% \subsection{Date handling}
%
% Year ranges are truncated (e.g.~2012–3). Therefore, we provide a
% command that compares two years, and outputs a full or truncated
% version of the second year, depending on how similar it is to the
% first. It is extracted and adapted from code by Marco Daniel.%
% \footnote{\url{http://tex.stackexchange.com/questions/23483/}}
%
%    \begin{macrocode}
\newcommand{\blx@ox@compyear}[2]{%
  \def\num@one{#1}%
  \def\num@two{#2}%
  \StrLen{\num@one}[\num@one@len]%
  \StrLen{\num@two}[\num@two@len]%
  \IfEq{\num@one@len}{\num@two@len}%
  {\StrCompare{\num@one}{\num@two}[\Result]%
    \ifnum\num@two@len>3%
    \IfStrEq{\Result}{2}{\def\Result{1}}{}%
    \fi
    \StrGobbleLeft{0\num@two}{\Result}}%
  {\num@two}%
}
%    \end{macrocode}
%
% We patch the truncated date formats from `biblatex.sty' to use the
% above function.
%
%    \begin{macrocode}
\patchcmd{\mkdaterangetrunc}{%
  \csuse{mkbibdate#1}{#2endyear}{#2endmonth}{#2endday}%
}{%
  \iffieldundef{#2endmonth}%
    {\blx@ox@compyear{\thefield{#2year}}{\thefield{#2endyear}}}%
    {\csuse{mkbibdate#1}{#2endyear}{#2endmonth}{#2endday}}%
}{}{}
\patchcmd{\mkdaterangetruncextra}{%
  \csuse{mkbibdate#1}{#2endyear}{#2endmonth}{#2endday}%
}{%
  \iffieldundef{#2endmonth}%
    {\blx@ox@compyear{\thefield{#2year}}{\thefield{#2endyear}}}%
    {\csuse{mkbibdate#1}{#2endyear}{#2endmonth}{#2endday}}%
}{}{}
%    \end{macrocode}
%
% We provide a way of prefacing dates with a type. This is mainly
% intended for online resources.
%
%    \begin{macrocode}
\def\dateType{}
\DeclareEntryOption{datetype}{\def\dateType{#1}}
\renewbibmacro*{date}{%
  \ifdefvoid{\dateType}{}{\printtext{\dateType\addspace}}%
  \printdate}
%    \end{macrocode}
%
% \subsection{Other number-like fields}
%
% We let `edition' take a language key as well as a number
%
%    \begin{macrocode}
\xpatchfieldformat{edition}{%
  #1\isdot
}{%
  \ifbibstring{#1}{\bibstring{#1}}{#1\isdot}%
}{}{}
%    \end{macrocode}
%
% Page ranges are compressed, but are not usually marked with
% \enquote{pp.}. The exception is if the page numbers are not obviously
% numbers.
%
%    \begin{macrocode}
\DeclareFieldFormat{pages}{%
  \iffieldundef{bookpagination}%
    {\mkcomprange{#1}}%
    {\mkcomprange[{\mkpageprefix[bookpagination]}]{#1}}%
}
%    \end{macrocode}
%
% The same is true in citations.
%
%    \begin{macrocode}
\DeclareFieldFormat{postnote}{%
  \iffieldundef{pagination}%
  {\mkcomprange{#1}}%
  {\mkcomprange[{\mkpageprefix[pagination]}]{#1}}%
}

%    \end{macrocode}
%
% \subsection{Publishers}
%
% The \emph{Oxford Guide to Style} says it is fine to omit publisher
% names uniformly from bibliographic information. This is odd, but we
% can support it with a simple option.
%
%    \begin{macrocode}
\DeclareBibliographyOption{nopublisher}[true]{%
  \DeclareFieldInputHandler{publisher}{\def\NewValue{}}%
}
%    \end{macrocode}
%
% \subsection{URLs}
%
% The OGS recommends the ISO convention of enclosing URLs in angle
% brackets, but NHR recommends leaving URLs bare so as not to interfere
% with text-mining. The latter is the default.
%
%    \begin{macrocode}
\DeclareBibliographyOption{isourls}[true]{%
  \ifstrequal{#1}{true}
    {\DeclareFieldFormat{url}{$\langle$\url{##1}$\rangle$}}
    {\DeclareFieldFormat{url}{\url{##1}}}%
}
\ExecuteBibliographyOptions{isourls=false}
%    \end{macrocode}
%
% URL dates are set off with a comma rather than parentheses.
%
%    \begin{macrocode}
\DeclareFieldFormat{urldate}{\bibstring{urlseen}\space#1}
\xpatchbibmacro{url+urldate}%
  {\setunit*{\addspace}}%
  {\setunit*{\addcomma\addspace}}{}{}
%    \end{macrocode}
%
% The `urldatetype' implementation below was intended to support a use
% case from the OGS, but it is not something promoted by NHR, and that
% sort of use case is probably better met with a note of some kind.
% It will be removed.
%
%    \begin{macrocode}
\DeclareEntryOption{urldatetype}{%
  \DeclareFieldFormat{urldate}{\printtext{#1}\space##1}%
  \renewbibmacro*{url+urldate}{%
    \iffieldundef{url}{}{%
      \newunit
      \printurldate%
      \setunit*{\addspace}%
      \printfield{url}%
      \nopunct
    }%
  }%
}
%    \end{macrocode}
%
% The DOI is introduced by \enquote{doi} in lowercase.
%
%    \begin{macrocode}
\xpatchfieldformat{doi}%
  {\mkbibacro{DOI}}%
  {\printtext{doi}}{}{}
%    \end{macrocode}
%
% Unlike URLs, DOIs are preceded by a full stop.
%
%    \begin{macrocode}
\xpatchbibmacro{doi+eprint+url}%
  {\printfield{doi}}%
  {\setunit{\addperiod\space}\printfield{doi}}{}{}

%    \end{macrocode}
%
% \subsection{Addenda}
%
% Publication state is given in parentheses. Other addenda are added
% plain.
%
%    \begin{macrocode}
\renewbibmacro*{addendum+pubstate}{%
  \iffieldundef{pubstate}{}{\nopunct}%
  \printfield[parens]{pubstate}%
  \setunit{\addperiod\addspace}\newblock
  \printfield{addendum}}
%    \end{macrocode}
%
% \subsection{Periodical-style entries}
%
% Subtypes for articles and similar are in square brackets.
%
%    \begin{macrocode}
\DeclareFieldFormat[article,periodical,review]{entrysubtype}{\mkbibbrackets{#1}}
%    \end{macrocode}
%
% Journal types are also in square brackets. Note that when OGS was
% published, online journals were a novelty, but since they are now
% commonplace there is no purpose to pointing them out any more, so NHR
% doesn't. This complication will be removed.
%
%    \begin{macrocode}
\newbibmacro*{journaltype}{%
  \iffieldequalstr{entrysubtype}{online journal}%
  {\nopunct\printfield{entrysubtype}}{}%
}
%    \end{macrocode}
%
% We patch the `journal+issuetitle' macro so that if a work takes up a
% whole issue (signified by using `issuetitle' \emph{instead} of
% `title'), the title and journal title are separated by \enquote{=}
% instead of the usual punctuation.
% We also insert the above macro for journal types,
% and insert a new unit after the journal title regardless of what
% follows.
%
%    \begin{macrocode}
\xpatchbibmacro{journal+issuetitle}{%
  \usebibmacro{journal}%
  \setunit*{\addspace}%
}{
  \ifboolexpr{
    test {\iffieldundef{title}}
    and
    not test {\iffieldundef{issuetitle}}
  }{%
    \usebibmacro{issue}%
    \clearfield{issuetitle}%
    \setunit{\addspace =\addspace}}{}%
  \usebibmacro{journal}%
  \usebibmacro{journaltype}%
  \newunit
}{}{}
\xpatchbibmacro{journal+issuetitle}{%
  \newunit\printfield{series}%
}{%
  \printfield{series}%
}{}{}
%    \end{macrocode}
%
% Similarly, we patch the `title+issuetitle' macro to insert
% the `journaltype' macro and insert
% a new unit after the journal title regardless of what follows.
%
%    \begin{macrocode}
\xpatchbibmacro{title+issuetitle}{%
  \usebibmacro{periodical}%
  \setunit*{\addspace}%
}{%
  \usebibmacro{periodical}%
  \usebibmacro{journaltype}%
  \newunit
}{}{}
\xpatchbibmacro{title+issuetitle}{%
  \newunit\printfield{series}%
}{%
  \printfield{series}%
}{}{}
%    \end{macrocode}
%
% On last inspection, \pkg{biblatex} hard-coded the punctuation for volumes
% and issue numbers into the \texttt{title+issuetitle} macro instead of
% delegating to the appropriate macro. We expect this to change in
% future but in the meantime correct this ourselves.
%
%    \begin{macrocode}
\xpatchbibmacro{title+issuetitle}{%
  \printfield{volume}%
  \setunit*{\adddot}%
  \printfield{number}%
  \setunit{\addcomma\space}%
  \printfield{eid}%
}{%
  \usebibmacro{volume+number+eid}%
}{}{}
%    \end{macrocode}
%
% OGS and NHR provide plentiful options for formatting volume and issue
% numbers. We implement four of them here as options. The default is to
% use a slash between volume and issue number. Note that we prevent the
% `volume+number+eid' macro from actually printing the eid.
%
%    \begin{macrocode}
\DeclareBibliographyOption{issuestyle}[slash]{%
  \ifcsdef{blx@ox@issuestyle@#1}{%
    \csuse{blx@ox@issuestyle@#1}%
  }{%
    \PackageError{biblatex}
      {Invalid option 'issuestyle=#1'}
      {Valid values are 'slash', 'colon', 'comma', 'parens'}%
  }%
}
\csdef{blx@ox@issuestyle@slash}{%
  \renewbibmacro*{volume+number+eid}{%
    \printfield{volume}%
    \setunit*{\addslash}%
    \printfield{number}%
  }%
}
\csdef{blx@ox@issuestyle@colon}{%
  \renewbibmacro*{volume+number+eid}{%
    \printfield{volume}%
    \setunit*{\addcolon\space}%
    \printfield{number}%
  }%
}
\csdef{blx@ox@issuestyle@comma}{%
  \renewbibmacro*{volume+number+eid}{%
    \printfield{volume}%
    \setunit*{\addcomma\space}%
    \printfield{number}%
  }%
}
\csdef{blx@ox@issuestyle@parens}{%
  \renewbibmacro*{volume+number+eid}{%
    \printfield{volume}%
    \setunit*{\addspace}%
    \printfield[parens]{number}%
  }%
}
\ExecuteBibliographyOptions{issuestyle=slash}
%    \end{macrocode}
%
% If an issue has no volume or issue numbers (first block), the season
% and date are printed bare. Otherwise (second block) they are printed
% in parentheses just as in the standard version of the macro.
%
%    \begin{macrocode}
\renewbibmacro*{issue+date}{%
  \ifboolexpr{
    test {\iffieldundef{volume}}
    and
    test {\iffieldundef{number}}
  }{%
    \newunit\printtext{%
      \iffieldundef{issue}{%
        \usebibmacro{date}
      }{%
        \printfield{issue}%
        \setunit*{\addspace}%
        \usebibmacro{date}%
      }%
    }%
  }{%
    \ifboolexpr{
      test {\iffieldundef{issue}}
      and (
        test {\iffieldundef{year}}
        and
        test {\iffieldundef{month}}
      )
    }{}{%
      \printtext[parens]{%
        \iffieldundef{issue}{%
          \usebibmacro{date}%
        }{%
          \printfield{issue}%
          \setunit*{\addspace}%
          \usebibmacro{date}%
        }%
      }%
    }%
  }%
  \newunit
  \printfield{eid}%
}
%    \end{macrocode}
%
% We patch the `article' driver to remove the \enquote{in} macro, move the
% related macro forward a bit, and adjust punctuation after editors and page
% references.
%
%    \begin{macrocode}
\xpatchbibdriver{article}{%
  \usebibmacro{in:}%
  \usebibmacro{journal+issuetitle}%
}{%
  \usebibmacro{journal+issuetitle}%
}{}{}
\xpatchbibdriver{article}{%
  \usebibmacro{byeditor+others}%
  \newunit
}{%
  \usebibmacro{byeditor+others}%
  \iffieldundef{note}{\newunit}{\setunit{\addsemicolon\addspace}}
}{}{}
\xpatchbibdriver{article}{%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \newunit\newblock
  \iftoggle{bbx:related}
    {\usebibmacro{related:init}%
     \usebibmacro{related}}
    {}%
}{%
  \setunit{\addsemicolon\space\bibsentence}%
  \iftoggle{bbx:related}
    {\usebibmacro{related:init}%
     \usebibmacro{related}}
    {}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
}{}{}
%    \end{macrocode}
%
% We suppress the printing of the page numbers if the article is in a
% supplement.
%
%    \begin{macrocode}
\newbibmacro*{note+pages}{%
  \printfield{note}%
  \setunit{\bibpagespunct}%
  \iffieldequalstr{relatedtype}{suppto}{}{%
    \printfield{pages}%
  }%
  \newunit}
%    \end{macrocode}
%
% We provide a macro to support the printing of parent periodicals.
%
%    \begin{macrocode}
\newbibmacro*{related:suppto}[1]{%
  \entrydata*{#1}{%
    \usedriver{}{%
      \thefield{entrytype}%
    }%
  }%
  \iffieldundef{bookpagination}%
    {\setunit{\bibpagespunct}}%
    {\newunit}%
  \printfield{pages}%
}
%    \end{macrocode}
%
% \subsection{Monograph-style entries}
%
% The titles of books that have been collected into an anthology are
% treated like regular chapters and set in quotes.
%
%    \begin{macrocode}
\DeclareFieldFormat[bookinbook]{citetitle}{\mkbibquote{#1\isdot}}
\DeclareFieldFormat[bookinbook]{title}{\mkbibquote{#1\isdot}}
%    \end{macrocode}
%
% Volume numbers in monograph-style entries are formatted as roman
% numerals.
%
%    \begin{macrocode}
\DeclareFieldFormat[book,bookinbook,inbook,mvbook,%
collection,incollection,mvcollection,%
proceedings,inproceedings,mvproceedings,%
reference,inreference,mvreference]{volume}{\Rn{#1}}
%    \end{macrocode}
%
% Where a multi-volume work is more like a series, the volume number and
% main title are put in a bracketted block between the volume title
% and the usual publication block.
%
%    \begin{macrocode}
\newbibmacro*{maintitle+volume}{%
  \ifboolexpr{
    test {\iffieldundef{maintitle}}
    or
    test {\iffieldundef{volume}}
  }{}%
  {\printtext[brackets]{%
    \bibstring{volume}\addspace
    \printfield{volume}\printfield{part}\addspace
    \bibstring{ofseries}\addspace
    \usebibmacro{maintitle}}}
}
%    \end{macrocode}
%
% Oxford style signifies formal publication by putting the relevant
% details in parentheses.
%
%    \begin{macrocode}
\DeclareFieldFormat{publication}{\mkbibparens{#1}}
%    \end{macrocode}
%
% Standard \pkg{biblatex} puts a space between series name and number.
% OGS separates them with a comma.
%
%    \begin{macrocode}
\renewbibmacro*{series+number}{%
  \printfield{series}%
  \newunit
  \printfield{number}%
  \newunit}
%    \end{macrocode}
%
% When citing both the first and a later edition, the first one comes
% first, and the later one comes after a semicolon. As per standard
% \pkg{biblatex}, the elements of a single edition are separated by commas
% except that the publisher is preceded by a colon.
%
%    \begin{macrocode}
\newcounter{locpubpairs}
\newbibmacro*{edition+publisher+location+date}{%
  \printlist{origlocation}%
  \iflistundef{origpublisher}%
  {\setunit*{\addcomma\space}}%
  {\setunit*{\addcolon\space}}%
  \printlist{origpublisher}%
  \setunit*{\addcomma\space}%
  \printorigdate%
  \setunit*{\addsemicolon\space}%
  \printfield{edition}%
  \setunit*{\addcomma\space}%
%    \end{macrocode}
%
% If there are the same number of locations and publishers, and there
% are more than one pair, we print them pairwaise rather than in two
% separate lists.
%
%    \begin{macrocode}
  \ifboolexpr{%
    test {\ifnumcomp{\value{publisher}}{>}{1}}
    and
    test {\ifnumequal{\value{location}}{\value{publisher}}}
  }{%
    \setcounter{locpubpairs}{0}%
    \savebibmacro{list:andothers}%
    \renewbibmacro*{list:andothers}{}%
    \whileboolexpr{%
      test {\ifnumcomp{\value{locpubpairs}}{<}{\value{publisher}}}
    }{%
      \stepcounter{locpubpairs}%
      \ifnumcomp{\value{locpubpairs}}{>}{1}{%
        \ifnumequal{\value{publisher}}{2}{%
          \setunit*{\addspace\bibstring{and}\addspace}%
        }{%
          \ifnumequal{\value{locpubpairs}}{\value{publisher}}{%
            \setunit*{\addcomma\space\bibstring{and}\addspace}%
          }{%
            \setunit*{\addcomma\space}%
          }%
        }%
      }{}%
      \printlist[][\value{locpubpairs}-\value{locpubpairs}]{location}%
      \setunit*{\addcolon\space}%
      \printlist[][\value{locpubpairs}-\value{locpubpairs}]{publisher}%
    }%
    \restorebibmacro{list:andothers}%
  }{%
    \printlist{location}%
    \iflistundef{publisher}%
    {\setunit*{\addcomma\space}}%
    {\setunit*{\addcolon\space}}%
    \printlist{publisher}%
  }%
  \setunit*{\addcomma\space}%
  \usebibmacro{date}%
}
%    \end{macrocode}
%
% Oxford style is to provide publication details –
% series name and number, edition, publisher, location, date –
% in a parenthetical block after the title information.
%
%    \begin{macrocode}
\newbibmacro*{series+number+edition+publisher+location+date}{%
  \nopunct\printtext[publication]{%
    \usebibmacro{series+number}%
    \setunit*{\addsemicolon\addspace}%
    \usebibmacro{edition+publisher+location+date}%
  }%
}
%    \end{macrocode}
%
% The edition information for reference works is recorded earlier in the
% reference, so we provide a variant that excludes it from the
% publication block.
%
%    \begin{macrocode}
\newbibmacro*{series+number+publisher+location+date}{%
  \nopunct\printtext[publication]{%
    \usebibmacro{series+number}%
    \setunit*{\addsemicolon\addspace}%
    \usebibmacro{publisher+location+date}%
  }%
}
%    \end{macrocode}
%
% The changes to the `book' driver compared to the standard style are as
% follows:
% \begin{itemize}
%   \item
%   only `author' appears before the title, never `editor'.
%   \item
%   `maintitle' is processed with `volume' just before `series', instead
%   of with `title';
%   \item
%   `edition' is processed where the standard style processes `note',
%   and vice versa;
%   \item
%   `volumes' is omitted;
%   \item
%   `series' to `date' information is delegated to a separate macro;
%   \item
%   support is added for `howpublished' field;
%   \item
%   before `related', there is a full stop instead of a comma.
% \end{itemize}
%
%    \begin{macrocode}
\DeclareBibliographyDriver{book}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{title}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \usebibmacro{byeditor+others}%
  \newunit\newblock
  \printfield{note}%
  \newunit\newblock
  \usebibmacro{maintitle+volume}%
  \newunit
  \usebibmacro{series+number+edition+publisher+location+date}%
  \setunit{\addspace}%
  \printfield[brackets]{howpublished}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit
  \printfield{pagetotal}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
    {\printfield{isbn}}
    {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
  \iftoggle{bbx:related}
    {\usebibmacro{related:init}%
     \usebibmacro{related}}
    {}%
  \usebibmacro{finentry}}
%    \end{macrocode}
%
% Unlike the standard styles, we have a separate driver for `mvbook'
% which behaves slightly differently. It is in fact closer to the
% standard `book' driver. The changes are as follows:
% \begin{itemize}
%   \item
%   only `author' appears before the title, never `editor';
%   \item
%   `volume'/`part' is processed just after `maintitle+title';
%   \item
%   `edition' is processed where the standard style processes `note';
%   \item
%   `note' is processed after `volumes';
%   \item
%   `series' to `date' information is delegated to a separate macro;
%   \item
%   before `related', there is a full stop instead of a comma.
% \end{itemize}
%
%    \begin{macrocode}
\DeclareBibliographyDriver{mvbook}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{maintitle+title}%
  \newunit
  \iffieldundef{maintitle}
  {\printfield{volume}%
    \printfield{part}}
  {}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \usebibmacro{byeditor+others}%
  \newunit\newblock
  \printfield{volumes}%
  \newunit\newblock
  \printfield{note}%
  \newunit\newblock%
  \usebibmacro{series+number+edition+publisher+location+date}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit
  \printfield{pagetotal}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
  {\printfield{isbn}}
  {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
  \iftoggle{bbx:related}
  {\usebibmacro{related:init}%
    \usebibmacro{related}}
  {}%
  \usebibmacro{finentry}}
%    \end{macrocode}
%
% Our `inbook' driver modifies the standard one in just the same way as
% our `mvbook' driver modifies the standard `book'.
%
%    \begin{macrocode}
\DeclareBibliographyDriver{inbook}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/translator+others}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{title}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \usebibmacro{in:}%
  \usebibmacro{bybookauthor}%
  \newunit\newblock
  \usebibmacro{maintitle+booktitle}%
  \newunit
  \iffieldundef{maintitle}
  {\printfield{volume}%
    \printfield{part}}
  {}%
  \newunit\newblock
  \usebibmacro{byeditor+others}%
  \newunit\newblock
  \printfield{volumes}%
  \newunit\newblock
  \printfield{note}%
  \newunit\newblock%
  \usebibmacro{series+number+edition+publisher+location+date}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
  {\printfield{isbn}}
  {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
  \iftoggle{bbx:related}
  {\usebibmacro{related:init}%
    \usebibmacro{related}}
  {}%
  \usebibmacro{finentry}}
%    \end{macrocode}
%
% Our `collection' driver modifies the standard one in just the same way
% as our `book' driver.
%
%    \begin{macrocode}
\DeclareBibliographyDriver{collection}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{editor+others}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{title}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byeditor+others}%
  \newunit\newblock
  \printfield{note}%
  \newunit\newblock
  \usebibmacro{maintitle+volume}%
  \newunit
  \usebibmacro{series+number+edition+publisher+location+date}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit
  \printfield{pagetotal}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
  {\printfield{isbn}}
  {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
  \iftoggle{bbx:related}
  {\usebibmacro{related:init}%
    \usebibmacro{related}}
  {}%
  \usebibmacro{finentry}}
%    \end{macrocode}
%
% Our `mvcollection' driver modifies the standard `collection' driver
% in just the same way as our `mvbook' driver modifies the standard
% `book'.
%
%    \begin{macrocode}
\DeclareBibliographyDriver{mvcollection}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{editor+others}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{maintitle+title}%
  \newunit
  \iffieldundef{maintitle}
  {\printfield{volume}%
    \printfield{part}}
  {}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byeditor+others}%
  \newunit\newblock
  \printfield{volumes}%
  \newunit\newblock
  \printfield{note}%
  \newunit\newblock%
  \usebibmacro{series+number+edition+publisher+location+date}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit
  \printfield{pagetotal}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
  {\printfield{isbn}}
  {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
  \iftoggle{bbx:related}
  {\usebibmacro{related:init}%
    \usebibmacro{related}}
  {}%
  \usebibmacro{finentry}}
%    \end{macrocode}
%
% Our `incollection' driver modifies the standard one in the same way as
% our `mvbook' driver modifies the standard `book'. In addition, the
% `bookeditor' macro precedes `maintitle' instead of `byeditor+others'
% following it.
%
%    \begin{macrocode}
\DeclareBibliographyDriver{incollection}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/translator+others}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{title}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \usebibmacro{in:}%
  \usebibmacro{bookeditor}%
  \newunit\newblock
  \usebibmacro{maintitle+booktitle}%
  \newunit
  \iffieldundef{maintitle}
  {\printfield{volume}%
    \printfield{part}}
  {}%
  \newunit\newblock
  \printfield{volumes}%
  \newunit\newblock
  \printfield{note}%
  \newunit\newblock%
  \usebibmacro{series+number+edition+publisher+location+date}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
  {\printfield{isbn}}
  {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
  \iftoggle{bbx:related}
  {\usebibmacro{related:init}%
    \usebibmacro{related}}
  {}%
  \usebibmacro{finentry}}
%    \end{macrocode}
%
% Unlike the standard styles, we provide a separate driver for
% `reference'. It is just like `book' except that `edition' is given
% between `byauthor' and `byeditor+others'.
%
%    \begin{macrocode}
\DeclareBibliographyDriver{reference}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{title}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \printfield{edition}%
  \newunit
  \usebibmacro{byeditor+others}%
  \newunit\newblock
  \printfield{note}%
  \newunit\newblock
  \usebibmacro{maintitle+volume}%
  \newunit
  \usebibmacro{series+number+publisher+location+date}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit
  \printfield{pagetotal}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
  {\printfield{isbn}}
  {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
  \iftoggle{bbx:related}
  {\usebibmacro{related:init}%
    \usebibmacro{related}}
  {}%
  \usebibmacro{finentry}}
%    \end{macrocode}
%
% Similarly, `mvreference' is just like `mvbook' except that `edition'
% is given between `byauthor' and `byeditor+others'.
%
%    \begin{macrocode}
\DeclareBibliographyDriver{mvreference}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{maintitle+title}%
  \newunit
  \iffieldundef{maintitle}
  {\printfield{volume}%
    \printfield{part}}
  {}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \printfield{edition}%
  \newunit
  \usebibmacro{byeditor+others}%
  \newunit\newblock
  \printfield{volumes}%
  \newunit\newblock
  \printfield{note}%
  \newunit\newblock
  \usebibmacro{series+number+publisher+location+date}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit
  \printfield{pagetotal}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
  {\printfield{isbn}}
  {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
  \iftoggle{bbx:related}
  {\usebibmacro{related:init}%
    \usebibmacro{related}}
  {}%
  \usebibmacro{finentry}}
%    \end{macrocode}
%
% Our `inreference' driver is just like `inbook' except `bookeditor'
% replaces `bybookauthor' and `edition' is given just before
% `byeditor+others'.
%
%    \begin{macrocode}
\DeclareBibliographyDriver{inreference}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/translator+others}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{title}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \usebibmacro{in:}%
  \usebibmacro{bookeditor}%
  \newunit\newblock
  \usebibmacro{maintitle+booktitle}%
  \newunit
  \iffieldundef{maintitle}
  {\printfield{volume}%
    \printfield{part}}
  {}%
  \newunit\newblock
  \printfield{edition}%
  \newunit
  \usebibmacro{byeditor+others}%
  \newunit\newblock
  \printfield{volumes}%
  \newunit\newblock
  \printfield{note}%
  \newunit\newblock%
  \usebibmacro{series+number+publisher+location+date}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit
  \printfield{pagetotal}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
  {\printfield{isbn}}
  {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
  \iftoggle{bbx:related}
  {\usebibmacro{related:init}%
    \usebibmacro{related}}
  {}%
  \usebibmacro{finentry}}
%    \end{macrocode}
%
% \subsection{Proceedings}
%
% In our version of the `event+venue+date' macro, the venue and date
% are set off with a colon and comma respectively instead of
% parentheses. A bit of jiggery-pokery is used to make the colon italic
% if it follows italic text.
%
%    \begin{macrocode}
\renewbibmacro*{event+venue+date}{%
  \printfield{eventtitle}%
  \newunit
  \printfield{eventtitleaddon}%
  \ifboolexpr{
    test {\iffieldundef{venue}}
    and
    test {\iffieldundef{eventyear}}
  }
  {}
  {\ifboolexpr{
      test {\iffieldundef{language}}
      and
      test {\iffieldundef{eventtitle}}
    }{\setunit{\mkbibemph{\addcolon}\addspace}}%
    {\setunit{\addcolon\addspace}}%
    \printfield{venue}%
    \newunit%
    \printeventdate}%
  \newunit}
%    \end{macrocode}
%
% The changes to the `proceedings' driver compared to the standard style
% are as follows:
% \begin{itemize}
%   \item
%   `organization' is moved before the title;
%   \item
%   `editor' comes after the title, not before;
%   \item
%   `volume'/`part' is processed just after `maintitle+title';
%   \item
%   `note' is moved to before `series';
%   \item
%   `series' to `date' information is delegated to a separate macro;
%   \item
%   before `related', there is a full stop instead of a comma.
% \end{itemize}
%
%    \begin{macrocode}
\DeclareBibliographyDriver{proceedings}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \printlist{organization}%
  \newunit
  \usebibmacro{maintitle+title}%
  \newunit
  \iffieldundef{maintitle}
  {\printfield{volume}%
    \printfield{part}}
  {}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{event+venue+date}%
  \newunit\newblock
  \usebibmacro{byeditor+others}%
  \newunit\newblock
  \printfield{volumes}%
  \newunit\newblock
  \printfield{note}%
  \newunit\newblock
  \usebibmacro{series+number+edition+publisher+location+date}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit
  \printfield{pagetotal}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
  {\printfield{isbn}}
  {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
  \iftoggle{bbx:related}
  {\usebibmacro{related:init}%
    \usebibmacro{related}}
  {}%
  \usebibmacro{finentry}}
%    \end{macrocode}
%
% Our `inproceedings' driver modifies the standard one in the same way
% as our `proceedings' driver modifies the standard one.
%
%    \begin{macrocode}
\DeclareBibliographyDriver{inproceedings}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/translator+others}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{title}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \usebibmacro{in:}%
  \usebibmacro{maintitle+booktitle}%
  \newunit
  \iffieldundef{maintitle}
  {\printfield{volume}%
    \printfield{part}}
  {}%
  \newunit\newblock
  \usebibmacro{event+venue+date}%
  \newunit\newblock
  \usebibmacro{byeditor+others}%
  \newunit\newblock
  \printfield{volumes}%
  \newunit\newblock
  \printfield{note}%
  \newunit\newblock
  \printlist{organization}%
  \newunit
  \usebibmacro{series+number+publisher+location+date}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
  {\printfield{isbn}}
  {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
  \iftoggle{bbx:related}
  {\usebibmacro{related:init}%
    \usebibmacro{related}}
  {}%
  \usebibmacro{finentry}}
%    \end{macrocode}
%
% \subsection{Grey literature}
%
% We provide a macro for handling `type+number'. We provide some extra
% logic to insert `No.' before the number if there is no type.
%
%    \begin{macrocode}
\newbibmacro*{series+type+number}{%
  \printfield{series}%
  \newunit
  \ifboolexpr{%
      test {\iffieldundef{type}}
      and
      not test {\iffieldundef{number}}
  }{%
    \bibcpstring{number}
  }{%
    \printfield{type}%
  }%
  \setunit*{\addspace}%
  \printfield{number}}
%    \end{macrocode}
%
% Our version of the `institution+location+date' macro is just like the
% standard one except it is wrapped in parentheses, and the preceding
% punctuation is therefore suppressed. This is used by the standard
% `thesis' driver, which also works well for us, and the `report' driver.
%
%    \begin{macrocode}
\renewbibmacro*{institution+location+date}{%
  \nopunct\printtext[publication]{%
    \printlist{location}%
    \iflistundef{institution}%
    {\setunit*{\addcomma\space}}%
    {\setunit*{\addcolon\space}}%
    \printlist{institution}%
    \setunit*{\addcomma\space}%
    \usebibmacro{date}%
  }%
}
%    \end{macrocode}
%
% We provide a slightly more complicated version with the type included
% at the beginning. It is used by the `thesis' driver. We provide two
% versions: one with the type outside and one with it inside the
% parentheses.
%
%    \begin{macrocode}
\newbibmacro*{type+institution+location+date}{%
  \printfield{type}%
  \newunit
  \usebibmacro{institution+location+date}%
}
\DeclareBibliographyOption{altthesis}[true]{%
  \renewbibmacro*{type+institution+location+date}{%
    \nopunct\printtext[publication]{%
      \printfield{type}%
      \setunit*{\addcomma\space}%
      \printlist{location}%
      \iflistundef{institution}%
      {\setunit*{\addcomma\space}}%
      {\setunit*{\addcolon\space}}%
      \printlist{institution}%
      \setunit*{\addcomma\space}%
      \usebibmacro{date}%
    }%
  }%
}
%    \end{macrocode}
%
% We provide an even more convoluted version that also includes `series',
% `title' and `number', and uses the more common `publisher' in place of
% `institution'. We also include some logic that means `organization'
% is used instead of `publisher' if no `publisher' is provided;
% otherwise it is printed before `location'. This is used by the
% `manual' driver.
%
%    \begin{macrocode}
\newbibmacro*{type+series+number+edition+organization+publisher+location+date}{%
  \nopunct\printtext[publication]{%
    \usebibmacro{series+type+number}%
    \setunit{\addsemicolon\space}%
    \printfield{edition}%
    \setunit*{\addcomma\space}%
    \iflistundef{publisher}%
    {}%
    {\printlist{organization}%
      \setunit*{\addcomma\space}}%
    \printlist{location}%
    \iflistundef{publisher}%
    {\iflistundef{organization}%
      {\setunit*{\addcomma\space}}%
      {\setunit*{\addcolon\space}%
        \printlist{organization}}}%
    {\setunit*{\addcolon\space}
      \printlist{publisher}}%
    \setunit*{\addcomma\space}%
    \usebibmacro{date}%
  }%
}
%    \end{macrocode}
%
% The changes to the `report' driver compared to the standard style
% are as follows:
% \begin{itemize}
%   \item
%   support is added for `volume', `maintitle' and `series';
%   \item
%   `type' and `number' are moved to just before the publication
%   information block';
%   \item
%   before `related', there is a full stop instead of a comma.
% \end{itemize}
%
%    \begin{macrocode}
\DeclareBibliographyDriver{report}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{maintitle+title}%
  \newunit
  \iffieldundef{maintitle}
  {\printfield{volume}%
    \printfield{part}}
  {}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \printfield{version}%
  \newunit\newblock
  \printfield{note}%
  \newunit\newblock
  \usebibmacro{series+type+number}%
  \setunit{\addspace}%
  \usebibmacro{institution+location+date}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit
  \printfield{pagetotal}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
  {\printfield{isrn}}
  {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
  \iftoggle{bbx:related}
  {\usebibmacro{related:init}%
    \usebibmacro{related}}
  {}%
  \usebibmacro{finentry}}
%    \end{macrocode}
%
% We patch the thesis driver to use our slightly more complex version.
%
%    \begin{macrocode}
\xpatchbibdriver{thesis}{%
  \printfield{type}%
  \newunit
  \usebibmacro{institution+location+date}%
}{%
  \usebibmacro{type+institution+location+date}%
}{}{}
%    \end{macrocode}
%
% The changes to the `manual' driver compared to the standard style
% are as follows:
% \begin{itemize}
%   \item
%   `type', `series', `number', `edition' and `organization' are moved
%   into the publication information block with `publisher', `location'
%   and `date';
%   \item
%   before `related', there is a full stop instead of a comma.
% \end{itemize}
%
%    \begin{macrocode}
\DeclareBibliographyDriver{manual}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/editor}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{title}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \usebibmacro{byeditor}%
  \newunit\newblock
  \printfield{type}%
  \newunit
  \printfield{version}%
  \newunit
  \printfield{note}%
  \newunit\newblock
  \usebibmacro{type+series+number+edition+organization+publisher+location+date}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit
  \printfield{pagetotal}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
  {\printfield{isbn}}
  {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
  \iftoggle{bbx:related}
  {\usebibmacro{related:init}%
    \usebibmacro{related}}
  {}%
  \usebibmacro{finentry}}
%    \end{macrocode}
%
% \subsection{Intrinsically online resources}
%
% The titles of web pages and similar intrinsically online resources
% are written in roman text within quotes.
%
%    \begin{macrocode}
\DeclareFieldFormat[online]{title}{\mkbibquote{#1\isdot}}
\DeclareFieldFormat[online]{citetitle}{\mkbibquote{#1\isdot}}
%    \end{macrocode}
%
% The `entrysubtype' field is wrapped in square brackets.
%
%    \begin{macrocode}
\DeclareFieldFormat[online]{entrysubtype}{\mkbibbrackets{#1}}
%    \end{macrocode}
%
% The changes to the `online' driver compared to the standard style
% are as follows:
% \begin{itemize}
%   \item
%   We support the use of `maintitle' for, say, the title of the wesbite
%   in which the web page is located. This comes after `title'.
%   \item
%   We support the use of `entrysubtype' to specify the nature of the
%   online resource (following the practice of 'biblatex-apa' and
%   others). This comes after `maintitle'.
%   \item
%   In most cases, the date is wrapped in parentheses if present.
%   With Twitter posts, the time and date are printed bare.
%   \item
%   We support displaying a publisher after the date.
%   \item
%   before `related', there is a full stop instead of a comma.
% \end{itemize}
%
%    \begin{macrocode}
\DeclareBibliographyDriver{online}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/editor+others/translator+others}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{title}%
  \newunit
  \usebibmacro{maintitle}
  \setunit{\addspace}\newblock
  \printfield{entrysubtype}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \usebibmacro{byeditor+others}%
  \newunit\newblock
  \printfield{version}%
  \newunit
  \printfield{note}%
  \newunit\newblock
  \printlist{organization}%
  \iffieldequalstr{entrysubtype}{Twitter post}{%
    \newunit\newblock
    \usebibmacro{time+date}%
  }{%
    \iffieldundef{year}{}{%
      \setunit{\addspace}\newblock
      \printtext[parens]{\usebibmacro{date}}%
    }%
  }
  \newunit\newblock
  \printlist{publisher}%
  \newunit\newblock
  \iftoggle{bbx:eprint}
  {\usebibmacro{eprint}}
  {}%
  \newunit\newblock
  \usebibmacro{url+urldate}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
  \iftoggle{bbx:related}
  {\usebibmacro{related:init}%
    \usebibmacro{related}}
  {}%
  \usebibmacro{finentry}}
%    \end{macrocode}
%
% We define a new macro for printing both time and date.
%
%    \begin{macrocode}
\newbibmacro*{time+date}{%
  \printtime
  \newunit
  \printdate
}
%    \end{macrocode}
%
% \subsection{Audiovisual resources}
%
% The publication block for audiovisual resources is quite different
% from the normal, as the `type', `series' and `number' come
% between the `publisher' and `date'. We do not use `location'.
% Specification of the medium goes at the start, which we implement
% using the `howpublished' field.
%
%    \begin{macrocode}
\newbibmacro*{publisher+type+series+number+date}{%
  \nopunct\printtext[publication]{%
    \printfield{howpublished}%
    \setunit*{\addcomma\space}%
    \printlist{publisher}%
    \setunit*{\addspace}%
    \printfield{type}%
    \setunit*{\addspace}%
    \printfield{series}%
    \setunit*{\addcomma\space}%
    \printfield{number}%
    \newunit%
    \usebibmacro{date}%
  }%
}
%    \end{macrocode}
%
% We provide a specialist `audio'/`music' driver. It is currently based
% closely on `book'; it could do with a more thoughtful implementation.
%
%    \begin{macrocode}
\DeclareBibliographyDriver{audio}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{maintitle+title}%
  \newunit
  \iffieldundef{maintitle}
  {\printfield{volume}%
    \printfield{part}}
  {}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \usebibmacro{byeditor+others}%
  \newunit\newblock
  \printfield{volumes}%
  \newunit\newblock
  \printfield{note}%
  \newunit\newblock%
  \usebibmacro{publisher+type+series+number+date}%
  \newunit\newblock
  \usebibmacro{chapter+pages}%
  \newunit
  \printfield{pagetotal}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
  {\printfield{isbn}}
  {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \setunit{\addperiod\addspace}\newblock
  \iftoggle{bbx:related}
  {\usebibmacro{related:init}%
    \usebibmacro{related}}
  {}%
  \usebibmacro{finentry}}

\DeclareBibliographyAlias{music}{audio}
%    \end{macrocode}
%
% \subsection{Related entries}
%
% \subsubsection{Reprints}
%
% We take advantage of the Biber-specific mechanism of relating items
% in order to handle reprints. The presence or otherwise of the
% `journaltitle' field is used to determine whether this is a reprint
% from a book (first block) or a periodical (second block).
%
%    \begin{macrocode}
\renewbibmacro*{related:reprintfrom}[1]{%
  \entrydata*{#1}{\unspace
    \iffieldundef{journaltitle}{%
      \iffieldundef{maintitle}
      {\printfield[title:hook]{booktitle}}
      {\printfield[title:hook]{maintitle}}%
      \newunit\newblock
      \usebibmacro{byeditor+others}%
      \newunit\newblock
      \iffieldundef{volume}{%
      }{%
        \printfield{volume}%
        \printfield{part}%
      }%
      \newunit\newblock
      \printfield{note}%
      \newunit\newblock
      \usebibmacro{series+number+edition+publisher+location+date}%
      \newunit\newblock
      \usebibmacro{chapter+pages}%
    }{%
      \usebibmacro{journal+issuetitle}%
      \newunit
      \usebibmacro{byeditor+others}%
      \iffieldundef{note}{%
        \newunit
      }{%
        \setunit{\addsemicolon\addspace}%
      }%
      \usebibmacro{note+pages}%
    }}}
%    \end{macrocode}
%
% \subsubsection{Reviews}
%
% We ensure that the field formatting for `review' entries matches that
% for `article' entries.
%
%    \begin{macrocode}
\DeclareFieldFormat[review]{title}{\mkbibquote{#1\isdot}}
\DeclareFieldFormat[review]{volume}{#1}% volume of a journal
\DeclareFieldFormat[review]{number}{#1}% number of a journal
\DeclareFieldFormat[review]{series}{% series of a journal
  \ifinteger{#1}
  {\mkbibordseries{#1}~\bibstring{jourser}}
  {\ifbibstring{#1}{\bibstring{#1}}{#1}}}
%    \end{macrocode}
%
% This macro provides a non-Biber method of inserting a formatted
% reference within a review reference. It is deprecated and will
% be removed in a future release.
%
%    \begin{macrocode}
\newbibmacro*{reviewof}{}
\DeclareBibliographyCategory{reviewed}
\DeclareEntryOption{reviewof}{%
  \renewbibmacro*{reviewof}{%
    \bibstring{reviewof}%
    \setunit{\addspace}%
    \printtext{{\settoggle{blx@bibliography}{false}\fullcite{#1}}}%
  }%
  \addtocategory{reviewed}{#1}%
}
%    \end{macrocode}
%
% We take advantage of the Biber-specific mechanism of relating items
% in order to handle reviews. Compared to the default code, this is
% simpler in that we don't check for repeated authors\slash editors (it
% would be a rather biased review!), we directly set the author format,
% and we don't convert \textsf{oxyear} format back to \textsf{oxnotes}.
%
%    \begin{macrocode}
\newbibmacro*{related:reviewof}[1]{%
  \entrydata*{#1}{%
    \usedriver{%
      \renewbibmacro*{related:init}{}%
      \DeclareNameAlias{author}{given-family}%
      \renewbibmacro*{pageref}{}%
    }{\thefield{entrytype}}%
  }%
}
%    \end{macrocode}
%
% Since a review is a special kind of journal article, the `review'
% driver is based on the `article' one, the difference being that the
% `related' macro comes just before `journal+issuetitle'. Oxford style
% links the two with \enquote{in}.
%
%    \begin{macrocode}
\DeclareBibliographyDriver{review}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/translator+others}%
  \setunit{\labelnamepunct}\newblock
  \usebibmacro{title}%
  \newunit
  \printlist{language}%
  \newunit\newblock
  \usebibmacro{byauthor}%
  \newunit\newblock
  \usebibmacro{bytranslator+others}%
  \newunit\newblock
  \printfield{version}%
  \newunit\newblock
  \usebibmacro{reviewof}%
  \newunit\newblock
  \iftoggle{bbx:related}{%
    \usebibmacro{related:init}%
    \usebibmacro{related}%
  }{}%
  \newunit\newblock
  \usebibmacro{in:}%
  \unspace
  \usebibmacro{journal+issuetitle}%
  \newunit
  \usebibmacro{byeditor+others}%
  \iffieldundef{note}%
    {\newunit}%
    {\setunit{\addsemicolon\addspace}}%
  \usebibmacro{note+pages}%
  \newunit\newblock
  \iftoggle{bbx:isbn}
    {\printfield{issn}}
    {}%
  \newunit\newblock
  \usebibmacro{doi+eprint+url}%
  \newunit\newblock
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \usebibmacro{finentry}}
%    \end{macrocode}
%
% \subsection{Sort order}
%
% We exclude editor and translator from the sort order for books,
% reference works, and proceedings, music, since they come after the
% title.
%
%    \begin{macrocode}
\DeclareSortExclusion{book,reference,mvreference,proceedings,music}{editor,translator}
%    \end{macrocode}
%
% \iffalse %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%</o>
%<*n>
% \fi %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% \section{Notes style: oxnotes.bbx}
%
% \setcounter{FancyVerbLine}{19}
%
% \subsection{Preliminaries}
%
% First we load the common \textsf{oxref} features.
%
%    \begin{macrocode}
\RequireBibliographyStyle{oxref}
%    \end{macrocode}
%
% We apply our special name format to names likely to appear at the start of
% an entry.
%
%    \begin{macrocode}
\DeclareNameAlias{author}{bib-family-given/cite-given-family}
\DeclareNameAlias[related:reviewof]{author}{given-family}
\DeclareNameAlias[book,booklet,collection,manual,misc,mvbook,mvcollection,%
  mvproceedings,mvreference,online,proceedings,reference]%
  {editor}{bib-family-given/cite-given-family}
%    \end{macrocode}
%
% \subsection{Source mappings}
%
% This is used by Biber to fix the following sorting issues:
% \begin{itemize}
%   \item
%   `proceedings' entries print the organization at the beginning.
%   \item
%   `proceedings' entries print the maintitle before the title.
% \end{itemize}
%
%    \begin{macrocode}
\DeclareStyleSourcemap{%
  \maps[datatype=bibtex]{%
    \map{%
      \pertype{proceedings}
      \step[fieldsource=organization]%
      \step[fieldset=sortname, origfieldval]%
      \step[fieldsource=maintitle]%
      \step[fieldset=sorttitle, origfieldval]%
      \step[fieldsource=volume]%
      \step[fieldset=sorttitle, append, origfieldval]%
    }%
  }%
}
%    \end{macrocode}
%
% \subsection{Page ranges in citations}
%
% If specifying a page within a range in the course of a citation note,
% Oxford style is to format that as \enquote{\emph{range} at
% \emph{page}}; if no page range is specified, the page is printed as
% normal.
%
%    \begin{macrocode}
\renewbibmacro*{postnote}{%
  \iffieldundef{postnote}{}{%
    \iffieldundef{pages}{%
      \setunit{\postnotedelim}%
      \printfield{postnote}%
    }{%
      \printtext{\addspace\bibstring{at}\space}%
      \printfield{postnote}}}}
%    \end{macrocode}
%
% \iffalse %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%</n>
%<*y>
% \fi %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% \section{Author–year style: oxyear.bbx}
%
% \setcounter{FancyVerbLine}{19}
%
% \subsection{Preliminaries}
%
% First we load the common \textsf{oxref} features.
%
%    \begin{macrocode}
\RequireBibliographyStyle{oxref}
%    \end{macrocode}
%
% Here we set some defaults different to the standard ones. The author
% can still override them.
%
%    \begin{macrocode}
\ExecuteBibliographyOptions{uniquename=init,giveninits,labeldateparts,sorting=nyt,pagetracker}
%    \end{macrocode}
%
% \subsection{Date merging option}
%
% We provide the `mergedate' option from the `authoryear' style. The
% OGS and NHR consistently use a variant that is between basic and
% compact, in that the year is always moved but the month and day are
% never moved; this is implemented as the `year' value. Note that we
% have the additional complication that `origdate' is also moved.
%
%    \begin{macrocode}
\DeclareBibliographyOption{mergedate}[true]{%
  \ifcsdef{bbx@opt@mergedate@#1}
    {\csuse{bbx@opt@mergedate@#1}}
    {\PackageError{biblatex}
       {Invalid option 'mergedate=#1'}
       {Valid values are 'maximum', 'compact', 'basic', 'minimum',\MessageBreak
        'year', 'true' (=year), and 'false'.}}}
%    \end{macrocode}
%
% The various values affect the definition of the following macro.
%
%    \begin{macrocode}
\providebibmacro*{date+extrayear}{}
%    \end{macrocode}
%
% Here we provide the various possible definitions. Note that, unlike in
% `authoryear', we need to ensure the `issue+date' macro prints the `eid'
% field as well.
%
% \begin{itemize}
%   \item `true' is the same as `year' (see below).
% \end{itemize}
%
%    \begin{macrocode}
\def\bbx@opt@mergedate@true{\bbx@opt@mergedate@year}
%    \end{macrocode}
%
% \begin{itemize}
%   \item `maximum' merges date/issue with date label. Note that we
%   clear fields rather than the bibmacros as the `authoryear' style does.
% \end{itemize}
%
%    \begin{macrocode}
\def\bbx@opt@mergedate@maximum{%
  \renewbibmacro*{date+extrayear}{%
    \iffieldundef{labelyear}
      {}
      {\printtext[parens]{%
         \printfield{issue}%
         \setunit*{\addspace}%
         \iffieldsequal{year}{labelyear}
           {\printdateextralabel}%
           {\printfield{labelyear}%
            \printfield{extrayear}}}%
       \clearfield{year}\clearfield{endyear}%
       \clearfield{month}\clearfield{endmonth}%
       \clearfield{day}\clearfield{endday}%
       \clearfield{issue}}}}%
%    \end{macrocode}
%
% \begin{itemize}
%   \item `compact' merges whole date with date label. Note that we
%   clear fields rather than the bibmacros as the `authoryear' style does.
% \end{itemize}
%
%    \begin{macrocode}
\def\bbx@opt@mergedate@compact{%
  \renewbibmacro*{date+extrayear}{%
    \iffieldundef{labelyear}
      {}
      {\printtext[parens]{%
         \iffieldsequal{year}{labelyear}
           {\printdateextralabel}%
           {\printfield{labelyear}%
            \printfield{extrayear}}}%
       \clearfield{year}\clearfield{endyear}%
       \clearfield{month}\clearfield{endmonth}%
       \clearfield{day}\clearfield{endday}}}%
  \renewbibmacro*{issue+date}{%
    \iffieldundef{issue}
      {}
      {\ifboolexpr{(
          test {\iffieldundef{volume}}
          and
          test {\iffieldundef{number}}
          ) and
          test {\iffieldundef{eid}}
        }{%
          \newunit
          \printfield{issue}%
        }{%
          \printtext[parens]{\printfield{issue}}%
        }}%
    \newunit
    \printfield{eid}}}
%    \end{macrocode}
%
% \begin{itemize}
%   \item `basic' merges year-only date with date label.
% \end{itemize}
%
%    \begin{macrocode}
\def\bbx@opt@mergedate@basic{%
  \renewbibmacro*{date+extrayear}{%
    \iffieldundef{labelyear}
      {}
      {\printtext[parens]{%
         \printfield{labelyear}%
         \printfield{extrayear}}}}%
  \renewbibmacro*{date}{%
    \iffieldundef{month}
      {}
      {\printdate}}%
  \renewbibmacro*{issue+date}{%
    \ifboolexpr{
      test {\iffieldundef{issue}}
      and
      test {\iffieldundef{month}}
    }
    {}
    {\ifboolexpr{(
        test {\iffieldundef{volume}}
        and
        test {\iffieldundef{number}}
        ) and
        test {\iffieldundef{eid}}
      }{%
        \newunit
        \printfield{issue}%
        \setunit*{\addspace}%
        \printdate
      }{%
        \printtext[parens]{%
          \printfield{issue}%
          \setunit*{\addspace}%
          \printdate}%
      }}%
    \newunit
    \printfield{eid}}}
%    \end{macrocode}
%
% \begin{itemize}
%   \item `year' merges only the year with date label.
%   In `date+extrayear' we have to take a bit of trouble
%   to clear the right date.
% \end{itemize}
%
%    \begin{macrocode}
\def\bbx@opt@mergedate@year{%
  \renewbibmacro*{date+extrayear}{%
    \iffieldundef{labelyear}{}{%
      \printtext[parens]{%
        \printfield{labelyear}%
        \iffieldundef{labelendyear}{}{%
          \iffieldsequal{labelyear}{labelendyear}{}{%
            \iffieldequalstr{labelendyear}{}{%
              \mbox{\bibdaterangesep}%
            }{%
              \bibdaterangesep
              \blx@ox@compyear
                {\thefield{labelyear}}%
                {\thefield{labelendyear}}}}}%
        \printfield{extrayear}}%
      \iffieldundef{\thefield{labeldatesource}year}{%
        \iffieldundef{\thefield{labeldatesource}}{}{%
          \clearfield{\thefield{labeldatesource}}%
        }%
      }{%
        \clearfield{\thefield{labeldatesource}year}%
        \clearfield{end\thefield{labeldatesource}year}%
      }%
    }%
  }%
  \renewbibmacro*{issue+date}{%
    \ifboolexpr{
      test {\iffieldundef{issue}}
      and
      test {\iffieldundef{month}}
    }
    {}
    {\ifboolexpr{(
        test {\iffieldundef{volume}}
        and
        test {\iffieldundef{number}}
        ) and
        test {\iffieldundef{eid}}
      }{%
        \newunit
        \printfield{issue}%
        \setunit*{\addspace}%
        \printdate
      }{%
        \printtext[parens]{%
          \printfield{issue}%
          \setunit*{\addspace}%
          \printdate}%
      }}%
    \newunit
    \printfield{eid}}}
%    \end{macrocode}
%
% \begin{itemize}
%   \item `minimum' merges year-only date with year-only date label.
% \end{itemize}
%
%    \begin{macrocode}
\def\bbx@opt@mergedate@minimum{%
  \renewbibmacro*{date+extrayear}{%
    \iffieldundef{labelyear}
      {}
      {\printtext[parens]{%
         \printfield{labelyear}%
         \printfield{extrayear}}}}%
  \renewbibmacro*{date}{%
    \ifboolexpr{
      test {\iffieldundef{month}}
      and
      test {\iffieldundef{extrayear}}
    }
      {}
      {\printdate}}%
  \renewbibmacro*{issue+date}{%
    \ifboolexpr{
      test {\iffieldundef{issue}}
      and
      test {\iffieldundef{month}}
      and
      test {\iffieldundef{extrayear}}
    }
    {}
    {\ifboolexpr{(
        test {\iffieldundef{volume}}
        and
        test {\iffieldundef{number}}
        ) and
        test {\iffieldundef{eid}}
      }{%
        \newunit
        \printfield{issue}%
        \setunit*{\addspace}%
        \printdate
      }{%
        \printtext[parens]{%
          \printfield{issue}%
          \setunit*{\addspace}%
          \printdate}%
      }}%
    \newunit
    \printfield{eid}}}
%    \end{macrocode}
%
% \begin{itemize}
%   \item `false' suppresses any merging).
% \end{itemize}
%
%    \begin{macrocode}
\def\bbx@opt@mergedate@false{%
  \renewbibmacro*{date+extrayear}{%
    \iffieldundef{labelyear}
      {}
      {\printtext[parens]{%
         \printfield{labelyear}%
         \printfield{extrayear}}}}%
  \renewbibmacro*{date}{\printdate}%
  \renewbibmacro*{issue+date}{%
    \ifboolexpr{(
      test {\iffieldundef{volume}}
      and
      test {\iffieldundef{number}}
      ) and
      test {\iffieldundef{eid}}
    }{%
      \newunit\printtext{%
        \iffieldundef{issue}{%
          \usebibmacro{date}
        }{%
          \printfield{issue}%
          \setunit*{\addspace}%
          \usebibmacro{date}%
        }%
      }%
    }{%
      \ifboolexpr{
        test {\iffieldundef{issue}}
        and (
        test {\iffieldundef{year}}
        and
        test {\iffieldundef{month}}
        )
      }{}{%
        \printtext[parens]{%
          \iffieldundef{issue}{%
            \usebibmacro{date}%
          }{%
            \printfield{issue}%
            \setunit*{\addspace}%
            \usebibmacro{date}%
          }%
        }%
      }%
    }%
  \newunit
  \printfield{eid}}}
%    \end{macrocode}
%
% We set the default to be `true'/`year'.
%
%    \begin{macrocode}
\ExecuteBibliographyOptions{mergedate}
%    \end{macrocode}
%
% The above clearfield commands would suppress any further date
% information being printed, but we need to allow months and days to be
% printed in the absence of a year. This means adapting the range
% calculation commands defined in `biblatex.sty' for use by
% \cs{printdate} and friends.
%
%    \begin{macrocode}
\DeclareRobustCommand*{\mkdaterangefull}[2]{%
  \blx@metadateinfo{#2}%
  \iffieldundef{#2year}{%
    \iffieldundef{#2month}{}{%
      \datecircaprint
      \printtext[#2date]{%
      \iffieldundef{#2season}{%
        \csuse{mkbibdate#1}{}{#2month}{#2day}%
        \blx@printtime{#2}{}%
      }{%
        \csuse{mkbibseasondate#1}{}{#2season}}%
      \dateuncertainprint
      \iffieldundef{#2endmonth}{}{%
        \iffieldequalstr{#2endmonth}{}{%
          \mbox{\bibdaterangesep}%
        }{%
          \bibdaterangesep
          \enddatecircaprint
          \iffieldundef{#2season}{%
            \csuse{mkbibdate#1}{}{#2endmonth}{#2endday}%
            \blx@printtime{#2}{end}%
          }{%
            \csuse{mkbibseasondate#1}{}{#2endseason}}%
          \enddateuncertainprint}}}}%
  }{%
    \datecircaprint
    \printtext[#2date]{%
      \iffieldundef{#2season}{%
        \csuse{mkbibdate#1}{#2year}{#2month}{#2day}%
        \blx@printtime{#2}{}%
      }{%
        \csuse{mkbibseasondate#1}{#2year}{#2season}}%
      \dateuncertainprint
      \dateeraprint{#2year}%
      \iffieldundef{#2endyear}{}{%
        \iffieldequalstr{#2endyear}{}{%
          \mbox{\bibdaterangesep}%
        }{%
          \bibdaterangesep
          \enddatecircaprint
          \iffieldundef{#2season}{%
            \csuse{mkbibdate#1}{#2endyear}{#2endmonth}{#2endday}%
            \blx@printtime{#2}{end}%
          }{%
            \csuse{mkbibseasondate#1}{#2endyear}{#2endseason}}%
          \enddateuncertainprint
          \dateeraprint{#2endyear}}}}}}

%    \end{macrocode}
%
% There is a potential problem for the code below, in that if the year
% and endyear are missing, it cannot tell if they are the same, so if
% the months are the same but the years are different, the range will
% be erroneously compressed.
%
%    \begin{macrocode}
\DeclareRobustCommand*{\mkdaterangetrunc}[2]{%
  \blx@metadateinfo{#2}%
  \iffieldundef{#2year}{%
    \iffieldundef{#2month}{}{%
      \datecircaprint
      \printtext[#2date]{%
        \iffieldundef{#2season}{%
          \iffieldsequal{#2month}{#2endmonth}{%
            \csuse{mkbibdate#1}{}{}{#2day}%
          }{%
            \csuse{mkbibdate#1}{}{#2month}{#2day}}%
        }{%
          \csuse{mkbibseasondate#1}{}{#2season}}%
        \dateuncertainprint
        \iffieldundef{#2endmonth}{}{%
          \iffieldequalstr{#2endmonth}{}{%
            \mbox{\bibdaterangesep}%
          }{%
            \bibdaterangesep
            \enddatecircaprint
            \iffieldundef{#2season}{%
              \csuse{mkbibdate#1}{}{#2endmonth}{#2endday}%
            }{%
              \csuse{mkbibseasondate#1}{}{#2endseason}}%
            \enddateuncertainprint}}}}%
  }{%
    \datecircaprint
    \printtext[#2date]{%
      \iffieldundef{#2season}{%
        \iffieldsequal{#2year}{#2endyear}{%
          \iffieldsequal{#2month}{#2endmonth}{%
            \csuse{mkbibdate#1}{}{}{#2day}%
          }{%
            \csuse{mkbibdate#1}{}{#2month}{#2day}}%
        }{%
          \csuse{mkbibdate#1}{#2year}{#2month}{#2day}%
          \iffieldsequal{#2dateera}{#2enddateera}{}{%
            \dateeraprint{#2year}}}%
      }{%
        \iffieldsequal{#2year}{#2endyear}{%
          \csuse{mkbibseasondate#1}{}{#2season}%
        }{%
          \csuse{mkbibseasondate#1}{#2year}{#2season}%
          \iffieldsequal{#2dateera}{#2enddateera}{}{%
            \dateeraprint{#2year}}}}%
      \dateuncertainprint
      \iffieldundef{#2endyear}{}{%
        \iffieldequalstr{#2endyear}{}{%
          \mbox{\bibdaterangesep}%
        }{%
          \bibdaterangesep
          \enddatecircaprint
          \iffieldundef{#2season}{%
            \iffieldundef{#2endmonth}{%
              \blx@ox@compyear{\thefield{#2year}}{\thefield{#2endyear}}%
            }{%
              \csuse{mkbibdate#1}{#2endyear}{#2endmonth}{#2endday}}%
          }{%
            \csuse{mkbibseasondate#1}{#2endyear}{#2endseason}}%
          \enddateuncertainprint
          \dateeraprint{#2endyear}}}}}}

%    \end{macrocode}
%
% The `extra' commands, which print disambiguating labels, should only
% print those labels if the year is present, so the first conditional
% block is the same as for the non-`extra' commands above.
%
%    \begin{macrocode}
\DeclareRobustCommand*{\mkdaterangefullextra}[2]{%
  \blx@metadateinfo{#2}%
  \iffieldundef{#2year}{%
    \iffieldundef{#2month}{}{%
      \datecircaprint
      \printtext[#2date]{%
      \iffieldundef{#2season}{%
        \csuse{mkbibdate#1}{}{#2month}{#2day}%
        \blx@printtime{#2}{}%
      }{%
        \csuse{mkbibseasondate#1}{}{#2season}}%
      \dateuncertainprint
      \iffieldundef{#2endmonth}{}{%
        \iffieldequalstr{#2endmonth}{}{%
          \mbox{\bibdaterangesep}%
        }{%
          \bibdaterangesep
          \enddatecircaprint
          \iffieldundef{#2season}{%
            \csuse{mkbibdate#1}{}{#2endmonth}{#2endday}%
            \blx@printtime{#2}{end}%
          }{%
            \csuse{mkbibseasondate#1}{}{#2endseason}}%
          \enddateuncertainprint}}}}%
  }{%
    \datecircaprint
    \printtext[#2date]{%
      \printtext{%
        \iffieldundef{#2season}{%
          \csuse{mkbibdate#1}{#2year}{#2month}{#2day}%
          \blx@printtime{#2}{}%
        }{%
          \csuse{mkbibseasondate#1}{#2year}{#2season}}%
      \dateuncertainprint
      \dateeraprint{#2year}%
      \iffieldundef{#2endyear}{%
        \printfield{extrayear}%
      }{%
        \iffieldequalstr{#2endyear}{}{%
          \printfield{extrayear}%
          \printtext{\mbox{\bibdaterangesep}}%
        }{%
          \printtext{%
            \bibdaterangesep
            \enddatecircaprint
            \iffieldundef{#2season}{%
              \csuse{mkbibdate#1}{#2endyear}{#2endmonth}{#2endday}%
              \blx@printtime{#2}{end}%
            }{%
              \csuse{mkbibseasondate#1}{#2endyear}{#2endseason}}}%
          \printfield{extrayear}%
          \enddateuncertainprint
          \dateeraprint{#2endyear}}}}}}}

\DeclareRobustCommand*{\mkdaterangetruncextra}[2]{%
  \blx@metadateinfo{#2}%
  \iffieldundef{#2year}{%
    \iffieldundef{#2month}{}{%
      \datecircaprint
      \printtext[#2date]{%
        \iffieldundef{#2season}{%
          \iffieldsequal{#2month}{#2endmonth}{%
            \csuse{mkbibdate#1}{}{}{#2day}%
          }{%
            \csuse{mkbibdate#1}{}{#2month}{#2day}}%
        }{%
          \csuse{mkbibseasondate#1}{}{#2season}}%
        \dateuncertainprint
        \iffieldundef{#2endmonth}{}{%
          \iffieldequalstr{#2endmonth}{}{%
            \mbox{\bibdaterangesep}%
          }{%
            \bibdaterangesep
            \enddatecircaprint
            \iffieldundef{#2season}{%
              \csuse{mkbibdate#1}{}{#2endmonth}{#2endday}%
            }{%
              \csuse{mkbibseasondate#1}{}{#2endseason}}%
            \enddateuncertainprint}}}}%
  }{%
    \datecircaprint
    \printtext[#2date]{%
      \iffieldundef{#2season}{%
        \iffieldsequal{#2year}{#2endyear}{%
          \iffieldsequal{#2month}{#2endmonth}{%
            \csuse{mkbibdate#1}{}{}{#2day}%
          }{%
            \csuse{mkbibdate#1}{}{#2month}{#2day}}%
        }{%
          \csuse{mkbibdate#1}{#2year}{#2month}{#2day}%
          \iffieldsequal{#2dateera}{#2enddateera}{}{%
            \dateeraprint{#2year}}}%
      }{%
        \iffieldsequal{#2year}{#2endyear}{%
          \csuse{mkbibseasondate#1}{}{#2season}%
        }{%
          \csuse{mkbibseasondate#1}{#2year}{#2season}
          \iffieldsequal{#2dateera}{#2enddateera}{}{%
            \dateeraprint{#2year}}}}%
      \dateuncertainprint
      \iffieldundef{#2endyear}{%
        \printfield{extrayear}%
      }{%
        \iffieldequalstr{#2endyear}{}{%
          \printfield{extrayear}%
          \printtext{\mbox{\bibdaterangesep}}%
        }{%
          \printtext{%
            \bibdaterangesep
            \enddatecircaprint
            \iffieldundef{#2season}{%
              \iffieldundef{#2endmonth}{%
                \blx@ox@compyear{\thefield{#2year}}{\thefield{#2endyear}}%
              }{%
                \csuse{mkbibdate#1}{#2endyear}{#2endmonth}{#2endday}}%
            }{%
              \csuse{mkbibseasondate#1}{#2endyear}{#2endseason}}}%
          \printfield{extrayear}%
          \enddateuncertainprint
          \dateeraprint{#2endyear}}}}}}

%    \end{macrocode}
%
% The `labelyear' falls back to `pubstate' if provided.
%
%    \begin{macrocode}
\DeclareLabeldate{%
  \field{origdate}
  \field{date}
  \field{year}
  \field{eventdate}
  \field{pubstate}
  \field{urldate}
  \literal{nodate}
}

%    \end{macrocode}
%
% \subsection{Bibliography formatting}
%
% We let \pkg{biblatex} measure shorthands so we can use
% \cs{shorthandwidth} later.
%
%    \begin{macrocode}
\DeclareFieldFormat{shorthandwidth}{#1}
%    \end{macrocode}
%
% We declare a variant of the `family-given' name format which exports the hash
% of the name, so we can compare `shortauthor' with `author' and `shorteditor'
% with `editor'.
%
%    \begin{macrocode}
\DeclareNameFormat{family-given-hash}{%
  \ifgiveninits{%
    \usebibmacro{name:family-given}%
      {\namepartfamily}%
      {\namepartgiveni}%
      {\namepartprefix}%
      {\namepartsuffix}%
  }{%
    \usebibmacro{name:family-given}%
      {\namepartfamily}%
      {\namepartgiven}%
      {\namepartprefix}%
      {\namepartsuffix}%
  }%
  \ifboolexpr{
    test {\ifcurrentname{shortauthor}}
    or
    test {\ifcurrentname{shorteditor}}
  }{%
    \savefield{hash}{\bbx@ox@firsthash}%
  }{%
    \savefield{hash}{\bbx@ox@secondhash}%
  }%
  \usebibmacro{name:andothers}%
}
\DeclareNameAlias{shortauthor}{family-given-hash}
\DeclareNameAlias{shorteditor}{family-given-hash}
%    \end{macrocode}
%
% Names at the head of the reference are family-given, but names elsewhere
% are given-family.
%
%    \begin{macrocode}
\DeclareNameAlias{sortname}{family-given}
\DeclareNameAlias{author}{family-given}
\DeclareNameAlias{editor}{family-given}
\DeclareNameAlias{translator}{family-given}
%    \end{macrocode}
%
% The bibliography formatting is just like `authoryear' except we do not
% eliminate item separation by default.
%
%    \begin{macrocode}
\defbibenvironment{bibliography}
  {\list
     {}
     {\setlength{\leftmargin}{\bibhang}%
      \setlength{\itemindent}{-\leftmargin}%
      \setlength{\itemsep}{\bibitemsep}%
      \setlength{\parsep}{\bibparsep}}}
  {\endlist}
  {\item}
%    \end{macrocode}
%
% The shorthand formatting is just like `authoryear'.
%
%    \begin{macrocode}
\defbibenvironment{shorthand}
  {\list
     {\printfield[shorthandwidth]{shorthand}}
     {\setlength{\labelwidth}{\shorthandwidth}%
      \setlength{\leftmargin}{\labelwidth}%
      \setlength{\labelsep}{\biblabelsep}%
      \addtolength{\leftmargin}{\labelsep}%
      \setlength{\itemsep}{\bibitemsep}%
      \setlength{\parsep}{\bibparsep}%
      \renewcommand*{\makelabel}[1]{##1\hss}}}
  {\endlist}
  {\item}
%    \end{macrocode}
%
% \subsection{Name and date formatting}
%
% We set up hashing just as in `authoryear'.
%
%    \begin{macrocode}
\InitializeBibliographyStyle{\global\undef\bbx@lasthash}
%    \end{macrocode}
%
% We ensure related entries do not interfere with the hashing.
%
%    \begin{macrocode}
\renewbibmacro*{begrelated}{%
  \booltrue{bbx@inset}}
\renewbibmacro*{endrelated}{%
  \usebibmacro*{bbx:savehash}}
%    \end{macrocode}
%
% We patch the `author' macro so that the date label information appears
% at the end (as in `authoryear').
%
%    \begin{macrocode}
\xpatchbibmacro{author}{%
  \global\undef\bbx@lasthash
}{%
  \global\undef\bbx@lasthash
  \usebibmacro{labeltitle}%
  \setunit*{\addspace}%
}{}{}%
\xapptobibmacro{author}{%
  \usebibmacro{date+extrayear}%
}{}{}%
%    \end{macrocode}
%
% We patch it further so that, where an author name has a corresponding
% (different) short author name, the short name is given first and the long
% name given in parentheses.
%
% This technique uses saveboxes to extract the hashes.
%
% An unfortunate side effect of this is that where short author names are
% provided, the author list is no longer truncated, but I hope this represents
% something of an edge case.
%
%    \begin{macrocode}
\newcounter{namepairs}
\newsavebox{\bbx@ox@shortnamebox}
\newsavebox{\bbx@ox@namebox}
\xpatchbibmacro{author}{%
  {\printnames{author}}\iffieldundef%
}{{%
  \ifboolexpr{%
    ( not test {\ifnameundef{shortauthor}} )
    and
    test {\ifnumequal{\value{shortauthor}}{\value{author}}}
  }{%
    \setcounter{namepairs}{0}%
    \savebibmacro{name:andothers}%
    \renewbibmacro*{name:andothers}{}%
    \whileboolexpr{%
      test {\ifnumcomp{\value{namepairs}}{<}{\value{author}}}
    }{%
      \stepcounter{namepairs}%
      \ifnumcomp{\value{namepairs}}{>}{1}{%
        \ifnumequal{\value{author}}{2}{%
          \setunit*{\addspace\bibstring{and}\addspace}%
        }{%
          \ifnumequal{\value{namepairs}}{\value{author}}{%
            \setunit*{\addcomma\space\bibstring{and}\addspace}%
          }{%
            \setunit*{\addcomma\space}%
          }%
        }%
      }{}%
      \savebox{\bbx@ox@shortnamebox}{%
        \printnames[family-given-hash][\value{namepairs}-\value{namepairs}]{shortauthor}%
      }%
      \savebox{\bbx@ox@namebox}{%
        \printnames[family-given-hash][\value{namepairs}-\value{namepairs}]{author}%
      }%
      \ifdefstrequal{\bbx@ox@firsthash}{\bbx@ox@secondhash}{%
        \unhbox\bbx@ox@namebox
      }{%
        \unhbox\bbx@ox@shortnamebox
        \addspace\mkbibparens{\unhbox\bbx@ox@namebox}%
      }%
    }%
    \restorebibmacro{name:andothers}%
  }{%
    \printnames{author}%
  }}\iffieldundef%
}{}{}%
%    \end{macrocode}
%
% We apply the same patches to `bbx:editor', but also move the editor
% string to after the date label.
%
%    \begin{macrocode}
\xpatchbibmacro{bbx:editor}{%
  \usebibmacro{#1}%
}{%
  \usebibmacro{date+extrayear}%
  \setunit*{\addspace}%
  \usebibmacro{#1}%
}{}{}%
\xpatchbibmacro{bbx:editor}{%
  \global\undef\bbx@lasthash
}{%
  \global\undef\bbx@lasthash
  \usebibmacro{labeltitle}%
  \setunit*{\addspace}%
}{}{}%
\xpatchbibmacro{bbx:editor}{%
  \printnames{editor}%
}{%
  \ifboolexpr{%
    ( not test {\ifnameundef{shorteditor}} )
    and
    test {\ifnumequal{\value{shorteditor}}{\value{editor}}}
  }{%
    \setcounter{namepairs}{0}%
    \savebibmacro{name:andothers}%
    \renewbibmacro*{name:andothers}{}%
    \whileboolexpr{%
      test {\ifnumcomp{\value{namepairs}}{<}{\value{editor}}}
    }{%
      \stepcounter{namepairs}%
      \ifnumcomp{\value{namepairs}}{>}{1}{%
        \ifnumequal{\value{editor}}{2}{%
          \setunit*{\addspace\bibstring{and}\addspace}%
        }{%
          \ifnumequal{\value{namepairs}}{\value{editor}}{%
            \setunit*{\addcomma\space\bibstring{and}\addspace}%
          }{%
            \setunit*{\addcomma\space}%
          }%
        }%
      }{}%
      \savebox{\bbx@ox@shortnamebox}{%
        \printnames[family-given-hash][\value{namepairs}-\value{namepairs}]{shorteditor}%
      }%
      \savebox{\bbx@ox@namebox}{%
        \printnames[family-given-hash][\value{namepairs}-\value{namepairs}]{editor}%
      }%
      \ifdefstrequal{\bbx@ox@firsthash}{\bbx@ox@secondhash}{%
        \unhbox\bbx@ox@namebox
      }{%
        \unhbox\bbx@ox@shortnamebox
        \addspace\mkbibparens{\unhbox\bbx@ox@namebox}%
      }%
    }%
    \restorebibmacro{name:andothers}%
  }{%
    \printnames{editor}%
  }%
}{}{}%
%    \end{macrocode}
%
% We apply the same patches to `bbx:translator' as we do for
% `bbx:editor', except for the shortening one.
%
%    \begin{macrocode}
\xpatchbibmacro{bbx:translator}{%
  \global\undef\bbx@lasthash
}{%
\global\undef\bbx@lasthash
\usebibmacro{labeltitle}%
\setunit*{\addspace}%
}{}{}%
\xpatchbibmacro{bbx:translator}{%
  \usebibmacro{#1}%
}{}{}{}%
\xapptobibmacro{bbx:translator}{%
  \usebibmacro{date+extrayear}%
  \setunit*{\addspace}%
  \usebibmacro{#1}%
}{}{}%
%    \end{macrocode}
%
% The `labeltitle' macro differs from the one from `authoryear' in that
% it also includes the subtitle.
%
%    \begin{macrocode}
\newbibmacro*{labeltitle}{%
  \iffieldundef{label}{%
    \iffieldundef{shorttitle}{%
      \ifboolexpr{
        test {\iffieldundef{title}}
        and
        test {\iffieldundef{subtitle}}
      }{}{%
        \printtext[title]{%
          \printfield[titlecase]{title}%
          \setunit{\subtitlepunct}%
          \printfield[titlecase]{subtitle}}%
        \clearfield{title}%
        \clearfield{subtitle}%
        \setunit{\addspace}%
      }%
    }{%
      \printtext[title]{\printfield[titlecase]{shorttitle}}%
    }%
  }{%
    \printfield{label}%
  }%
}
%    \end{macrocode}
%
% The date of `online' entries is printed in parentheses; as the year
% is moved after the author, this can lead to empty parentheses unless
% a month is printed, so we change the test accordingly.
%
%    \begin{macrocode}
\xpatchbibdriver{online}{%
  \iffieldundef{year}{}{%
    \printtext[parens]{\usebibmacro{date}}%
  }%
}{%
  \iffieldundef{month}{}{%
    \printtext[parens]{\usebibmacro{date}}%
  }%
}{}{}
%    \end{macrocode}
%
% \subsection{Journal division formatting}
%
% \textsf{Oxyear} uses a colon to demarcate page numbers in journal articles.
%
%    \begin{macrocode}
\renewcommand*{\bibpagespunct}{%
  \ifboolexpr{
    test {\ifentrytype{article}}
    or
    test {\ifentrytype{suppperiodical}}
    or
    test {\ifentrytype{review}}
  }{%
    \addcolon\space
  }{%
    \addcomma\space
  }%
}
%    \end{macrocode}
%
% \subsection{Source mappings}
%
% This is used by Biber to fix the following sorting issues:
% \begin{itemize}
%   \item
%   `proceedings' entries print the organization at the beginning.
%   \item
%   `proceedings' entries print the maintitle before the title.
% \end{itemize}
%
%    \begin{macrocode}
\DeclareStyleSourcemap{%
  \maps[datatype=bibtex]{%
    \map{%
      \pertype{proceedings}
      \step[fieldsource=organization]%
      \step[fieldset=sortname, origfieldval]%
      \step[fieldsource=maintitle]%
      \step[fieldset=sorttitle, origfieldval]%
      \step[fieldsource=volume]%
      \step[fieldset=sorttitle, append, origfieldval]%
    }%
  }%
}
%    \end{macrocode}
%
% \iffalse %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%</y>
%</bbx>
%<*cbx>
% \fi %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% \chapter{Citation styles}
%
% \iffalse %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%<*n>
% \fi %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% \section{Notes style: oxnotes.cbx}
%
% \setcounter{FancyVerbLine}{19}
%
%    \begin{macrocode}
\RequireCitationStyle{verbose}
%    \end{macrocode}
%
% \iffalse %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%</n>
%<*y>
% \fi %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% \section{Author–year style: oxyear.cbx}
%
% \setcounter{FancyVerbLine}{19}
%
%    \begin{macrocode}
\RequireCitationStyle{authoryear}
%    \end{macrocode}
%
% \iffalse %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%</y>
%</cbx>
%<*lbx>
% \fi %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% \chapter{Localization modules}
%
% \iffalse %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%<*gb>
% \fi %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% \section{British English: british-oxref.lbx}
%
% \setcounter{FancyVerbLine}{19}
%
%    \begin{macrocode}
\InheritBibliographyExtras{british}
\DeclareBibliographyExtras{%
  \protected\def\mkbibdatelong#1#2#3{%
    \iffieldundef{#3}
      {}
      {\stripzeros{\thefield{#3}}%
       \iffieldundef{#2}{}{\nobreakspace}}%
    \iffieldundef{#2}
      {}
      {\mkbibmonth{\thefield{#2}}%
       \iffieldundef{#1}{}{\space}}%
    \stripzeros{\thefield{#1}}}%
  \def\finalandcomma{\addcomma}%
  \def\bibtimesep{\addperiod}%
}
\DeclareBibliographyStrings{%
  inherit          = {british},
%    \end{macrocode}
%
% These are new strings defined by \textsf{oxref}.
%
%    \begin{macrocode}
  at               = {{at}{at}},
  under            = {{s.v.}{s.v.}},
  facsimile        = {{facsimile edition}{facs\adddotspace edn\adddot}},
  revised          = {{revised edition}{rev\adddotspace edn\adddot}},
  suppto           = {{supplement to}{supplement to}},
  equals           = {{=}{=}},
  byperformer      = {{}{}},
  bydirector       = {{directed by}{dir\adddot}},
  byreader         = {{read by}{read by}},
%    \end{macrocode}
%
% These are standard strings, some of which are redefined by \textsf{oxref}.
%
%    \begin{macrocode}
  introduction     = {{introduction}{introduction}},
  withintroduction = {{with an introduction by}{with an introduction by}},
  byeditor         = {{edited by}{ed\adddot}},
  bycompiler       = {{compiled by}{comp\adddot}},
  byredactor       = {{redacted by}{red\adddot}},
  byfounder        = {{founded by}{found\adddot}},
  bycontinuator    = {{continued by}{cont\adddot}},
  bycollaborator   = {{in collaboration with}{in collab\adddotspace with}},
  bytranslator     = {{translated \lbx@lfromlang\ by}{trans\adddot\ \lbx@sfromlang}},
  bycommentator    = {{commented by}{comm\adddot}},
  byannotator      = {{annotated by}{annot\adddot}},
  withcommentator  = {{with a commentary by}{with a commentary by}},
  withannotator    = {{with annotations by}{with annotations by}},
  withintroduction = {{with an introduction by}{with an introduction by}},
  withforeword     = {{with a foreword by}{with a foreword by}},
  withafterword    = {{with an afterword by}{with an afterword by}},
  byeditortr       = {{edited and translated \lbx@lfromlang\ by}%
                      {ed\adddotspace and trans\adddot\ \lbx@sfromlang}},
  byeditorco       = {{edited and commented by}%
                      {ed\adddotspace and comm\adddot}},
  byeditoran       = {{edited and annotated by}%
                      {ed\adddotspace and annot\adddot}},
  byeditorin       = {{edited, with an introduction, by}%
                      {ed.\adddotspace with introduction}},
  byeditorfo       = {{edited, with a foreword, by}%
                      {ed.\adddotspace with foreword}},
  byeditoraf       = {{edited, with an afterword, by}%
                      {ed.\adddotspace with afterword}},
  byeditortrco     = {{edited, translated \lbx@lfromlang\finalandcomma\ and commented by}%
                      {ed.,\addabbrvspace trans\adddot\ \lbx@sfromlang\finalandcomma\ and comm\adddot}},
  byeditortran     = {{edited, translated \lbx@lfromlang\finalandcomma\ and annotated by}%
                      {ed.,\addabbrvspace trans\adddot\ \lbx@sfromlang\finalandcomma\ and annot\adddot}},
  byeditortrin     = {{edited and translated \lbx@lfromlang, with an introduction, by}%
                      {ed\adddotspace and trans\adddot\ \lbx@sfromlang\ with introduction}},
  byeditortrfo     = {{edited and translated \lbx@lfromlang, with a foreword, by}%
                      {ed\adddotspace and trans\adddot\ \lbx@sfromlang\ with foreword}},
  byeditortraf     = {{edited and translated \lbx@lfromlang, with an afterword, by}%
                      {ed\adddotspace and trans\adddot\ \lbx@sfromlang\ with afterword}},
  byeditorcoin     = {{edited and commented, with an introduction, by}%
                      {ed\adddotspace and comm\adddotspace with introduction}},
  byeditorcofo     = {{edited and commented, with a foreword, by}%
                      {ed\adddotspace and comm\adddotspace with foreword}},
  byeditorcoaf     = {{edited and commented, with an afterword, by}%
                      {ed\adddotspace and comm\adddotspace with afterword}},
  byeditoranin     = {{edited and annotated, with an introduction, by}%
                      {ed\adddotspace and annot\adddotspace with introduction}},
  byeditoranfo     = {{edited and annotated, with a foreword, by}%
                      {ed\adddotspace and annot\adddotspace with foreword}},
  byeditoranaf     = {{edited and annotated, with an afterword, by}%
                      {ed\adddotspace and annot\adddotspace with afterword}},
  byeditortrcoin   = {{edited, translated \lbx@lfromlang\finalandcomma\ and commented, with an introduction, by}%
                      {ed.,\addabbrvspace trans\adddot\ \lbx@sfromlang\finalandcomma\ and comm\adddotspace with introduction}},
  byeditortrcofo   = {{edited, translated \lbx@lfromlang\finalandcomma\ and commented, with a foreword, by}%
                      {ed.,\addabbrvspace trans\adddot\ \lbx@sfromlang\finalandcomma\ and comm\adddotspace with foreword}},
  byeditortrcoaf   = {{edited, translated \lbx@lfromlang\finalandcomma\ and commented, with an afterword, by}%
                      {ed.,\addabbrvspace trans\adddot\ \lbx@sfromlang\finalandcomma\ and comm\adddotspace with afterword}},
  byeditortranin   = {{edited, translated \lbx@lfromlang\finalandcomma\ and annotated, with an introduction, by}%
                      {ed.,\addabbrvspace trans\adddot\ \lbx@sfromlang\finalandcomma\ and annot\adddotspace with introduction}},
  byeditortranfo   = {{edited, translated \lbx@lfromlang\finalandcomma\ and annotated, with a foreword, by}%
                      {ed.,\addabbrvspace trans\adddot\ \lbx@sfromlang\finalandcomma\ and annot\adddotspace with foreword}},
  byeditortranaf   = {{edited, translated \lbx@lfromlang\finalandcomma\ and annotated, with an afterword, by}%
                      {ed.,\addabbrvspace trans\adddot\ \lbx@sfromlang\finalandcomma\ and annot\adddotspace with afterword}},
  bytranslatorco   = {{translated \lbx@lfromlang\ and commented by}%
                      {trans\adddot\ \lbx@sfromlang\ and comm\adddot\ by}},
  bytranslatoran   = {{translated \lbx@lfromlang\ and annotated by}%
                      {trans\adddot\ \lbx@sfromlang\ and annot\adddot\ by}},
  bytranslatorin   = {{translated \lbx@lfromlang, with an introduction, by}%
                      {trans\adddot\ \lbx@sfromlang\ with introduction}},
  bytranslatorfo   = {{translated \lbx@lfromlang, with a foreword, by}%
                      {trans\adddot\ \lbx@sfromlang\ with foreword}},
  bytranslatoraf   = {{translated \lbx@lfromlang, with an afterword, by}%
                      {trans\adddot\ \lbx@sfromlang\ with afterword}},
  bytranslatorcoin = {{translated \lbx@lfromlang\ and commented, with an introduction, by}%
                      {trans\adddot\ \lbx@sfromlang\ and comm\adddotspace with introduction}},
  bytranslatorcofo = {{translated \lbx@lfromlang\ and commented, with a foreword, by}%
                      {trans\adddot\ \lbx@sfromlang\ and comm\adddotspace with foreword}},
  bytranslatorcoaf = {{translated \lbx@lfromlang\ and commented, with an afterword, by}%
                      {trans\adddot\ \lbx@sfromlang\ and comm\adddotspace with afterword}},
  bytranslatoranin = {{translated \lbx@lfromlang\ and annotated, with an introduction, by}%
                      {trans\adddot\ \lbx@sfromlang\ and annot\adddotspace with introduction}},
  bytranslatoranfo = {{translated \lbx@lfromlang\ and annotated, with a foreword, by}%
                      {trans\adddot\ \lbx@sfromlang\ and annot\adddotspace with foreword}},
  bytranslatoranaf = {{translated \lbx@lfromlang\ and annotated, with an afterword, by}%
                      {trans\adddot\ \lbx@sfromlang\ and annot\adddotspace with afterword}},
  idem             = {{idem}{id\adddot}},
  idemsm           = {{idem}{id\adddot}},
  idemsf           = {{eadem}{ead\adddot}},
  idemsn           = {{idem}{id\adddot}},
  idempm           = {{eidem}{eid\adddot}},
  idempf           = {{eaedem}{eaed\adddot}},
  idempn           = {{eadem}{ead\adddot}},
  idempp           = {{eidem}{eid\adddot}},
  newseries        = {{new series}{\mkbibacro{NS}}},
  oldseries        = {{old series}{\mkbibacro{OS}}},
  edition          = {{edition}{edn\adddot}},
  reprint          = {{reprint\nopunct}{repr\adddot\nopunct}},
  reviewof         = {{review of}{review of}},
  reprintfrom      = {{from}{from}},
  urlseen          = {{accessed}{accessed}},
  am               = {{a\adddot m\adddot}{a\adddot m\adddot}},
  pm               = {{p\adddot m\adddot}{p\adddot m\adddot}},
}
%    \end{macrocode}
%
% \iffalse %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%</gb>
%</lbx>
% \fi %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
